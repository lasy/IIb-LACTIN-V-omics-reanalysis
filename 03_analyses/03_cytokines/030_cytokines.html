<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.29">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Laura Symul">

<title>Effects of intervention on vaginal inflammation (cytokines/chemokines)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="030_cytokines_files/libs/clipboard/clipboard.min.js"></script>
<script src="030_cytokines_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="030_cytokines_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="030_cytokines_files/libs/quarto-html/popper.min.js"></script>
<script src="030_cytokines_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="030_cytokines_files/libs/quarto-html/anchor.min.js"></script>
<link href="030_cytokines_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="030_cytokines_files/libs/quarto-html/quarto-syntax-highlighting-0815c480559380816a4d1ea211a47e91.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="030_cytokines_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="030_cytokines_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="030_cytokines_files/libs/bootstrap/bootstrap-ff7067f47e26017551bec3c0280d8ab3.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<link href="030_cytokines_files/libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="030_cytokines_files/libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="030_cytokines_files/libs/plotly-binding-4.10.4/plotly.js"></script>
<script src="030_cytokines_files/libs/typedarray-0.1/typedarray.min.js"></script>
<script src="030_cytokines_files/libs/jquery-3.5.1/jquery.min.js"></script>
<link href="030_cytokines_files/libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="030_cytokines_files/libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<link href="030_cytokines_files/libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="030_cytokines_files/libs/plotly-main-2.11.1/plotly-latest.min.js"></script>


</head>

<body class="quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#cytokines" id="toc-cytokines" class="nav-link active" data-scroll-target="#cytokines"><span class="header-section-number">1</span> Cytokines</a>
  <ul class="collapse">
  <li><a href="#descriptive-analysis-pca" id="toc-descriptive-analysis-pca" class="nav-link" data-scroll-target="#descriptive-analysis-pca"><span class="header-section-number">1.1</span> Descriptive analysis (PCA)</a>
  <ul class="collapse">
  <li><a href="#pca-on-the-log10-concentrations" id="toc-pca-on-the-log10-concentrations" class="nav-link" data-scroll-target="#pca-on-the-log10-concentrations"><span class="header-section-number">1.1.1</span> PCA on the log10 concentrations</a></li>
  <li><a href="#pca-on-the-pc1-subtracted-log10-concentrations" id="toc-pca-on-the-pc1-subtracted-log10-concentrations" class="nav-link" data-scroll-target="#pca-on-the-pc1-subtracted-log10-concentrations"><span class="header-section-number">1.1.2</span> PCA on the PC1-subtracted log10 concentrations</a></li>
  </ul></li>
  <li><a href="#univariate-analysis-of-cytokineschemokines-effects-of-treatment-and-intervention" id="toc-univariate-analysis-of-cytokineschemokines-effects-of-treatment-and-intervention" class="nav-link" data-scroll-target="#univariate-analysis-of-cytokineschemokines-effects-of-treatment-and-intervention"><span class="header-section-number">1.2</span> Univariate analysis of cytokines/chemokines: effects of treatment and intervention</a>
  <ul class="collapse">
  <li><a href="#log10-concentrations" id="toc-log10-concentrations" class="nav-link" data-scroll-target="#log10-concentrations"><span class="header-section-number">1.2.1</span> Log10 concentrations</a></li>
  <li><a href="#transformed-concentrations" id="toc-transformed-concentrations" class="nav-link" data-scroll-target="#transformed-concentrations"><span class="header-section-number">1.2.2</span> Transformed concentrations</a></li>
  <li><a href="#transformed-concentrations-excluding-samples-with-many-oor-features" id="toc-transformed-concentrations-excluding-samples-with-many-oor-features" class="nav-link" data-scroll-target="#transformed-concentrations-excluding-samples-with-many-oor-features"><span class="header-section-number">1.2.3</span> Transformed concentrations (excluding samples with many OOR features)</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#integration-with-microbiota" id="toc-integration-with-microbiota" class="nav-link" data-scroll-target="#integration-with-microbiota"><span class="header-section-number">2</span> Integration with microbiota</a>
  <ul class="collapse">
  <li><a href="#multitable-analysis-relationships-between-microbiota-and-cytokineschemokines" id="toc-multitable-analysis-relationships-between-microbiota-and-cytokineschemokines" class="nav-link" data-scroll-target="#multitable-analysis-relationships-between-microbiota-and-cytokineschemokines"><span class="header-section-number">2.1</span> Multitable analysis: relationships between Microbiota and cytokines/chemokines</a>
  <ul class="collapse">
  <li><a href="#rv-coefficient" id="toc-rv-coefficient" class="nav-link" data-scroll-target="#rv-coefficient"><span class="header-section-number">2.1.1</span> RV coefficient</a></li>
  <li><a href="#distatis" id="toc-distatis" class="nav-link" data-scroll-target="#distatis"><span class="header-section-number">2.1.2</span> DISTATIS</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#cytokine-figure" id="toc-cytokine-figure" class="nav-link" data-scroll-target="#cytokine-figure"><span class="header-section-number">3</span> Cytokine figure</a>
  <ul class="collapse">
  <li><a href="#version-1" id="toc-version-1" class="nav-link" data-scroll-target="#version-1"><span class="header-section-number">3.1</span> Version 1</a></li>
  <li><a href="#version-2" id="toc-version-2" class="nav-link" data-scroll-target="#version-2"><span class="header-section-number">3.2</span> Version 2</a>
  <ul class="collapse">
  <li><a href="#part-1-pc1-subtracted-z-log10conc.-of-cytokines" id="toc-part-1-pc1-subtracted-z-log10conc.-of-cytokines" class="nav-link" data-scroll-target="#part-1-pc1-subtracted-z-log10conc.-of-cytokines"><span class="header-section-number">3.2.1</span> Part 1: PC1-subtracted z-log10(conc.) of cytokines</a></li>
  <li><a href="#part-2-integration-with-microbiota" id="toc-part-2-integration-with-microbiota" class="nav-link" data-scroll-target="#part-2-integration-with-microbiota"><span class="header-section-number">3.2.2</span> Part 2: integration with microbiota</a></li>
  <li><a href="#assembled" id="toc-assembled" class="nav-link" data-scroll-target="#assembled"><span class="header-section-number">3.2.3</span> Assembled</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#session-info" id="toc-session-info" class="nav-link" data-scroll-target="#session-info"><span class="header-section-number">4</span> Session Info</a></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Effects of intervention on vaginal inflammation (cytokines/chemokines)</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Laura Symul </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="cytokines" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Cytokines</h1>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We load the MAE object</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>mae <span class="ot">&lt;-</span> <span class="fu">load_latest_mae</span>(<span class="at">dir =</span> <span class="fu">str_c</span>(<span class="fu">data_dir</span>(), <span class="st">"03_augmented_mae"</span>))  </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>clin <span class="ot">&lt;-</span> MultiAssayExperiment<span class="sc">::</span><span class="fu">colData</span>(mae) <span class="sc">|&gt;</span> <span class="fu">as.data.frame</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>cytokines_wide <span class="ot">&lt;-</span> <span class="fu">get_assay_wide_format</span>(mae, <span class="st">"cytokine_transformed"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>cytokine_names <span class="ot">&lt;-</span> cytokines_wide<span class="sc">$</span>assay <span class="sc">|&gt;</span> <span class="fu">colnames</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We have reliable measurements for 13 cytokines: ITAC, MIG, IP-10, IFNg, IL-17, IL-1a, IL-1b, MIP-1a, MIP-1b, MIP-3a, IL-6, TNFa, IL-23.</p>
<section id="descriptive-analysis-pca" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="descriptive-analysis-pca"><span class="header-section-number">1.1</span> Descriptive analysis (PCA)</h2>
<p>As noted in the pre-processing, cytokine concentrations were highly correlated. We suspected that the observed size-effect could have both technical or biological origins. For example, uncontrolled total amount of material collected on swab could explain technical differences in cytokine concentrations, while biological differences could be explained by an overall increase or decrease in inflammation.</p>
<p>Therefore, we proposed several transformation of the cytokine concentration:</p>
<ul>
<li><p>a simple log-transformation to stabilize the variance</p></li>
<li><p>the same transformation followed by a subtraction of the 1st principal component that captures the observed size-effect.</p></li>
</ul>
<p>Before investigating the effects of MTZ and Lactin-V on inflammatory profiles in the next section, we perform a principal component analysis (PCA) on these two transformed cytokine abundances to describe the relationships between cytokines and the overall variation in cytokine concentrations.</p>
<section id="pca-on-the-log10-concentrations" class="level3" data-number="1.1.1">
<h3 data-number="1.1.1" class="anchored" data-anchor-id="pca-on-the-log10-concentrations"><span class="header-section-number">1.1.1</span> PCA on the log10 concentrations</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>cytokines_wide <span class="ot">&lt;-</span> <span class="fu">get_assay_wide_format</span>(mae, <span class="st">"cytokine_log10_incl_cytokine"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>cytokines_pca <span class="ot">&lt;-</span> </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dudi.pca</span>(cytokines_wide<span class="sc">$</span>assay, <span class="at">scannf =</span> <span class="cn">FALSE</span>, <span class="at">nf =</span> <span class="dv">4</span>, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_eig</span>(cytokines_pca)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The first three components explain 74% of the total variance.</p>
<p>The correlation circles below shows how each cytokine correlates with the first three components.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>cytokine_angle <span class="ot">&lt;-</span> </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">atan2</span>(</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    cytokines_pca<span class="sc">$</span>c1[,<span class="dv">2</span>], cytokines_pca<span class="sc">$</span>c1[,<span class="dv">3</span>]</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%%</span> (<span class="dv">2</span><span class="sc">*</span>pi)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>cytokine_info <span class="ot">&lt;-</span> </span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">cytokine =</span> cytokines_wide<span class="sc">$</span>assay <span class="sc">%&gt;%</span> <span class="fu">colnames</span>(),</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">angle =</span> cytokine_angle</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  )  <span class="sc">|&gt;</span> </span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">cytokine =</span> cytokine <span class="sc">|&gt;</span> <span class="fu">factor</span>(<span class="at">levels =</span> cytokine),</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">ITAC_angle =</span> angle[cytokine <span class="sc">==</span> <span class="st">"ITAC"</span>],</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">adjusted_angle =</span> (<span class="dv">2</span><span class="sc">*</span>pi <span class="sc">+</span> angle <span class="sc">-</span> ITAC_angle)<span class="sc">%%</span>(<span class="dv">2</span><span class="sc">*</span>pi),</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">color_index =</span> <span class="fu">ceiling</span>(adjusted_angle<span class="sc">/</span><span class="dv">2</span><span class="sc">/</span>pi<span class="sc">*</span><span class="dv">100</span>),</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> </span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>      <span class="fu">colorRampPalette</span>(</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>        <span class="fu">get_cytokine_angle_colors</span>()</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>        )(<span class="dv">101</span>)[color_index <span class="sc">+</span> <span class="dv">1</span>]</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_pca_var</span>(</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  cytokines_pca, </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">repel =</span> <span class="cn">TRUE</span>, </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">habillage =</span> cytokine_info<span class="sc">$</span>cytokine, </span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">palette =</span> cytokine_info<span class="sc">$</span>color,</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">"Cytokines - PCA of log10 concentrations</span><span class="sc">\n</span><span class="st">(correlation circle)"</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">col =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_pca_var</span>(</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>  cytokines_pca, <span class="at">axes =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>,</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">repel =</span> <span class="cn">TRUE</span>, </span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">habillage =</span> cytokine_info<span class="sc">$</span>cytokine, </span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">palette =</span> cytokine_info<span class="sc">$</span>color,</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">"PC2-3"</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">col =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<p>Cytokines are colored by their angle in the PC2-PC3 correlation circle.</p>
</section>
<section id="pca-on-the-pc1-subtracted-log10-concentrations" class="level3" data-number="1.1.2">
<h3 data-number="1.1.2" class="anchored" data-anchor-id="pca-on-the-pc1-subtracted-log10-concentrations"><span class="header-section-number">1.1.2</span> PCA on the PC1-subtracted log10 concentrations</h3>
<p>Unsurprisingly, the PCA on the PC1-subtracted log10 concentrations is very similar to the results obtained on PC2+ of the PCA on the log10 concentrations.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>cytokines_wide <span class="ot">&lt;-</span> <span class="fu">get_assay_wide_format</span>(mae, <span class="st">"cytokine_transformed"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>cytokines_pca <span class="ot">&lt;-</span> </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dudi.pca</span>(cytokines_wide<span class="sc">$</span>assay, <span class="at">scannf =</span> <span class="cn">FALSE</span>, <span class="at">nf =</span> <span class="dv">4</span>, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_eig</span>(cytokines_pca)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The first two components explain 40% of the total variance.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>cytokine_angle <span class="ot">&lt;-</span> </span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">atan2</span>(</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    cytokines_pca<span class="sc">$</span>c1[,<span class="dv">2</span>], cytokines_pca<span class="sc">$</span>c1[,<span class="dv">1</span>]</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%%</span> (<span class="dv">2</span><span class="sc">*</span>pi)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>cytokine_info <span class="ot">&lt;-</span> </span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">cytokine =</span> cytokines_wide<span class="sc">$</span>assay <span class="sc">%&gt;%</span> <span class="fu">colnames</span>(),</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">angle =</span> cytokine_angle</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>  )  <span class="sc">|&gt;</span> </span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">cytokine =</span> cytokine <span class="sc">|&gt;</span> <span class="fu">factor</span>(<span class="at">levels =</span> cytokine),</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">ITAC_angle =</span> angle[cytokine <span class="sc">==</span> <span class="st">"ITAC"</span>],</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">adjusted_angle =</span> (<span class="dv">2</span><span class="sc">*</span>pi <span class="sc">+</span> angle <span class="sc">-</span> ITAC_angle)<span class="sc">%%</span>(<span class="dv">2</span><span class="sc">*</span>pi),</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">color_index =</span> <span class="fu">ceiling</span>(adjusted_angle<span class="sc">/</span><span class="dv">2</span><span class="sc">/</span>pi<span class="sc">*</span><span class="dv">100</span>),</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> </span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>      <span class="fu">colorRampPalette</span>(</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>        <span class="fu">get_cytokine_angle_colors</span>()</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>        )(<span class="dv">101</span>)[color_index <span class="sc">+</span> <span class="dv">1</span>]</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_pca_var</span>(</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  cytokines_pca, </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">repel =</span> <span class="cn">TRUE</span>, </span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a> <span class="at">habillage =</span> cytokine_info<span class="sc">$</span>cytokine, </span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">palette =</span> cytokine_info<span class="sc">$</span>color,</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">"Cytokines - PCA of transformed abundances</span><span class="sc">\n</span><span class="st">(correlation circle)"</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">col =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
</div>
<p>Cytokines are colored by their angle in the correlation circle.</p>
<p>From these results, we expect that when examining the effects of MTZ and Lactin-V on cytokine concentrations, cytokines that are close to each other in the correlation circle will show similar profiles.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>cytokine_groups <span class="ot">&lt;-</span> </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    cytokine_names[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>],</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    cytokine_names[<span class="fu">c</span>(<span class="dv">6</span><span class="sc">:</span><span class="dv">7</span>, <span class="dv">12</span><span class="sc">:</span><span class="dv">13</span>)],</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    cytokine_names[<span class="dv">8</span><span class="sc">:</span><span class="dv">11</span>]</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="univariate-analysis-of-cytokineschemokines-effects-of-treatment-and-intervention" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="univariate-analysis-of-cytokineschemokines-effects-of-treatment-and-intervention"><span class="header-section-number">1.2</span> Univariate analysis of cytokines/chemokines: effects of treatment and intervention</h2>
<p>[sensitivity analyses] Below, we perform the analyses on the log10 concentration, as well as on the PC1-subtracted data.</p>
<section id="log10-concentrations" class="level3" data-number="1.2.1">
<h3 data-number="1.2.1" class="anchored" data-anchor-id="log10-concentrations"><span class="header-section-number">1.2.1</span> Log10 concentrations</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>assay_name <span class="ot">&lt;-</span> <span class="st">"cytokine_log10_incl_cytokine"</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>value_label <span class="ot">&lt;-</span> <span class="st">"log10(conc.)"</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>selected_cytokines <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"IL-1b"</span>, <span class="st">"IP-10"</span>, <span class="st">"IL-6"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>cytokines_long <span class="ot">&lt;-</span> </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_assay_long_format</span>(</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    mae, assay_name, </span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">feature_name =</span> <span class="st">"cytokine"</span>, <span class="at">values_name =</span> <span class="st">"value"</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Visit =</span> <span class="fu">get_visit_labels</span>(AVISITN)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"N cytokines: "</span>, <span class="fu">length</span>(<span class="fu">unique</span>(cytokines_long<span class="sc">$</span>cytokine)), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>N cytokines:  13 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"N samples: "</span>, <span class="fu">length</span>(<span class="fu">unique</span>(cytokines_long<span class="sc">$</span>Barcode)), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>N samples:  1151 </code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">map</span>(</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  cytokine_groups,</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">function</span>(cytokines, cytokines_long){</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>    cytokines_long <span class="sc">|&gt;</span> </span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(PIPV, cytokine <span class="sc">%in%</span> cytokines) <span class="sc">|&gt;</span> </span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">plot_longitudinal_cytokines</span>(<span class="at">value_label =</span> value_label)</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>  },</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">cytokines_long =</span> cytokines_long</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[2]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-34-2.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[3]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-34-3.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>cytokines_long <span class="sc">|&gt;</span> </span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(PIPV) <span class="sc">|&gt;</span> </span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Visit, <span class="at">y =</span> value, <span class="at">fill =</span> ARM)) <span class="sc">+</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span> </span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_jitter(height = 0, width = 0.1, size = 0.5) +</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(cytokine <span class="sc">~</span> ., <span class="at">scales =</span> <span class="st">"free_y"</span>, <span class="at">nrow =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">get_arm_colors</span>()) <span class="sc">+</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(value_label) <span class="sc">+</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>categories_levels <span class="ot">&lt;-</span> </span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">"≥ 50% L. crispatus"</span>, <span class="st">"≥ 50% Lactobacillus, &lt; 50% L. crispatus"</span>, <span class="st">"&lt; 50% Lactobacillus"</span>)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>microbiota_categories <span class="ot">&lt;-</span> </span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_assay_long_format</span>(</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>    mae, <span class="st">"mb_categories"</span>, <span class="at">add_colData =</span> <span class="cn">FALSE</span>, <span class="at">values_name =</span> <span class="st">"microbiota"</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>feature) <span class="sc">|&gt;</span> </span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">microbiota =</span> microbiota <span class="sc">|&gt;</span> <span class="fu">factor</span>(<span class="at">levels =</span> categories_levels))</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>cytokines_long <span class="ot">&lt;-</span> </span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>  cytokines_long <span class="sc">|&gt;</span> </span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">any_of</span>(<span class="fu">c</span>(<span class="st">"microbiota"</span>))) <span class="sc">|&gt;</span> </span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(microbiota_categories, <span class="at">by =</span> <span class="fu">join_by</span>(Barcode))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">map</span>(</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  cytokine_groups,</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">function</span>(cytokines, cytokines_long){</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>    cytokines_long <span class="sc">|&gt;</span> </span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(cytokine <span class="sc">%in%</span> cytokines) <span class="sc">|&gt;</span> </span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">plot_longitudinal_cytokines_by_arm_and_category</span>(<span class="at">value_label =</span> value_label)</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>  },</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">cytokines_long =</span> cytokines_long</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[2]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-37-2.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[3]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-37-3.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>cytokines_long <span class="sc">|&gt;</span> </span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(cytokine <span class="sc">%in%</span> selected_cytokines) <span class="sc">|&gt;</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_longitudinal_cytokines_by_arm_and_category</span>(<span class="at">value_label =</span> value_label)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">map</span>(</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  cytokine_groups,</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">function</span>(cytokines, cytokines_long){</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>    cytokines_long <span class="sc">|&gt;</span> </span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(cytokine <span class="sc">%in%</span> cytokines) <span class="sc">|&gt;</span> </span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">plot_longitudinal_cytokines_by_category</span>(<span class="at">value_label =</span> value_label)</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>  },</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">cytokines_long =</span> cytokines_long</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[2]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-39-2.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[3]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-39-3.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<section id="differentiating-ctv-05-from-other-l.-crispatus." class="level5" data-number="1.2.1.0.1">
<h5 data-number="1.2.1.0.1" class="anchored" data-anchor-id="differentiating-ctv-05-from-other-l.-crispatus."><span class="header-section-number">1.2.1.0.1</span> Differentiating CTV-05 from other <em>L. crispatus</em>.</h5>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>ctv05_cat_levels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"≥ 50% CTV-05"</span>, categories_levels, <span class="st">"Undetermined"</span>)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>microbiota_categories <span class="ot">&lt;-</span> </span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  microbiota_categories <span class="sc">|&gt;</span> </span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">get_assay_long_format</span>(</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>      mae, <span class="st">"MG_CTV05"</span>, <span class="at">add_colData =</span> <span class="cn">FALSE</span>, <span class="at">values_name =</span> <span class="st">"prop"</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">|&gt;</span> <span class="fu">filter</span>(feature <span class="sc">==</span> <span class="st">"CTV-05"</span>),</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">by =</span> <span class="fu">join_by</span>(Barcode)</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>feature) <span class="sc">|&gt;</span> </span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">microbiota_ctv05 =</span> </span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>      <span class="fu">case_when</span>(</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>        prop <span class="sc">&gt;=</span> <span class="fl">0.5</span> <span class="sc">~</span> <span class="st">"≥ 50% CTV-05"</span>,</span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>        <span class="fu">is.na</span>(microbiota) <span class="sc">~</span> <span class="st">"Undetermined"</span>,</span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>        <span class="cn">TRUE</span> <span class="sc">~</span> microbiota <span class="sc">|&gt;</span> <span class="fu">as.character</span>()</span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">|&gt;</span> </span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>      <span class="fu">factor</span>(<span class="at">levels =</span> ctv05_cat_levels)</span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a>  )  </span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a>cytokines_long <span class="ot">&lt;-</span> </span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a>  cytokines_long <span class="sc">|&gt;</span> </span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">any_of</span>(<span class="st">"microbiota_ctv05"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(</span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a>    microbiota_categories <span class="sc">|&gt;</span> <span class="fu">select</span>(Barcode, microbiota_ctv05), </span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">by =</span> <span class="fu">join_by</span>(Barcode)</span>
<span id="cb35-28"><a href="#cb35-28" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb35-29"><a href="#cb35-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb35-30"><a href="#cb35-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">microbiota_ctv05 =</span> </span>
<span id="cb35-31"><a href="#cb35-31" aria-hidden="true" tabindex="-1"></a>      microbiota_ctv05 <span class="sc">|&gt;</span> </span>
<span id="cb35-32"><a href="#cb35-32" aria-hidden="true" tabindex="-1"></a>      <span class="fu">replace_na</span>(<span class="fu">factor</span>(<span class="st">"Undetermined"</span>, <span class="at">levels =</span> ctv05_cat_levels))</span>
<span id="cb35-33"><a href="#cb35-33" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>With samples from both arms.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">map</span>(</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  cytokine_groups,</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">function</span>(cytokines, cytokines_long){</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>    cytokines_long <span class="sc">|&gt;</span> </span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(cytokine <span class="sc">%in%</span> cytokines) <span class="sc">|&gt;</span> </span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">plot_longitudinal_cytokines_by_ctv05_cat</span>(<span class="at">value_label =</span> value_label)</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>  },</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">cytokines_long =</span> cytokines_long</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[2]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-41-2.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[3]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-41-3.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<p>With samples from the Lactin-V arm only</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">map</span>(</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  cytokine_groups,</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">function</span>(cytokines, cytokines_long){</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>    cytokines_long <span class="sc">|&gt;</span> </span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(ARM <span class="sc">==</span> <span class="st">"LACTIN-V"</span>, cytokine <span class="sc">%in%</span> cytokines) <span class="sc">|&gt;</span> </span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">plot_longitudinal_cytokines_by_ctv05_cat</span>(<span class="at">value_label =</span> value_label)</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>  },</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">cytokines_long =</span> cytokines_long</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[2]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-42-2.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[3]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-42-3.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>cytokines_long <span class="sc">|&gt;</span> </span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(cytokine <span class="sc">%in%</span> <span class="st">"IP-10"</span>, microbiota_ctv05 <span class="sc">!=</span> <span class="st">"Undetermined"</span>)  <span class="sc">|&gt;</span> </span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_longitudinal_cytokines_by_ctv05_cat</span>(<span class="at">value_label =</span> value_label) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># checking for differences between CTV05 and "native" L. crispatus in both arms</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> </span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>  cytokines_long <span class="sc">|&gt;</span> </span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(cytokine <span class="sc">%in%</span> <span class="st">"IP-10"</span>, PIPV) <span class="sc">|&gt;</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(microbiota_ctv05 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"≥ 50% CTV-05"</span>, <span class="st">"≥ 50% L. crispatus"</span>))</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>mmod <span class="ot">&lt;-</span> lme4<span class="sc">::</span><span class="fu">lmer</span>(value <span class="sc">~</span> microbiota_ctv05 <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>USUBJID), <span class="at">data =</span> tmp) </span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>mmod <span class="sc">|&gt;</span> <span class="fu">summary</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: value ~ microbiota_ctv05 + (1 | USUBJID)
   Data: tmp

REML criterion at convergence: 373.2

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-3.2372 -0.4850 -0.0142  0.4141  3.3617 

Random effects:
 Groups   Name        Variance Std.Dev.
 USUBJID  (Intercept) 0.1399   0.3740  
 Residual             0.2598   0.5097  
Number of obs: 202, groups:  USUBJID, 90

Fixed effects:
                                   Estimate Std. Error t value
(Intercept)                         1.53810    0.06426  23.935
microbiota_ctv05≥ 50% L. crispatus -0.03859    0.10813  -0.357</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Correlation of Fixed Effects:</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>            (Intr)
mc_05≥50%Lc -0.512</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">Anova</span>(mmod, <span class="at">type =</span> <span class="st">"III"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table (Type III Wald chisquare tests)

Response: value
                    Chisq Df Pr(&gt;Chisq)    
(Intercept)      572.9053  1     &lt;2e-16 ***
microbiota_ctv05   0.1274  1     0.7212    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> </span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  cytokines_long <span class="sc">|&gt;</span> </span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(cytokine <span class="sc">%in%</span> <span class="st">"IP-10"</span>, AVISITN <span class="sc">==</span> <span class="dv">4</span>) <span class="sc">|&gt;</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(microbiota_ctv05 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"≥ 50% CTV-05"</span>, <span class="st">"≥ 50% L. crispatus"</span>))</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(value <span class="sc">~</span> microbiota_ctv05, <span class="at">data =</span> tmp) <span class="sc">|&gt;</span></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = value ~ microbiota_ctv05, data = tmp)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.06190 -0.36645  0.01608  0.38304  0.97639 

Coefficients:
                                   Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                         1.32840    0.09576  13.872   &lt;2e-16 ***
microbiota_ctv05≥ 50% L. crispatus  0.21044    0.17916   1.175    0.247    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.5245 on 40 degrees of freedom
Multiple R-squared:  0.03334,   Adjusted R-squared:  0.009175 
F-statistic:  1.38 on 1 and 40 DF,  p-value: 0.2471</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># checking for differences between CTV05 and "native" L. crispatus in the Lactin-V arm only</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> </span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>  cytokines_long <span class="sc">|&gt;</span> </span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ARM <span class="sc">==</span> <span class="st">"LACTIN-V"</span>, cytokine <span class="sc">%in%</span> <span class="st">"IP-10"</span>, PIPV) <span class="sc">|&gt;</span></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(microbiota_ctv05 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"≥ 50% CTV-05"</span>, <span class="st">"≥ 50% L. crispatus"</span>))</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>mmod <span class="ot">&lt;-</span> lme4<span class="sc">::</span><span class="fu">lmer</span>(value <span class="sc">~</span> microbiota_ctv05 <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>USUBJID), <span class="at">data =</span> tmp) </span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>mmod <span class="sc">|&gt;</span> <span class="fu">summary</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: value ~ microbiota_ctv05 + (1 | USUBJID)
   Data: tmp

REML criterion at convergence: 335.6

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-3.2170 -0.4339 -0.0077  0.4065  3.3413 

Random effects:
 Groups   Name        Variance Std.Dev.
 USUBJID  (Intercept) 0.1374   0.3707  
 Residual             0.2641   0.5139  
Number of obs: 181, groups:  USUBJID, 79

Fixed effects:
                                   Estimate Std. Error t value
(Intercept)                         1.53413    0.06437  23.834
microbiota_ctv05≥ 50% L. crispatus -0.08325    0.12457  -0.668</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Correlation of Fixed Effects:</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>            (Intr)
mc_05≥50%Lc -0.412</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">Anova</span>(mmod, <span class="at">type =</span> <span class="st">"III"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table (Type III Wald chisquare tests)

Response: value
                    Chisq Df Pr(&gt;Chisq)    
(Intercept)      568.0647  1     &lt;2e-16 ***
microbiota_ctv05   0.4466  1      0.504    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> </span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>  cytokines_long <span class="sc">|&gt;</span> </span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ARM <span class="sc">==</span> <span class="st">"LACTIN-V"</span>, cytokine <span class="sc">%in%</span> <span class="st">"IP-10"</span>, AVISITN <span class="sc">==</span> <span class="dv">4</span>) <span class="sc">|&gt;</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(microbiota_ctv05 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"≥ 50% CTV-05"</span>, <span class="st">"≥ 50% L. crispatus"</span>))</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(value <span class="sc">~</span> microbiota_ctv05, <span class="at">data =</span> tmp) <span class="sc">|&gt;</span></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = value ~ microbiota_ctv05, data = tmp)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.06190 -0.36296 -0.02115  0.38791  0.92611 

Coefficients:
                                   Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                         1.32840    0.09638  13.783 1.05e-15 ***
microbiota_ctv05≥ 50% L. crispatus  0.30475    0.22158   1.375    0.178    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.5279 on 35 degrees of freedom
Multiple R-squared:  0.05128,   Adjusted R-squared:  0.02417 
F-statistic: 1.892 on 1 and 35 DF,  p-value: 0.1778</code></pre>
</div>
</div>
</section>
<section id="difference-to-pre-mtz-transformed-concentrations" class="level4" data-number="1.2.1.1">
<h4 data-number="1.2.1.1" class="anchored" data-anchor-id="difference-to-pre-mtz-transformed-concentrations"><span class="header-section-number">1.2.1.1</span> Difference to pre-MTZ transformed concentrations</h4>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>preMTZ_cytokines <span class="ot">&lt;-</span> </span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>  cytokines_long <span class="sc">|&gt;</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(AVISITN <span class="sc">==</span> <span class="dv">0</span>) <span class="sc">|&gt;</span></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(USUBJID, cytokine, value) <span class="sc">|&gt;</span> </span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">pre_MTZ_value =</span> value)</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>cytokines_to_preMTZ <span class="ot">&lt;-</span> </span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>  cytokines_long <span class="sc">|&gt;</span> </span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(PIPV, AVISITN <span class="sc">!=</span> <span class="dv">0</span>) <span class="sc">|&gt;</span> </span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Visit =</span> <span class="fu">get_visit_labels</span>(AVISITN)) <span class="sc">|&gt;</span></span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Barcode, USUBJID, Visit, ARM, cytokine, value, microbiota) <span class="sc">|&gt;</span> </span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(preMTZ_cytokines, <span class="at">by =</span> <span class="fu">join_by</span>(USUBJID, cytokine)) <span class="sc">|&gt;</span> </span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(pre_MTZ_value)) <span class="sc">|&gt;</span> </span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">diff =</span> value <span class="sc">-</span> pre_MTZ_value)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">map</span>(</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>  cytokine_groups,</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">function</span>(cytokines, cytokines_to_preMTZ){</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>    cytokines_to_preMTZ <span class="sc">|&gt;</span> </span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(cytokine <span class="sc">%in%</span> cytokines) <span class="sc">|&gt;</span> </span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">plot_cytokine_to_preMTZ</span>(<span class="at">value_label =</span> value_label)</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>  },</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">cytokines_to_preMTZ =</span> cytokines_to_preMTZ</span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-47-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[2]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-47-2.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[3]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-47-3.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>g_selection <span class="ot">&lt;-</span> </span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>  cytokines_to_preMTZ <span class="sc">|&gt;</span> </span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(cytokine <span class="sc">%in%</span> selected_cytokines) <span class="sc">|&gt;</span> </span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cytokine =</span> cytokine <span class="sc">|&gt;</span> <span class="fu">factor</span>(<span class="at">levels =</span> selected_cytokines)) <span class="sc">|&gt;</span> </span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_cytokine_to_preMTZ</span>(<span class="at">value_label =</span> value_label) </span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>g_selection</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-48-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>g_selection <span class="ot">&lt;-</span> </span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>  cytokines_to_preMTZ <span class="sc">|&gt;</span> </span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(cytokine <span class="sc">%in%</span> selected_cytokines) <span class="sc">|&gt;</span> </span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(Visit <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Week 4"</span>, <span class="st">"Week 8"</span>))) <span class="sc">|&gt;</span> </span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cytokine =</span> cytokine <span class="sc">|&gt;</span> <span class="fu">factor</span>(<span class="at">levels =</span> selected_cytokines)) <span class="sc">|&gt;</span> </span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_cytokine_to_preMTZ</span>(<span class="at">value_label =</span> value_label) </span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>g_selection</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-49-1.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(g_selection, <span class="at">file =</span> <span class="fu">str_c</span>(<span class="fu">data_dir</span>(), <span class="st">"05_figures_tables/fig_3a.Rdata"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="effects-of-intervention-at-week-24" class="level4" data-number="1.2.1.2">
<h4 data-number="1.2.1.2" class="anchored" data-anchor-id="effects-of-intervention-at-week-24"><span class="header-section-number">1.2.1.2</span> Effects of intervention at week 24</h4>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> </span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>    cytokine_names,</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>    effects_of_intervention,</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">cytokines_long =</span> cytokines_long</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>res <span class="sc">|&gt;</span> <span class="fu">select</span>(cytokine, <span class="fu">ends_with</span>(<span class="st">"pval"</span>)) <span class="sc">|&gt;</span> <span class="fu">distinct</span>() <span class="sc">|&gt;</span> </span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>(<span class="at">caption =</span> <span class="st">"Model validity tests from DHARMa simulations"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">everything</span>(),</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">decimals =</span> <span class="dv">3</span></span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>  ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="wczrjtcvno" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#wczrjtcvno table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#wczrjtcvno thead, #wczrjtcvno tbody, #wczrjtcvno tfoot, #wczrjtcvno tr, #wczrjtcvno td, #wczrjtcvno th {
  border-style: none;
}

#wczrjtcvno p {
  margin: 0;
  padding: 0;
}

#wczrjtcvno .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#wczrjtcvno .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#wczrjtcvno .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#wczrjtcvno .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#wczrjtcvno .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#wczrjtcvno .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#wczrjtcvno .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#wczrjtcvno .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#wczrjtcvno .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#wczrjtcvno .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#wczrjtcvno .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#wczrjtcvno .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#wczrjtcvno .gt_spanner_row {
  border-bottom-style: hidden;
}

#wczrjtcvno .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#wczrjtcvno .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#wczrjtcvno .gt_from_md > :first-child {
  margin-top: 0;
}

#wczrjtcvno .gt_from_md > :last-child {
  margin-bottom: 0;
}

#wczrjtcvno .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#wczrjtcvno .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#wczrjtcvno .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#wczrjtcvno .gt_row_group_first td {
  border-top-width: 2px;
}

#wczrjtcvno .gt_row_group_first th {
  border-top-width: 2px;
}

#wczrjtcvno .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#wczrjtcvno .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#wczrjtcvno .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#wczrjtcvno .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#wczrjtcvno .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#wczrjtcvno .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#wczrjtcvno .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#wczrjtcvno .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#wczrjtcvno .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#wczrjtcvno .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#wczrjtcvno .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#wczrjtcvno .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#wczrjtcvno .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#wczrjtcvno .gt_left {
  text-align: left;
}

#wczrjtcvno .gt_center {
  text-align: center;
}

#wczrjtcvno .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#wczrjtcvno .gt_font_normal {
  font-weight: normal;
}

#wczrjtcvno .gt_font_bold {
  font-weight: bold;
}

#wczrjtcvno .gt_font_italic {
  font-style: italic;
}

#wczrjtcvno .gt_super {
  font-size: 65%;
}

#wczrjtcvno .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#wczrjtcvno .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#wczrjtcvno .gt_indent_1 {
  text-indent: 5px;
}

#wczrjtcvno .gt_indent_2 {
  text-indent: 10px;
}

#wczrjtcvno .gt_indent_3 {
  text-indent: 15px;
}

#wczrjtcvno .gt_indent_4 {
  text-indent: 20px;
}

#wczrjtcvno .gt_indent_5 {
  text-indent: 25px;
}

#wczrjtcvno .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#wczrjtcvno div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<caption>Model validity tests from DHARMa simulations</caption>
<thead>
<tr class="gt_col_headings header">
<th id="cytokine" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">cytokine</th>
<th id="t_u_pval" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">t_u_pval</th>
<th id="t_d_pval" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">t_d_pval</th>
<th id="t_o_pval" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">t_o_pval</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="cytokine">ITAC</td>
<td class="gt_row gt_right" headers="t_u_pval">0.000</td>
<td class="gt_row gt_right" headers="t_d_pval">0.816</td>
<td class="gt_row gt_right" headers="t_o_pval">0.305</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cytokine">MIG</td>
<td class="gt_row gt_right" headers="t_u_pval">0.003</td>
<td class="gt_row gt_right" headers="t_d_pval">0.912</td>
<td class="gt_row gt_right" headers="t_o_pval">0.237</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cytokine">IP-10</td>
<td class="gt_row gt_right" headers="t_u_pval">0.020</td>
<td class="gt_row gt_right" headers="t_d_pval">0.944</td>
<td class="gt_row gt_right" headers="t_o_pval">0.611</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cytokine">IFNg</td>
<td class="gt_row gt_right" headers="t_u_pval">0.000</td>
<td class="gt_row gt_right" headers="t_d_pval">0.888</td>
<td class="gt_row gt_right" headers="t_o_pval">1.000</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cytokine">IL-17</td>
<td class="gt_row gt_right" headers="t_u_pval">0.000</td>
<td class="gt_row gt_right" headers="t_d_pval">0.808</td>
<td class="gt_row gt_right" headers="t_o_pval">0.305</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cytokine">IL-1a</td>
<td class="gt_row gt_right" headers="t_u_pval">0.590</td>
<td class="gt_row gt_right" headers="t_d_pval">0.904</td>
<td class="gt_row gt_right" headers="t_o_pval">1.000</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cytokine">IL-1b</td>
<td class="gt_row gt_right" headers="t_u_pval">0.000</td>
<td class="gt_row gt_right" headers="t_d_pval">1.000</td>
<td class="gt_row gt_right" headers="t_o_pval">0.865</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cytokine">MIP-1a</td>
<td class="gt_row gt_right" headers="t_u_pval">0.000</td>
<td class="gt_row gt_right" headers="t_d_pval">0.784</td>
<td class="gt_row gt_right" headers="t_o_pval">0.003</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cytokine">MIP-1b</td>
<td class="gt_row gt_right" headers="t_u_pval">0.000</td>
<td class="gt_row gt_right" headers="t_d_pval">0.920</td>
<td class="gt_row gt_right" headers="t_o_pval">0.611</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cytokine">MIP-3a</td>
<td class="gt_row gt_right" headers="t_u_pval">0.041</td>
<td class="gt_row gt_right" headers="t_d_pval">0.864</td>
<td class="gt_row gt_right" headers="t_o_pval">1.000</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cytokine">IL-6</td>
<td class="gt_row gt_right" headers="t_u_pval">0.000</td>
<td class="gt_row gt_right" headers="t_d_pval">0.864</td>
<td class="gt_row gt_right" headers="t_o_pval">1.000</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cytokine">TNFa</td>
<td class="gt_row gt_right" headers="t_u_pval">0.000</td>
<td class="gt_row gt_right" headers="t_d_pval">0.896</td>
<td class="gt_row gt_right" headers="t_o_pval">0.171</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cytokine">IL-23</td>
<td class="gt_row gt_right" headers="t_u_pval">0.000</td>
<td class="gt_row gt_right" headers="t_d_pval">0.784</td>
<td class="gt_row gt_right" headers="t_o_pval">0.305</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Caution! Model assumptions are not met for most cytokines (likely because of the LLOQ and ULOQ imputed values).</p>
<p>We try again using ranks instead of the original values.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>) <span class="co"># rank uses random numbers to break ties</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> </span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>    cytokine_names,</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>    effects_of_intervention,</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">cytokines_long =</span> cytokines_long,</span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">use_ranks =</span> <span class="cn">TRUE</span></span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>res <span class="sc">|&gt;</span> <span class="fu">select</span>(cytokine, <span class="fu">ends_with</span>(<span class="st">"pval"</span>)) <span class="sc">|&gt;</span> <span class="fu">distinct</span>() <span class="sc">|&gt;</span> </span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>(<span class="at">caption =</span> <span class="st">"Model validity tests from DHARMa simulations"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">everything</span>(),</span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">decimals =</span> <span class="dv">3</span></span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>  ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="hruxbgsgfy" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#hruxbgsgfy table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#hruxbgsgfy thead, #hruxbgsgfy tbody, #hruxbgsgfy tfoot, #hruxbgsgfy tr, #hruxbgsgfy td, #hruxbgsgfy th {
  border-style: none;
}

#hruxbgsgfy p {
  margin: 0;
  padding: 0;
}

#hruxbgsgfy .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#hruxbgsgfy .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#hruxbgsgfy .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#hruxbgsgfy .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#hruxbgsgfy .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#hruxbgsgfy .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hruxbgsgfy .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#hruxbgsgfy .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#hruxbgsgfy .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#hruxbgsgfy .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#hruxbgsgfy .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#hruxbgsgfy .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#hruxbgsgfy .gt_spanner_row {
  border-bottom-style: hidden;
}

#hruxbgsgfy .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#hruxbgsgfy .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#hruxbgsgfy .gt_from_md > :first-child {
  margin-top: 0;
}

#hruxbgsgfy .gt_from_md > :last-child {
  margin-bottom: 0;
}

#hruxbgsgfy .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#hruxbgsgfy .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#hruxbgsgfy .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#hruxbgsgfy .gt_row_group_first td {
  border-top-width: 2px;
}

#hruxbgsgfy .gt_row_group_first th {
  border-top-width: 2px;
}

#hruxbgsgfy .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#hruxbgsgfy .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#hruxbgsgfy .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#hruxbgsgfy .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hruxbgsgfy .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#hruxbgsgfy .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#hruxbgsgfy .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#hruxbgsgfy .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#hruxbgsgfy .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hruxbgsgfy .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#hruxbgsgfy .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#hruxbgsgfy .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#hruxbgsgfy .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#hruxbgsgfy .gt_left {
  text-align: left;
}

#hruxbgsgfy .gt_center {
  text-align: center;
}

#hruxbgsgfy .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#hruxbgsgfy .gt_font_normal {
  font-weight: normal;
}

#hruxbgsgfy .gt_font_bold {
  font-weight: bold;
}

#hruxbgsgfy .gt_font_italic {
  font-style: italic;
}

#hruxbgsgfy .gt_super {
  font-size: 65%;
}

#hruxbgsgfy .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#hruxbgsgfy .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#hruxbgsgfy .gt_indent_1 {
  text-indent: 5px;
}

#hruxbgsgfy .gt_indent_2 {
  text-indent: 10px;
}

#hruxbgsgfy .gt_indent_3 {
  text-indent: 15px;
}

#hruxbgsgfy .gt_indent_4 {
  text-indent: 20px;
}

#hruxbgsgfy .gt_indent_5 {
  text-indent: 25px;
}

#hruxbgsgfy .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#hruxbgsgfy div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<caption>Model validity tests from DHARMa simulations</caption>
<thead>
<tr class="gt_col_headings header">
<th id="cytokine" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">cytokine</th>
<th id="t_u_pval" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">t_u_pval</th>
<th id="t_d_pval" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">t_d_pval</th>
<th id="t_o_pval" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">t_o_pval</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="cytokine">ITAC</td>
<td class="gt_row gt_right" headers="t_u_pval">0.002</td>
<td class="gt_row gt_right" headers="t_d_pval">0.792</td>
<td class="gt_row gt_right" headers="t_o_pval">0.000</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cytokine">MIG</td>
<td class="gt_row gt_right" headers="t_u_pval">0.002</td>
<td class="gt_row gt_right" headers="t_d_pval">0.944</td>
<td class="gt_row gt_right" headers="t_o_pval">0.000</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cytokine">IP-10</td>
<td class="gt_row gt_right" headers="t_u_pval">0.001</td>
<td class="gt_row gt_right" headers="t_d_pval">0.920</td>
<td class="gt_row gt_right" headers="t_o_pval">0.000</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cytokine">IFNg</td>
<td class="gt_row gt_right" headers="t_u_pval">0.001</td>
<td class="gt_row gt_right" headers="t_d_pval">0.824</td>
<td class="gt_row gt_right" headers="t_o_pval">0.000</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cytokine">IL-17</td>
<td class="gt_row gt_right" headers="t_u_pval">0.000</td>
<td class="gt_row gt_right" headers="t_d_pval">0.840</td>
<td class="gt_row gt_right" headers="t_o_pval">0.000</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cytokine">IL-1a</td>
<td class="gt_row gt_right" headers="t_u_pval">0.002</td>
<td class="gt_row gt_right" headers="t_d_pval">0.904</td>
<td class="gt_row gt_right" headers="t_o_pval">0.000</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cytokine">IL-1b</td>
<td class="gt_row gt_right" headers="t_u_pval">0.014</td>
<td class="gt_row gt_right" headers="t_d_pval">0.936</td>
<td class="gt_row gt_right" headers="t_o_pval">0.003</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cytokine">MIP-1a</td>
<td class="gt_row gt_right" headers="t_u_pval">0.000</td>
<td class="gt_row gt_right" headers="t_d_pval">0.808</td>
<td class="gt_row gt_right" headers="t_o_pval">0.000</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cytokine">MIP-1b</td>
<td class="gt_row gt_right" headers="t_u_pval">0.001</td>
<td class="gt_row gt_right" headers="t_d_pval">0.920</td>
<td class="gt_row gt_right" headers="t_o_pval">0.000</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cytokine">MIP-3a</td>
<td class="gt_row gt_right" headers="t_u_pval">0.001</td>
<td class="gt_row gt_right" headers="t_d_pval">0.864</td>
<td class="gt_row gt_right" headers="t_o_pval">0.000</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cytokine">IL-6</td>
<td class="gt_row gt_right" headers="t_u_pval">0.001</td>
<td class="gt_row gt_right" headers="t_d_pval">0.872</td>
<td class="gt_row gt_right" headers="t_o_pval">0.000</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cytokine">TNFa</td>
<td class="gt_row gt_right" headers="t_u_pval">0.000</td>
<td class="gt_row gt_right" headers="t_d_pval">0.832</td>
<td class="gt_row gt_right" headers="t_o_pval">0.000</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cytokine">IL-23</td>
<td class="gt_row gt_right" headers="t_u_pval">0.000</td>
<td class="gt_row gt_right" headers="t_d_pval">0.776</td>
<td class="gt_row gt_right" headers="t_o_pval">0.000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Not much better…</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>res <span class="sc">|&gt;</span> <span class="fu">filter</span>(visit <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Week 12"</span>, <span class="st">"Week 24"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> visit, <span class="at">y =</span> estimate) <span class="sc">+</span></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(. <span class="sc">~</span> cytokine) <span class="sc">+</span></span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"gray"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_linerange</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> CI_lower, <span class="at">ymax =</span> CI_upper)) <span class="sc">+</span></span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Visit"</span>) <span class="sc">+</span></span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Estimated difference in percentile,</span><span class="sc">\n</span><span class="st">adjusted for random participants effects</span><span class="sc">\n</span><span class="st">and associated 95% CI."</span>) <span class="sc">+</span></span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">caption =</span> <span class="st">"Linear mixed model fitted on ranks."</span>) <span class="sc">+</span></span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>)</span>
<span id="cb73-13"><a href="#cb73-13" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-55-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>Non-parametric test instead.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> </span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>    cytokine_names,</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>    effects_of_intervention_wilcox,</span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">cytokines_to_preMTZ =</span> cytokines_to_preMTZ</span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>() <span class="sc">|&gt;</span> </span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">adj_p_value =</span> <span class="fu">p.adjust</span>(p_value, <span class="at">method =</span> <span class="st">"BH"</span>)</span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>res <span class="sc">|&gt;</span> </span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> cytokine, <span class="at">y =</span> estimate) <span class="sc">+</span></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"gray"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_linerange</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> CI_lower, <span class="at">ymax =</span> CI_upper)) <span class="sc">+</span></span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Estimated difference in location (Lactin-V - Placebo)</span><span class="sc">\n</span><span class="st">and associated 95% CI."</span>) <span class="sc">+</span></span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">caption =</span> <span class="st">"Wilcoxon signed rank test on the difference between log10(conc.) at baseline (pre-MTZ) and Week 24 visit"</span>) <span class="sc">+</span></span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)</span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-57-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>res <span class="sc">|&gt;</span> </span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>p_value) <span class="sc">|&gt;</span> </span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>(<span class="at">caption =</span> <span class="st">"Wilcoxon signed rank sum test on the difference between log10(conc.) at baseline (pre-MTZ) and Week 24 visit"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="sc">-</span><span class="fu">c</span>(<span class="st">"W"</span>),</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">decimals =</span> <span class="dv">3</span></span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>  ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="zvdgyhgbhe" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#zvdgyhgbhe table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#zvdgyhgbhe thead, #zvdgyhgbhe tbody, #zvdgyhgbhe tfoot, #zvdgyhgbhe tr, #zvdgyhgbhe td, #zvdgyhgbhe th {
  border-style: none;
}

#zvdgyhgbhe p {
  margin: 0;
  padding: 0;
}

#zvdgyhgbhe .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#zvdgyhgbhe .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#zvdgyhgbhe .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#zvdgyhgbhe .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#zvdgyhgbhe .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#zvdgyhgbhe .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zvdgyhgbhe .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#zvdgyhgbhe .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#zvdgyhgbhe .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#zvdgyhgbhe .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#zvdgyhgbhe .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#zvdgyhgbhe .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#zvdgyhgbhe .gt_spanner_row {
  border-bottom-style: hidden;
}

#zvdgyhgbhe .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#zvdgyhgbhe .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#zvdgyhgbhe .gt_from_md > :first-child {
  margin-top: 0;
}

#zvdgyhgbhe .gt_from_md > :last-child {
  margin-bottom: 0;
}

#zvdgyhgbhe .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#zvdgyhgbhe .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#zvdgyhgbhe .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#zvdgyhgbhe .gt_row_group_first td {
  border-top-width: 2px;
}

#zvdgyhgbhe .gt_row_group_first th {
  border-top-width: 2px;
}

#zvdgyhgbhe .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#zvdgyhgbhe .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#zvdgyhgbhe .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#zvdgyhgbhe .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zvdgyhgbhe .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#zvdgyhgbhe .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#zvdgyhgbhe .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#zvdgyhgbhe .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#zvdgyhgbhe .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zvdgyhgbhe .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#zvdgyhgbhe .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#zvdgyhgbhe .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#zvdgyhgbhe .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#zvdgyhgbhe .gt_left {
  text-align: left;
}

#zvdgyhgbhe .gt_center {
  text-align: center;
}

#zvdgyhgbhe .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#zvdgyhgbhe .gt_font_normal {
  font-weight: normal;
}

#zvdgyhgbhe .gt_font_bold {
  font-weight: bold;
}

#zvdgyhgbhe .gt_font_italic {
  font-style: italic;
}

#zvdgyhgbhe .gt_super {
  font-size: 65%;
}

#zvdgyhgbhe .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#zvdgyhgbhe .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#zvdgyhgbhe .gt_indent_1 {
  text-indent: 5px;
}

#zvdgyhgbhe .gt_indent_2 {
  text-indent: 10px;
}

#zvdgyhgbhe .gt_indent_3 {
  text-indent: 15px;
}

#zvdgyhgbhe .gt_indent_4 {
  text-indent: 20px;
}

#zvdgyhgbhe .gt_indent_5 {
  text-indent: 25px;
}

#zvdgyhgbhe .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#zvdgyhgbhe div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<caption>Wilcoxon signed rank sum test on the difference between log10(conc.) at baseline (pre-MTZ) and Week 24 visit</caption>
<thead>
<tr class="gt_col_headings header">
<th id="cytokine" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">cytokine</th>
<th id="W" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">W</th>
<th id="estimate" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">estimate</th>
<th id="CI_lower" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">CI_lower</th>
<th id="CI_upper" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">CI_upper</th>
<th id="adj_p_value" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">adj_p_value</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="cytokine">ITAC</td>
<td class="gt_row gt_right" headers="W">2804.0</td>
<td class="gt_row gt_right" headers="estimate">0.000</td>
<td class="gt_row gt_right" headers="CI_lower">−0.153</td>
<td class="gt_row gt_right" headers="CI_upper">0.208</td>
<td class="gt_row gt_right" headers="adj_p_value">0.843</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cytokine">MIG</td>
<td class="gt_row gt_right" headers="W">3269.5</td>
<td class="gt_row gt_right" headers="estimate">0.383</td>
<td class="gt_row gt_right" headers="CI_lower">−0.008</td>
<td class="gt_row gt_right" headers="CI_upper">0.761</td>
<td class="gt_row gt_right" headers="adj_p_value">0.146</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cytokine">IP-10</td>
<td class="gt_row gt_right" headers="W">3240.0</td>
<td class="gt_row gt_right" headers="estimate">0.271</td>
<td class="gt_row gt_right" headers="CI_lower">−0.024</td>
<td class="gt_row gt_right" headers="CI_upper">0.574</td>
<td class="gt_row gt_right" headers="adj_p_value">0.155</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cytokine">IFNg</td>
<td class="gt_row gt_right" headers="W">2812.0</td>
<td class="gt_row gt_right" headers="estimate">0.000</td>
<td class="gt_row gt_right" headers="CI_lower">−0.212</td>
<td class="gt_row gt_right" headers="CI_upper">0.258</td>
<td class="gt_row gt_right" headers="adj_p_value">0.843</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cytokine">IL-17</td>
<td class="gt_row gt_right" headers="W">2136.0</td>
<td class="gt_row gt_right" headers="estimate">−0.279</td>
<td class="gt_row gt_right" headers="CI_lower">−0.526</td>
<td class="gt_row gt_right" headers="CI_upper">0.000</td>
<td class="gt_row gt_right" headers="adj_p_value">0.099</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cytokine">IL-1a</td>
<td class="gt_row gt_right" headers="W">1967.0</td>
<td class="gt_row gt_right" headers="estimate">−0.440</td>
<td class="gt_row gt_right" headers="CI_lower">−0.718</td>
<td class="gt_row gt_right" headers="CI_upper">−0.161</td>
<td class="gt_row gt_right" headers="adj_p_value">0.026</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cytokine">IL-1b</td>
<td class="gt_row gt_right" headers="W">1932.0</td>
<td class="gt_row gt_right" headers="estimate">−0.564</td>
<td class="gt_row gt_right" headers="CI_lower">−0.941</td>
<td class="gt_row gt_right" headers="CI_upper">−0.196</td>
<td class="gt_row gt_right" headers="adj_p_value">0.026</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cytokine">MIP-1a</td>
<td class="gt_row gt_right" headers="W">2433.5</td>
<td class="gt_row gt_right" headers="estimate">−0.174</td>
<td class="gt_row gt_right" headers="CI_lower">−0.457</td>
<td class="gt_row gt_right" headers="CI_upper">0.117</td>
<td class="gt_row gt_right" headers="adj_p_value">0.353</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cytokine">MIP-1b</td>
<td class="gt_row gt_right" headers="W">2220.5</td>
<td class="gt_row gt_right" headers="estimate">−0.144</td>
<td class="gt_row gt_right" headers="CI_lower">−0.377</td>
<td class="gt_row gt_right" headers="CI_upper">0.000</td>
<td class="gt_row gt_right" headers="adj_p_value">0.146</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cytokine">MIP-3a</td>
<td class="gt_row gt_right" headers="W">2824.0</td>
<td class="gt_row gt_right" headers="estimate">0.036</td>
<td class="gt_row gt_right" headers="CI_lower">−0.292</td>
<td class="gt_row gt_right" headers="CI_upper">0.346</td>
<td class="gt_row gt_right" headers="adj_p_value">0.843</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cytokine">IL-6</td>
<td class="gt_row gt_right" headers="W">2487.5</td>
<td class="gt_row gt_right" headers="estimate">−0.117</td>
<td class="gt_row gt_right" headers="CI_lower">−0.409</td>
<td class="gt_row gt_right" headers="CI_upper">0.090</td>
<td class="gt_row gt_right" headers="adj_p_value">0.433</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cytokine">TNFa</td>
<td class="gt_row gt_right" headers="W">2395.5</td>
<td class="gt_row gt_right" headers="estimate">−0.078</td>
<td class="gt_row gt_right" headers="CI_lower">−0.411</td>
<td class="gt_row gt_right" headers="CI_upper">0.000</td>
<td class="gt_row gt_right" headers="adj_p_value">0.302</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cytokine">IL-23</td>
<td class="gt_row gt_right" headers="W">2346.5</td>
<td class="gt_row gt_right" headers="estimate">−0.111</td>
<td class="gt_row gt_right" headers="CI_lower">−0.362</td>
<td class="gt_row gt_right" headers="CI_upper">0.000</td>
<td class="gt_row gt_right" headers="adj_p_value">0.250</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
</section>
<section id="transformed-concentrations" class="level3" data-number="1.2.2">
<h3 data-number="1.2.2" class="anchored" data-anchor-id="transformed-concentrations"><span class="header-section-number">1.2.2</span> Transformed concentrations</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>assay_name <span class="ot">&lt;-</span> <span class="st">"cytokine_log10_SE_corrected_incl_cytokine"</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>value_label <span class="ot">&lt;-</span> <span class="st">"PC1-subtracted z-log10(conc.)"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>cytokines_long <span class="ot">&lt;-</span> </span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_assay_long_format</span>(</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>    mae, assay_name, </span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">feature_name =</span> <span class="st">"cytokine"</span>, <span class="at">values_name =</span> <span class="st">"value"</span></span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Visit =</span> <span class="fu">get_visit_labels</span>(AVISITN)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"N cytokines: "</span>, <span class="fu">length</span>(<span class="fu">unique</span>(cytokines_long<span class="sc">$</span>cytokine)), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>N cytokines:  13 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"N samples: "</span>, <span class="fu">length</span>(<span class="fu">unique</span>(cytokines_long<span class="sc">$</span>Barcode)), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>N samples:  1151 </code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">map</span>(</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>  cytokine_groups,</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">function</span>(cytokines, cytokines_long){</span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>    cytokines_long <span class="sc">|&gt;</span> </span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(PIPV, cytokine <span class="sc">%in%</span> cytokines) <span class="sc">|&gt;</span> </span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">plot_longitudinal_cytokines</span>(<span class="at">value_label =</span> value_label)</span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a>  },</span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">cytokines_long =</span> cytokines_long</span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-62-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[2]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-62-2.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[3]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-62-3.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>cytokines_long <span class="sc">|&gt;</span> </span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(PIPV) <span class="sc">|&gt;</span> </span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Visit, <span class="at">y =</span> value, <span class="at">fill =</span> ARM)) <span class="sc">+</span></span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span> </span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_jitter(height = 0, width = 0.1, size = 0.5) +</span></span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(cytokine <span class="sc">~</span> ., <span class="at">scales =</span> <span class="st">"free_y"</span>, <span class="at">nrow =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">get_arm_colors</span>()) <span class="sc">+</span></span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(value_label) <span class="sc">+</span></span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-63-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>categories_levels <span class="ot">&lt;-</span> </span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">"≥ 50% L. crispatus"</span>, <span class="st">"≥ 50% Lactobacillus, &lt; 50% L. crispatus"</span>, <span class="st">"&lt; 50% Lactobacillus"</span>)</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>microbiota_categories <span class="ot">&lt;-</span> </span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_assay_long_format</span>(</span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>    mae, <span class="st">"mb_categories"</span>, <span class="at">add_colData =</span> <span class="cn">FALSE</span>, <span class="at">values_name =</span> <span class="st">"microbiota"</span></span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>feature) <span class="sc">|&gt;</span> </span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">microbiota =</span> microbiota <span class="sc">|&gt;</span> <span class="fu">factor</span>(<span class="at">levels =</span> categories_levels))</span>
<span id="cb88-9"><a href="#cb88-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-10"><a href="#cb88-10" aria-hidden="true" tabindex="-1"></a>cytokines_long <span class="ot">&lt;-</span> </span>
<span id="cb88-11"><a href="#cb88-11" aria-hidden="true" tabindex="-1"></a>  cytokines_long <span class="sc">|&gt;</span> </span>
<span id="cb88-12"><a href="#cb88-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">any_of</span>(<span class="fu">c</span>(<span class="st">"microbiota"</span>))) <span class="sc">|&gt;</span> </span>
<span id="cb88-13"><a href="#cb88-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(microbiota_categories, <span class="at">by =</span> <span class="fu">join_by</span>(Barcode))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">map</span>(</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>  cytokine_groups,</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">function</span>(cytokines, cytokines_long){</span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>    cytokines_long <span class="sc">|&gt;</span> </span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(cytokine <span class="sc">%in%</span> cytokines) <span class="sc">|&gt;</span> </span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">plot_longitudinal_cytokines_by_arm_and_category</span>(<span class="at">value_label =</span> value_label)</span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a>  },</span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">cytokines_long =</span> cytokines_long</span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-65-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[2]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-65-2.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[3]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-65-3.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>cytokines_long <span class="sc">|&gt;</span> </span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(cytokine <span class="sc">%in%</span> selected_cytokines) <span class="sc">|&gt;</span></span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_longitudinal_cytokines_by_arm_and_category</span>(<span class="at">value_label =</span> value_label)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-66-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">map</span>(</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>  cytokine_groups,</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">function</span>(cytokines, cytokines_long){</span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>    cytokines_long <span class="sc">|&gt;</span> </span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(cytokine <span class="sc">%in%</span> cytokines) <span class="sc">|&gt;</span> </span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">plot_longitudinal_cytokines_by_category</span>(<span class="at">value_label =</span> value_label)</span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a>  },</span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">cytokines_long =</span> cytokines_long</span>
<span id="cb94-9"><a href="#cb94-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-67-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[2]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-67-2.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[3]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-67-3.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<section id="differentiating-ctv-05-from-other-l.-crispatus.-1" class="level5" data-number="1.2.2.0.1">
<h5 data-number="1.2.2.0.1" class="anchored" data-anchor-id="differentiating-ctv-05-from-other-l.-crispatus.-1"><span class="header-section-number">1.2.2.0.1</span> Differentiating CTV-05 from other <em>L. crispatus</em>.</h5>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>ctv05_cat_levels <span class="ot">&lt;-</span> </span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">"≥ 50% CTV-05"</span>, categories_levels, <span class="st">"Undetermined"</span>)</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>microbiota_categories <span class="ot">&lt;-</span> </span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>  microbiota_categories <span class="sc">|&gt;</span> </span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(</span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">get_assay_long_format</span>(</span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a>      mae, <span class="st">"MG_CTV05"</span>, <span class="at">add_colData =</span> <span class="cn">FALSE</span>, <span class="at">values_name =</span> <span class="st">"prop"</span></span>
<span id="cb98-8"><a href="#cb98-8" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">|&gt;</span> <span class="fu">filter</span>(feature <span class="sc">==</span> <span class="st">"CTV-05"</span>),</span>
<span id="cb98-9"><a href="#cb98-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">by =</span> <span class="fu">join_by</span>(Barcode)</span>
<span id="cb98-10"><a href="#cb98-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb98-11"><a href="#cb98-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>feature) <span class="sc">|&gt;</span> </span>
<span id="cb98-12"><a href="#cb98-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb98-13"><a href="#cb98-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">microbiota_ctv05 =</span> </span>
<span id="cb98-14"><a href="#cb98-14" aria-hidden="true" tabindex="-1"></a>      <span class="fu">case_when</span>(</span>
<span id="cb98-15"><a href="#cb98-15" aria-hidden="true" tabindex="-1"></a>        prop <span class="sc">&gt;=</span> <span class="fl">0.5</span> <span class="sc">~</span> <span class="st">"≥ 50% CTV-05"</span>,</span>
<span id="cb98-16"><a href="#cb98-16" aria-hidden="true" tabindex="-1"></a>        <span class="fu">is.na</span>(microbiota) <span class="sc">~</span> <span class="st">"Undetermined"</span>,</span>
<span id="cb98-17"><a href="#cb98-17" aria-hidden="true" tabindex="-1"></a>        <span class="cn">TRUE</span> <span class="sc">~</span> microbiota <span class="sc">|&gt;</span> <span class="fu">as.character</span>()</span>
<span id="cb98-18"><a href="#cb98-18" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">|&gt;</span> </span>
<span id="cb98-19"><a href="#cb98-19" aria-hidden="true" tabindex="-1"></a>      <span class="fu">factor</span>(<span class="at">levels =</span> ctv05_cat_levels)</span>
<span id="cb98-20"><a href="#cb98-20" aria-hidden="true" tabindex="-1"></a>  )  </span>
<span id="cb98-21"><a href="#cb98-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-22"><a href="#cb98-22" aria-hidden="true" tabindex="-1"></a>cytokines_long <span class="ot">&lt;-</span> </span>
<span id="cb98-23"><a href="#cb98-23" aria-hidden="true" tabindex="-1"></a>  cytokines_long <span class="sc">|&gt;</span> </span>
<span id="cb98-24"><a href="#cb98-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">any_of</span>(<span class="st">"microbiota_ctv05"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb98-25"><a href="#cb98-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(</span>
<span id="cb98-26"><a href="#cb98-26" aria-hidden="true" tabindex="-1"></a>    microbiota_categories <span class="sc">|&gt;</span> <span class="fu">select</span>(Barcode, microbiota_ctv05), </span>
<span id="cb98-27"><a href="#cb98-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">by =</span> <span class="fu">join_by</span>(Barcode)</span>
<span id="cb98-28"><a href="#cb98-28" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb98-29"><a href="#cb98-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb98-30"><a href="#cb98-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">microbiota_ctv05 =</span> </span>
<span id="cb98-31"><a href="#cb98-31" aria-hidden="true" tabindex="-1"></a>      microbiota_ctv05 <span class="sc">|&gt;</span> </span>
<span id="cb98-32"><a href="#cb98-32" aria-hidden="true" tabindex="-1"></a>      <span class="fu">replace_na</span>(<span class="fu">factor</span>(<span class="st">"Undetermined"</span>, <span class="at">levels =</span> ctv05_cat_levels))</span>
<span id="cb98-33"><a href="#cb98-33" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>With samples from both arms.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">map</span>(</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>  cytokine_groups,</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">function</span>(cytokines, cytokines_long){</span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>    cytokines_long <span class="sc">|&gt;</span> </span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(cytokine <span class="sc">%in%</span> cytokines) <span class="sc">|&gt;</span> </span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">plot_longitudinal_cytokines_by_ctv05_cat</span>(<span class="at">value_label =</span> value_label)</span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a>  },</span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">cytokines_long =</span> cytokines_long</span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-69-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[2]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-69-2.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[3]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-69-3.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<p>With samples from the Lactin-V arm only</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">map</span>(</span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>  cytokine_groups,</span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">function</span>(cytokines, cytokines_long){</span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a>    cytokines_long <span class="sc">|&gt;</span> </span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(ARM <span class="sc">==</span> <span class="st">"LACTIN-V"</span>, cytokine <span class="sc">%in%</span> cytokines) <span class="sc">|&gt;</span> </span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">plot_longitudinal_cytokines_by_ctv05_cat</span>(<span class="at">value_label =</span> value_label)</span>
<span id="cb103-7"><a href="#cb103-7" aria-hidden="true" tabindex="-1"></a>  },</span>
<span id="cb103-8"><a href="#cb103-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">cytokines_long =</span> cytokines_long</span>
<span id="cb103-9"><a href="#cb103-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-70-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[2]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-70-2.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[3]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-70-3.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> </span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>cytokines_long <span class="sc">|&gt;</span> </span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(cytokine <span class="sc">%in%</span> <span class="st">"IP-10"</span>, microbiota_ctv05 <span class="sc">!=</span> <span class="st">"Undetermined"</span>)  <span class="sc">|&gt;</span> </span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(microbiota_ctv05) <span class="sc">|&gt;</span> </span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">microbiota_ctv05 =</span> </span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a>      microbiota_ctv05 <span class="sc">|&gt;</span> </span>
<span id="cb107-8"><a href="#cb107-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_replace</span>(<span class="st">"Lactobacillus, &lt; 50% L. crispatus"</span>, <span class="st">"Lacto., &lt; 50% L. c."</span>) <span class="sc">|&gt;</span> </span>
<span id="cb107-9"><a href="#cb107-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">fct_inorder</span>()</span>
<span id="cb107-10"><a href="#cb107-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb107-11"><a href="#cb107-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_longitudinal_cytokines_by_ctv05_cat</span>(<span class="at">value_label =</span> value_label) </span>
<span id="cb107-12"><a href="#cb107-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-13"><a href="#cb107-13" aria-hidden="true" tabindex="-1"></a>g</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-71-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(g, <span class="at">filename =</span> <span class="fu">str_c</span>(<span class="fu">fig_out_dir</span>(), <span class="st">"S4D.pdf"</span>), <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">4</span>, <span class="at">device =</span> cairo_pdf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="co"># checking for differences between CTV05 and "native" L. crispatus in both arms</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> </span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a>  cytokines_long <span class="sc">|&gt;</span> </span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(cytokine <span class="sc">%in%</span> <span class="st">"IP-10"</span>, PIPV) <span class="sc">|&gt;</span></span>
<span id="cb109-6"><a href="#cb109-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(microbiota_ctv05 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"≥ 50% CTV-05"</span>, <span class="st">"≥ 50% L. crispatus"</span>))</span>
<span id="cb109-7"><a href="#cb109-7" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb109-8"><a href="#cb109-8" aria-hidden="true" tabindex="-1"></a>mmod <span class="ot">&lt;-</span> lme4<span class="sc">::</span><span class="fu">lmer</span>(value <span class="sc">~</span> microbiota_ctv05 <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>USUBJID), <span class="at">data =</span> tmp) </span>
<span id="cb109-9"><a href="#cb109-9" aria-hidden="true" tabindex="-1"></a>mmod <span class="sc">|&gt;</span> <span class="fu">summary</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: value ~ microbiota_ctv05 + (1 | USUBJID)
   Data: tmp

REML criterion at convergence: 362.9

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-2.6505 -0.5361  0.0034  0.4708  3.4268 

Random effects:
 Groups   Name        Variance Std.Dev.
 USUBJID  (Intercept) 0.1299   0.3604  
 Residual             0.2484   0.4984  
Number of obs: 202, groups:  USUBJID, 90

Fixed effects:
                                   Estimate Std. Error t value
(Intercept)                         0.52735    0.06237   8.455
microbiota_ctv05≥ 50% L. crispatus  0.05028    0.10517   0.478</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Correlation of Fixed Effects:</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>            (Intr)
mc_05≥50%Lc -0.512</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">Anova</span>(mmod, <span class="at">type =</span> <span class="st">"III"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table (Type III Wald chisquare tests)

Response: value
                   Chisq Df Pr(&gt;Chisq)    
(Intercept)      71.4882  1     &lt;2e-16 ***
microbiota_ctv05  0.2285  1     0.6326    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> </span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>  cytokines_long <span class="sc">|&gt;</span> </span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(cytokine <span class="sc">%in%</span> <span class="st">"IP-10"</span>, AVISITN <span class="sc">==</span> <span class="dv">4</span>) <span class="sc">|&gt;</span></span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(microbiota_ctv05 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"≥ 50% CTV-05"</span>, <span class="st">"≥ 50% L. crispatus"</span>))</span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb115-6"><a href="#cb115-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(value <span class="sc">~</span> microbiota_ctv05, <span class="at">data =</span> tmp) <span class="sc">|&gt;</span></span>
<span id="cb115-7"><a href="#cb115-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = value ~ microbiota_ctv05, data = tmp)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.88484 -0.33545 -0.06741  0.28510  1.27608 

Coefficients:
                                   Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                         0.44081    0.08284   5.321 4.23e-06 ***
microbiota_ctv05≥ 50% L. crispatus  0.23997    0.15497   1.548    0.129    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.4537 on 40 degrees of freedom
Multiple R-squared:  0.05655,   Adjusted R-squared:  0.03297 
F-statistic: 2.398 on 1 and 40 DF,  p-value: 0.1294</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="co"># checking for differences between CTV05 and "native" L. crispatus in the Lactin-V arm only</span></span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> </span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true" tabindex="-1"></a>  cytokines_long <span class="sc">|&gt;</span> </span>
<span id="cb117-6"><a href="#cb117-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ARM <span class="sc">==</span> <span class="st">"LACTIN-V"</span>, cytokine <span class="sc">%in%</span> <span class="st">"IP-10"</span>, PIPV) <span class="sc">|&gt;</span></span>
<span id="cb117-7"><a href="#cb117-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(microbiota_ctv05 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"≥ 50% CTV-05"</span>, <span class="st">"≥ 50% L. crispatus"</span>))</span>
<span id="cb117-8"><a href="#cb117-8" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb117-9"><a href="#cb117-9" aria-hidden="true" tabindex="-1"></a>mmod <span class="ot">&lt;-</span> lme4<span class="sc">::</span><span class="fu">lmer</span>(value <span class="sc">~</span> microbiota_ctv05 <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>USUBJID), <span class="at">data =</span> tmp) </span>
<span id="cb117-10"><a href="#cb117-10" aria-hidden="true" tabindex="-1"></a>mmod <span class="sc">|&gt;</span> <span class="fu">summary</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: value ~ microbiota_ctv05 + (1 | USUBJID)
   Data: tmp

REML criterion at convergence: 326.1

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-2.6311 -0.5618  0.0035  0.4700  3.4098 

Random effects:
 Groups   Name        Variance Std.Dev.
 USUBJID  (Intercept) 0.1272   0.3566  
 Residual             0.2520   0.5020  
Number of obs: 181, groups:  USUBJID, 79

Fixed effects:
                                    Estimate Std. Error t value
(Intercept)                         0.523585   0.062390   8.392
microbiota_ctv05≥ 50% L. crispatus -0.006424   0.121114  -0.053</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Correlation of Fixed Effects:</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>            (Intr)
mc_05≥50%Lc -0.413</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">Anova</span>(mmod, <span class="at">type =</span> <span class="st">"III"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table (Type III Wald chisquare tests)

Response: value
                   Chisq Df Pr(&gt;Chisq)    
(Intercept)      70.4290  1     &lt;2e-16 ***
microbiota_ctv05  0.0028  1     0.9577    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> </span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>  cytokines_long <span class="sc">|&gt;</span> </span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ARM <span class="sc">==</span> <span class="st">"LACTIN-V"</span>, cytokine <span class="sc">%in%</span> <span class="st">"IP-10"</span>, AVISITN <span class="sc">==</span> <span class="dv">4</span>) <span class="sc">|&gt;</span></span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(microbiota_ctv05 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"≥ 50% CTV-05"</span>, <span class="st">"≥ 50% L. crispatus"</span>))</span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb123-6"><a href="#cb123-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(value <span class="sc">~</span> microbiota_ctv05, <span class="at">data =</span> tmp) <span class="sc">|&gt;</span></span>
<span id="cb123-7"><a href="#cb123-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = value ~ microbiota_ctv05, data = tmp)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.88484 -0.34462 -0.06423  0.28683  1.27608 

Coefficients:
                                   Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                         0.44081    0.08449   5.217 8.31e-06 ***
microbiota_ctv05≥ 50% L. crispatus  0.20924    0.19425   1.077    0.289    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.4628 on 35 degrees of freedom
Multiple R-squared:  0.03209,   Adjusted R-squared:  0.004434 
F-statistic:  1.16 on 1 and 35 DF,  p-value: 0.2888</code></pre>
</div>
</div>
</section>
<section id="difference-to-pre-mtz-transformed-concentrations-1" class="level4" data-number="1.2.2.1">
<h4 data-number="1.2.2.1" class="anchored" data-anchor-id="difference-to-pre-mtz-transformed-concentrations-1"><span class="header-section-number">1.2.2.1</span> Difference to pre-MTZ transformed concentrations</h4>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>preMTZ_cytokines <span class="ot">&lt;-</span> </span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>  cytokines_long <span class="sc">|&gt;</span></span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(AVISITN <span class="sc">==</span> <span class="dv">0</span>) <span class="sc">|&gt;</span></span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(USUBJID, cytokine, value) <span class="sc">|&gt;</span> </span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">pre_MTZ_value =</span> value)</span>
<span id="cb125-6"><a href="#cb125-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-7"><a href="#cb125-7" aria-hidden="true" tabindex="-1"></a>cytokines_to_preMTZ <span class="ot">&lt;-</span> </span>
<span id="cb125-8"><a href="#cb125-8" aria-hidden="true" tabindex="-1"></a>  cytokines_long <span class="sc">|&gt;</span> </span>
<span id="cb125-9"><a href="#cb125-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(PIPV, AVISITN <span class="sc">!=</span> <span class="dv">0</span>) <span class="sc">|&gt;</span> </span>
<span id="cb125-10"><a href="#cb125-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Visit =</span> <span class="fu">get_visit_labels</span>(AVISITN)) <span class="sc">|&gt;</span></span>
<span id="cb125-11"><a href="#cb125-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Barcode, USUBJID, Visit, ARM, cytokine, value, microbiota) <span class="sc">|&gt;</span> </span>
<span id="cb125-12"><a href="#cb125-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(preMTZ_cytokines, <span class="at">by =</span> <span class="fu">join_by</span>(USUBJID, cytokine)) <span class="sc">|&gt;</span> </span>
<span id="cb125-13"><a href="#cb125-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(pre_MTZ_value)) <span class="sc">|&gt;</span> </span>
<span id="cb125-14"><a href="#cb125-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">diff =</span> value <span class="sc">-</span> pre_MTZ_value)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="fu">map</span>(</span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>  cytokine_groups,</span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">function</span>(cytokines, cytokines_to_preMTZ){</span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a>    cytokines_to_preMTZ <span class="sc">|&gt;</span> </span>
<span id="cb126-5"><a href="#cb126-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(cytokine <span class="sc">%in%</span> cytokines) <span class="sc">|&gt;</span> </span>
<span id="cb126-6"><a href="#cb126-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">plot_cytokine_to_preMTZ</span>(<span class="at">value_label =</span> value_label)</span>
<span id="cb126-7"><a href="#cb126-7" aria-hidden="true" tabindex="-1"></a>  },</span>
<span id="cb126-8"><a href="#cb126-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">cytokines_to_preMTZ =</span> cytokines_to_preMTZ</span>
<span id="cb126-9"><a href="#cb126-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-76-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[2]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-76-2.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[3]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-76-3.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a>g_selection <span class="ot">&lt;-</span> </span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a>  cytokines_to_preMTZ <span class="sc">|&gt;</span> </span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(cytokine <span class="sc">%in%</span> selected_cytokines) <span class="sc">|&gt;</span> </span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cytokine =</span> cytokine <span class="sc">|&gt;</span> <span class="fu">factor</span>(<span class="at">levels =</span> selected_cytokines)) <span class="sc">|&gt;</span> </span>
<span id="cb130-5"><a href="#cb130-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_cytokine_to_preMTZ</span>(<span class="at">value_label =</span> value_label) </span>
<span id="cb130-6"><a href="#cb130-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-7"><a href="#cb130-7" aria-hidden="true" tabindex="-1"></a>g_selection</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-77-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>g_selection <span class="ot">&lt;-</span> </span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>  cytokines_to_preMTZ <span class="sc">|&gt;</span> </span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(cytokine <span class="sc">%in%</span> selected_cytokines) <span class="sc">|&gt;</span> </span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(Visit <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Week 4"</span>, <span class="st">"Week 8"</span>))) <span class="sc">|&gt;</span> </span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cytokine =</span> cytokine <span class="sc">|&gt;</span> <span class="fu">factor</span>(<span class="at">levels =</span> selected_cytokines)) <span class="sc">|&gt;</span> </span>
<span id="cb131-6"><a href="#cb131-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_cytokine_to_preMTZ</span>(<span class="at">value_label =</span> value_label) </span>
<span id="cb131-7"><a href="#cb131-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-8"><a href="#cb131-8" aria-hidden="true" tabindex="-1"></a>g_selection</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-78-1.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(g_selection, <span class="at">file =</span> <span class="fu">str_c</span>(<span class="fu">data_dir</span>(), <span class="st">"05_figures_tables/fig_3a_PC1_subtracted_all.Rdata"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="effects-of-intervention-at-week-24-1" class="level4" data-number="1.2.2.2">
<h4 data-number="1.2.2.2" class="anchored" data-anchor-id="effects-of-intervention-at-week-24-1"><span class="header-section-number">1.2.2.2</span> Effects of intervention at week 24</h4>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> </span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(</span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a>    cytokine_names,</span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a>    effects_of_intervention,</span>
<span id="cb133-5"><a href="#cb133-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">cytokines_long =</span> cytokines_long</span>
<span id="cb133-6"><a href="#cb133-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb133-7"><a href="#cb133-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a>res <span class="sc">|&gt;</span> <span class="fu">select</span>(cytokine, <span class="fu">ends_with</span>(<span class="st">"pval"</span>)) <span class="sc">|&gt;</span> <span class="fu">distinct</span>() <span class="sc">|&gt;</span> </span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>(<span class="at">caption =</span> <span class="st">"Model validity tests from DHARMa simulations"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(</span>
<span id="cb134-4"><a href="#cb134-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">everything</span>(),</span>
<span id="cb134-5"><a href="#cb134-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">decimals =</span> <span class="dv">3</span></span>
<span id="cb134-6"><a href="#cb134-6" aria-hidden="true" tabindex="-1"></a>  ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="wpikpyzhig" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#wpikpyzhig table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#wpikpyzhig thead, #wpikpyzhig tbody, #wpikpyzhig tfoot, #wpikpyzhig tr, #wpikpyzhig td, #wpikpyzhig th {
  border-style: none;
}

#wpikpyzhig p {
  margin: 0;
  padding: 0;
}

#wpikpyzhig .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#wpikpyzhig .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#wpikpyzhig .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#wpikpyzhig .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#wpikpyzhig .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#wpikpyzhig .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#wpikpyzhig .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#wpikpyzhig .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#wpikpyzhig .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#wpikpyzhig .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#wpikpyzhig .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#wpikpyzhig .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#wpikpyzhig .gt_spanner_row {
  border-bottom-style: hidden;
}

#wpikpyzhig .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#wpikpyzhig .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#wpikpyzhig .gt_from_md > :first-child {
  margin-top: 0;
}

#wpikpyzhig .gt_from_md > :last-child {
  margin-bottom: 0;
}

#wpikpyzhig .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#wpikpyzhig .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#wpikpyzhig .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#wpikpyzhig .gt_row_group_first td {
  border-top-width: 2px;
}

#wpikpyzhig .gt_row_group_first th {
  border-top-width: 2px;
}

#wpikpyzhig .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#wpikpyzhig .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#wpikpyzhig .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#wpikpyzhig .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#wpikpyzhig .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#wpikpyzhig .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#wpikpyzhig .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#wpikpyzhig .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#wpikpyzhig .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#wpikpyzhig .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#wpikpyzhig .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#wpikpyzhig .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#wpikpyzhig .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#wpikpyzhig .gt_left {
  text-align: left;
}

#wpikpyzhig .gt_center {
  text-align: center;
}

#wpikpyzhig .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#wpikpyzhig .gt_font_normal {
  font-weight: normal;
}

#wpikpyzhig .gt_font_bold {
  font-weight: bold;
}

#wpikpyzhig .gt_font_italic {
  font-style: italic;
}

#wpikpyzhig .gt_super {
  font-size: 65%;
}

#wpikpyzhig .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#wpikpyzhig .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#wpikpyzhig .gt_indent_1 {
  text-indent: 5px;
}

#wpikpyzhig .gt_indent_2 {
  text-indent: 10px;
}

#wpikpyzhig .gt_indent_3 {
  text-indent: 15px;
}

#wpikpyzhig .gt_indent_4 {
  text-indent: 20px;
}

#wpikpyzhig .gt_indent_5 {
  text-indent: 25px;
}

#wpikpyzhig .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#wpikpyzhig div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<caption>Model validity tests from DHARMa simulations</caption>
<thead>
<tr class="gt_col_headings header">
<th id="cytokine" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">cytokine</th>
<th id="t_u_pval" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">t_u_pval</th>
<th id="t_d_pval" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">t_d_pval</th>
<th id="t_o_pval" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">t_o_pval</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="cytokine">ITAC</td>
<td class="gt_row gt_right" headers="t_u_pval">0.143</td>
<td class="gt_row gt_right" headers="t_d_pval">0.760</td>
<td class="gt_row gt_right" headers="t_o_pval">0.305</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cytokine">MIG</td>
<td class="gt_row gt_right" headers="t_u_pval">0.317</td>
<td class="gt_row gt_right" headers="t_d_pval">0.888</td>
<td class="gt_row gt_right" headers="t_o_pval">0.398</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cytokine">IP-10</td>
<td class="gt_row gt_right" headers="t_u_pval">0.180</td>
<td class="gt_row gt_right" headers="t_d_pval">0.816</td>
<td class="gt_row gt_right" headers="t_o_pval">0.495</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cytokine">IFNg</td>
<td class="gt_row gt_right" headers="t_u_pval">0.001</td>
<td class="gt_row gt_right" headers="t_d_pval">0.824</td>
<td class="gt_row gt_right" headers="t_o_pval">0.125</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cytokine">IL-17</td>
<td class="gt_row gt_right" headers="t_u_pval">0.104</td>
<td class="gt_row gt_right" headers="t_d_pval">0.760</td>
<td class="gt_row gt_right" headers="t_o_pval">0.611</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cytokine">IL-1a</td>
<td class="gt_row gt_right" headers="t_u_pval">0.413</td>
<td class="gt_row gt_right" headers="t_d_pval">0.944</td>
<td class="gt_row gt_right" headers="t_o_pval">0.398</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cytokine">IL-1b</td>
<td class="gt_row gt_right" headers="t_u_pval">0.005</td>
<td class="gt_row gt_right" headers="t_d_pval">0.896</td>
<td class="gt_row gt_right" headers="t_o_pval">0.611</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cytokine">MIP-1a</td>
<td class="gt_row gt_right" headers="t_u_pval">0.000</td>
<td class="gt_row gt_right" headers="t_d_pval">0.736</td>
<td class="gt_row gt_right" headers="t_o_pval">0.733</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cytokine">MIP-1b</td>
<td class="gt_row gt_right" headers="t_u_pval">0.005</td>
<td class="gt_row gt_right" headers="t_d_pval">0.832</td>
<td class="gt_row gt_right" headers="t_o_pval">0.305</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cytokine">MIP-3a</td>
<td class="gt_row gt_right" headers="t_u_pval">0.238</td>
<td class="gt_row gt_right" headers="t_d_pval">0.856</td>
<td class="gt_row gt_right" headers="t_o_pval">1.000</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cytokine">IL-6</td>
<td class="gt_row gt_right" headers="t_u_pval">0.000</td>
<td class="gt_row gt_right" headers="t_d_pval">0.960</td>
<td class="gt_row gt_right" headers="t_o_pval">0.305</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cytokine">TNFa</td>
<td class="gt_row gt_right" headers="t_u_pval">0.194</td>
<td class="gt_row gt_right" headers="t_d_pval">0.816</td>
<td class="gt_row gt_right" headers="t_o_pval">0.398</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cytokine">IL-23</td>
<td class="gt_row gt_right" headers="t_u_pval">0.078</td>
<td class="gt_row gt_right" headers="t_d_pval">0.760</td>
<td class="gt_row gt_right" headers="t_o_pval">0.398</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Caution! Model assumptions are not met for most cytokines (likely because of the LLOQ and ULOQ imputed values).</p>
<p>We try again using ranks instead of the original values.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>) <span class="co"># rank uses random numbers to break ties</span></span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> </span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(</span>
<span id="cb135-4"><a href="#cb135-4" aria-hidden="true" tabindex="-1"></a>    cytokine_names,</span>
<span id="cb135-5"><a href="#cb135-5" aria-hidden="true" tabindex="-1"></a>    effects_of_intervention,</span>
<span id="cb135-6"><a href="#cb135-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">cytokines_long =</span> cytokines_long,</span>
<span id="cb135-7"><a href="#cb135-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">use_ranks =</span> <span class="cn">TRUE</span></span>
<span id="cb135-8"><a href="#cb135-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb135-9"><a href="#cb135-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a>res <span class="sc">|&gt;</span> <span class="fu">select</span>(cytokine, <span class="fu">ends_with</span>(<span class="st">"pval"</span>)) <span class="sc">|&gt;</span> <span class="fu">distinct</span>() <span class="sc">|&gt;</span> </span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>(<span class="at">caption =</span> <span class="st">"Model validity tests from DHARMa simulations"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(</span>
<span id="cb136-4"><a href="#cb136-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">everything</span>(),</span>
<span id="cb136-5"><a href="#cb136-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">decimals =</span> <span class="dv">3</span></span>
<span id="cb136-6"><a href="#cb136-6" aria-hidden="true" tabindex="-1"></a>  ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="hruxbgsgfy" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#hruxbgsgfy table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#hruxbgsgfy thead, #hruxbgsgfy tbody, #hruxbgsgfy tfoot, #hruxbgsgfy tr, #hruxbgsgfy td, #hruxbgsgfy th {
  border-style: none;
}

#hruxbgsgfy p {
  margin: 0;
  padding: 0;
}

#hruxbgsgfy .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#hruxbgsgfy .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#hruxbgsgfy .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#hruxbgsgfy .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#hruxbgsgfy .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#hruxbgsgfy .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hruxbgsgfy .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#hruxbgsgfy .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#hruxbgsgfy .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#hruxbgsgfy .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#hruxbgsgfy .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#hruxbgsgfy .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#hruxbgsgfy .gt_spanner_row {
  border-bottom-style: hidden;
}

#hruxbgsgfy .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#hruxbgsgfy .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#hruxbgsgfy .gt_from_md > :first-child {
  margin-top: 0;
}

#hruxbgsgfy .gt_from_md > :last-child {
  margin-bottom: 0;
}

#hruxbgsgfy .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#hruxbgsgfy .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#hruxbgsgfy .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#hruxbgsgfy .gt_row_group_first td {
  border-top-width: 2px;
}

#hruxbgsgfy .gt_row_group_first th {
  border-top-width: 2px;
}

#hruxbgsgfy .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#hruxbgsgfy .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#hruxbgsgfy .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#hruxbgsgfy .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hruxbgsgfy .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#hruxbgsgfy .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#hruxbgsgfy .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#hruxbgsgfy .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#hruxbgsgfy .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hruxbgsgfy .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#hruxbgsgfy .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#hruxbgsgfy .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#hruxbgsgfy .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#hruxbgsgfy .gt_left {
  text-align: left;
}

#hruxbgsgfy .gt_center {
  text-align: center;
}

#hruxbgsgfy .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#hruxbgsgfy .gt_font_normal {
  font-weight: normal;
}

#hruxbgsgfy .gt_font_bold {
  font-weight: bold;
}

#hruxbgsgfy .gt_font_italic {
  font-style: italic;
}

#hruxbgsgfy .gt_super {
  font-size: 65%;
}

#hruxbgsgfy .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#hruxbgsgfy .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#hruxbgsgfy .gt_indent_1 {
  text-indent: 5px;
}

#hruxbgsgfy .gt_indent_2 {
  text-indent: 10px;
}

#hruxbgsgfy .gt_indent_3 {
  text-indent: 15px;
}

#hruxbgsgfy .gt_indent_4 {
  text-indent: 20px;
}

#hruxbgsgfy .gt_indent_5 {
  text-indent: 25px;
}

#hruxbgsgfy .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#hruxbgsgfy div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<caption>Model validity tests from DHARMa simulations</caption>
<thead>
<tr class="gt_col_headings header">
<th id="cytokine" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">cytokine</th>
<th id="t_u_pval" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">t_u_pval</th>
<th id="t_d_pval" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">t_d_pval</th>
<th id="t_o_pval" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">t_o_pval</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="cytokine">ITAC</td>
<td class="gt_row gt_right" headers="t_u_pval">0.000</td>
<td class="gt_row gt_right" headers="t_d_pval">0.752</td>
<td class="gt_row gt_right" headers="t_o_pval">0.000</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cytokine">MIG</td>
<td class="gt_row gt_right" headers="t_u_pval">0.006</td>
<td class="gt_row gt_right" headers="t_d_pval">0.864</td>
<td class="gt_row gt_right" headers="t_o_pval">0.003</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cytokine">IP-10</td>
<td class="gt_row gt_right" headers="t_u_pval">0.001</td>
<td class="gt_row gt_right" headers="t_d_pval">0.808</td>
<td class="gt_row gt_right" headers="t_o_pval">0.000</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cytokine">IFNg</td>
<td class="gt_row gt_right" headers="t_u_pval">0.000</td>
<td class="gt_row gt_right" headers="t_d_pval">0.832</td>
<td class="gt_row gt_right" headers="t_o_pval">0.000</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cytokine">IL-17</td>
<td class="gt_row gt_right" headers="t_u_pval">0.001</td>
<td class="gt_row gt_right" headers="t_d_pval">0.752</td>
<td class="gt_row gt_right" headers="t_o_pval">0.000</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cytokine">IL-1a</td>
<td class="gt_row gt_right" headers="t_u_pval">0.001</td>
<td class="gt_row gt_right" headers="t_d_pval">0.912</td>
<td class="gt_row gt_right" headers="t_o_pval">0.000</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cytokine">IL-1b</td>
<td class="gt_row gt_right" headers="t_u_pval">0.000</td>
<td class="gt_row gt_right" headers="t_d_pval">0.904</td>
<td class="gt_row gt_right" headers="t_o_pval">0.003</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cytokine">MIP-1a</td>
<td class="gt_row gt_right" headers="t_u_pval">0.000</td>
<td class="gt_row gt_right" headers="t_d_pval">0.768</td>
<td class="gt_row gt_right" headers="t_o_pval">0.000</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cytokine">MIP-1b</td>
<td class="gt_row gt_right" headers="t_u_pval">0.000</td>
<td class="gt_row gt_right" headers="t_d_pval">0.880</td>
<td class="gt_row gt_right" headers="t_o_pval">0.000</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cytokine">MIP-3a</td>
<td class="gt_row gt_right" headers="t_u_pval">0.000</td>
<td class="gt_row gt_right" headers="t_d_pval">0.856</td>
<td class="gt_row gt_right" headers="t_o_pval">0.000</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cytokine">IL-6</td>
<td class="gt_row gt_right" headers="t_u_pval">0.000</td>
<td class="gt_row gt_right" headers="t_d_pval">0.984</td>
<td class="gt_row gt_right" headers="t_o_pval">0.000</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cytokine">TNFa</td>
<td class="gt_row gt_right" headers="t_u_pval">0.000</td>
<td class="gt_row gt_right" headers="t_d_pval">0.800</td>
<td class="gt_row gt_right" headers="t_o_pval">0.000</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cytokine">IL-23</td>
<td class="gt_row gt_right" headers="t_u_pval">0.000</td>
<td class="gt_row gt_right" headers="t_d_pval">0.744</td>
<td class="gt_row gt_right" headers="t_o_pval">0.000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Not much better…</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a>res <span class="sc">|&gt;</span> <span class="fu">filter</span>(visit <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Week 12"</span>, <span class="st">"Week 24"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> visit, <span class="at">y =</span> estimate) <span class="sc">+</span></span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(. <span class="sc">~</span> cytokine) <span class="sc">+</span></span>
<span id="cb137-5"><a href="#cb137-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"gray"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb137-6"><a href="#cb137-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_linerange</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> CI_lower, <span class="at">ymax =</span> CI_upper)) <span class="sc">+</span></span>
<span id="cb137-7"><a href="#cb137-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb137-8"><a href="#cb137-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Visit"</span>) <span class="sc">+</span></span>
<span id="cb137-9"><a href="#cb137-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Estimated difference in percentile,</span><span class="sc">\n</span><span class="st">adjusted for random participants effects</span><span class="sc">\n</span><span class="st">and associated 95% CI."</span>) <span class="sc">+</span></span>
<span id="cb137-10"><a href="#cb137-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">caption =</span> <span class="st">"Linear mixed model fitted on ranks."</span>) <span class="sc">+</span></span>
<span id="cb137-11"><a href="#cb137-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb137-12"><a href="#cb137-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>)</span>
<span id="cb137-13"><a href="#cb137-13" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-84-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>Non-parametric test instead.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> </span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(</span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a>    cytokine_names,</span>
<span id="cb138-4"><a href="#cb138-4" aria-hidden="true" tabindex="-1"></a>    effects_of_intervention_wilcox,</span>
<span id="cb138-5"><a href="#cb138-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">cytokines_to_preMTZ =</span> cytokines_to_preMTZ</span>
<span id="cb138-6"><a href="#cb138-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb138-7"><a href="#cb138-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>() <span class="sc">|&gt;</span> </span>
<span id="cb138-8"><a href="#cb138-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb138-9"><a href="#cb138-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">adj_p_value =</span> <span class="fu">p.adjust</span>(p_value, <span class="at">method =</span> <span class="st">"BH"</span>)</span>
<span id="cb138-10"><a href="#cb138-10" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a>res <span class="sc">|&gt;</span> </span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> cytokine, <span class="at">y =</span> estimate) <span class="sc">+</span></span>
<span id="cb139-4"><a href="#cb139-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"gray"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb139-5"><a href="#cb139-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_linerange</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> CI_lower, <span class="at">ymax =</span> CI_upper)) <span class="sc">+</span></span>
<span id="cb139-6"><a href="#cb139-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb139-7"><a href="#cb139-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb139-8"><a href="#cb139-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Estimated difference in location (Lactin-V - Placebo)</span><span class="sc">\n</span><span class="st">and associated 95% CI."</span>) <span class="sc">+</span></span>
<span id="cb139-9"><a href="#cb139-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">caption =</span> <span class="st">"Wilcoxon signed rank test on the difference between PC1-subtracted z-log10(conc.) at baseline (pre-MTZ) and Week 24 visit"</span>) <span class="sc">+</span></span>
<span id="cb139-10"><a href="#cb139-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb139-11"><a href="#cb139-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)</span>
<span id="cb139-12"><a href="#cb139-12" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-86-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>res <span class="sc">|&gt;</span> </span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>p_value) <span class="sc">|&gt;</span> </span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>(<span class="at">caption =</span> <span class="st">"Wilcoxon signed rank test on the difference between PC1-subtracted z-log10(conc.) at baseline (pre-MTZ) and Week 24 visit"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb140-4"><a href="#cb140-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(</span>
<span id="cb140-5"><a href="#cb140-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="sc">-</span><span class="fu">c</span>(<span class="st">"W"</span>),</span>
<span id="cb140-6"><a href="#cb140-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">decimals =</span> <span class="dv">3</span></span>
<span id="cb140-7"><a href="#cb140-7" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="zvdgyhgbhe" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#zvdgyhgbhe table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#zvdgyhgbhe thead, #zvdgyhgbhe tbody, #zvdgyhgbhe tfoot, #zvdgyhgbhe tr, #zvdgyhgbhe td, #zvdgyhgbhe th {
  border-style: none;
}

#zvdgyhgbhe p {
  margin: 0;
  padding: 0;
}

#zvdgyhgbhe .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#zvdgyhgbhe .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#zvdgyhgbhe .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#zvdgyhgbhe .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#zvdgyhgbhe .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#zvdgyhgbhe .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zvdgyhgbhe .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#zvdgyhgbhe .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#zvdgyhgbhe .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#zvdgyhgbhe .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#zvdgyhgbhe .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#zvdgyhgbhe .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#zvdgyhgbhe .gt_spanner_row {
  border-bottom-style: hidden;
}

#zvdgyhgbhe .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#zvdgyhgbhe .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#zvdgyhgbhe .gt_from_md > :first-child {
  margin-top: 0;
}

#zvdgyhgbhe .gt_from_md > :last-child {
  margin-bottom: 0;
}

#zvdgyhgbhe .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#zvdgyhgbhe .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#zvdgyhgbhe .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#zvdgyhgbhe .gt_row_group_first td {
  border-top-width: 2px;
}

#zvdgyhgbhe .gt_row_group_first th {
  border-top-width: 2px;
}

#zvdgyhgbhe .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#zvdgyhgbhe .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#zvdgyhgbhe .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#zvdgyhgbhe .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zvdgyhgbhe .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#zvdgyhgbhe .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#zvdgyhgbhe .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#zvdgyhgbhe .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#zvdgyhgbhe .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zvdgyhgbhe .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#zvdgyhgbhe .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#zvdgyhgbhe .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#zvdgyhgbhe .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#zvdgyhgbhe .gt_left {
  text-align: left;
}

#zvdgyhgbhe .gt_center {
  text-align: center;
}

#zvdgyhgbhe .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#zvdgyhgbhe .gt_font_normal {
  font-weight: normal;
}

#zvdgyhgbhe .gt_font_bold {
  font-weight: bold;
}

#zvdgyhgbhe .gt_font_italic {
  font-style: italic;
}

#zvdgyhgbhe .gt_super {
  font-size: 65%;
}

#zvdgyhgbhe .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#zvdgyhgbhe .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#zvdgyhgbhe .gt_indent_1 {
  text-indent: 5px;
}

#zvdgyhgbhe .gt_indent_2 {
  text-indent: 10px;
}

#zvdgyhgbhe .gt_indent_3 {
  text-indent: 15px;
}

#zvdgyhgbhe .gt_indent_4 {
  text-indent: 20px;
}

#zvdgyhgbhe .gt_indent_5 {
  text-indent: 25px;
}

#zvdgyhgbhe .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#zvdgyhgbhe div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<caption>Wilcoxon signed rank test on the difference between PC1-subtracted z-log10(conc.) at baseline (pre-MTZ) and Week 24 visit</caption>
<thead>
<tr class="gt_col_headings header">
<th id="cytokine" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">cytokine</th>
<th id="W" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">W</th>
<th id="estimate" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">estimate</th>
<th id="CI_lower" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">CI_lower</th>
<th id="CI_upper" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">CI_upper</th>
<th id="adj_p_value" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">adj_p_value</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="cytokine">ITAC</td>
<td class="gt_row gt_right" headers="W">3111</td>
<td class="gt_row gt_right" headers="estimate">0.184</td>
<td class="gt_row gt_right" headers="CI_lower">−0.084</td>
<td class="gt_row gt_right" headers="CI_upper">0.445</td>
<td class="gt_row gt_right" headers="adj_p_value">0.363</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cytokine">MIG</td>
<td class="gt_row gt_right" headers="W">3614</td>
<td class="gt_row gt_right" headers="estimate">0.499</td>
<td class="gt_row gt_right" headers="CI_lower">0.196</td>
<td class="gt_row gt_right" headers="CI_upper">0.789</td>
<td class="gt_row gt_right" headers="adj_p_value">0.010</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cytokine">IP-10</td>
<td class="gt_row gt_right" headers="W">3645</td>
<td class="gt_row gt_right" headers="estimate">0.508</td>
<td class="gt_row gt_right" headers="CI_lower">0.209</td>
<td class="gt_row gt_right" headers="CI_upper">0.790</td>
<td class="gt_row gt_right" headers="adj_p_value">0.010</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cytokine">IFNg</td>
<td class="gt_row gt_right" headers="W">3022</td>
<td class="gt_row gt_right" headers="estimate">0.178</td>
<td class="gt_row gt_right" headers="CI_lower">−0.146</td>
<td class="gt_row gt_right" headers="CI_upper">0.524</td>
<td class="gt_row gt_right" headers="adj_p_value">0.375</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cytokine">IL-17</td>
<td class="gt_row gt_right" headers="W">2133</td>
<td class="gt_row gt_right" headers="estimate">−0.335</td>
<td class="gt_row gt_right" headers="CI_lower">−0.638</td>
<td class="gt_row gt_right" headers="CI_upper">−0.050</td>
<td class="gt_row gt_right" headers="adj_p_value">0.060</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cytokine">IL-1a</td>
<td class="gt_row gt_right" headers="W">2061</td>
<td class="gt_row gt_right" headers="estimate">−0.445</td>
<td class="gt_row gt_right" headers="CI_lower">−0.758</td>
<td class="gt_row gt_right" headers="CI_upper">−0.108</td>
<td class="gt_row gt_right" headers="adj_p_value">0.037</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cytokine">IL-1b</td>
<td class="gt_row gt_right" headers="W">1947</td>
<td class="gt_row gt_right" headers="estimate">−0.387</td>
<td class="gt_row gt_right" headers="CI_lower">−0.656</td>
<td class="gt_row gt_right" headers="CI_upper">−0.141</td>
<td class="gt_row gt_right" headers="adj_p_value">0.014</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cytokine">MIP-1a</td>
<td class="gt_row gt_right" headers="W">2724</td>
<td class="gt_row gt_right" headers="estimate">−0.014</td>
<td class="gt_row gt_right" headers="CI_lower">−0.309</td>
<td class="gt_row gt_right" headers="CI_upper">0.305</td>
<td class="gt_row gt_right" headers="adj_p_value">0.925</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cytokine">MIP-1b</td>
<td class="gt_row gt_right" headers="W">2422</td>
<td class="gt_row gt_right" headers="estimate">−0.137</td>
<td class="gt_row gt_right" headers="CI_lower">−0.358</td>
<td class="gt_row gt_right" headers="CI_upper">0.087</td>
<td class="gt_row gt_right" headers="adj_p_value">0.363</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cytokine">MIP-3a</td>
<td class="gt_row gt_right" headers="W">3062</td>
<td class="gt_row gt_right" headers="estimate">0.195</td>
<td class="gt_row gt_right" headers="CI_lower">−0.142</td>
<td class="gt_row gt_right" headers="CI_upper">0.524</td>
<td class="gt_row gt_right" headers="adj_p_value">0.363</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cytokine">IL-6</td>
<td class="gt_row gt_right" headers="W">2668</td>
<td class="gt_row gt_right" headers="estimate">−0.043</td>
<td class="gt_row gt_right" headers="CI_lower">−0.313</td>
<td class="gt_row gt_right" headers="CI_upper">0.231</td>
<td class="gt_row gt_right" headers="adj_p_value">0.828</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cytokine">TNFa</td>
<td class="gt_row gt_right" headers="W">2436</td>
<td class="gt_row gt_right" headers="estimate">−0.154</td>
<td class="gt_row gt_right" headers="CI_lower">−0.397</td>
<td class="gt_row gt_right" headers="CI_upper">0.116</td>
<td class="gt_row gt_right" headers="adj_p_value">0.363</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cytokine">IL-23</td>
<td class="gt_row gt_right" headers="W">2469</td>
<td class="gt_row gt_right" headers="estimate">−0.167</td>
<td class="gt_row gt_right" headers="CI_lower">−0.498</td>
<td class="gt_row gt_right" headers="CI_upper">0.160</td>
<td class="gt_row gt_right" headers="adj_p_value">0.375</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
</section>
<section id="transformed-concentrations-excluding-samples-with-many-oor-features" class="level3" data-number="1.2.3">
<h3 data-number="1.2.3" class="anchored" data-anchor-id="transformed-concentrations-excluding-samples-with-many-oor-features"><span class="header-section-number">1.2.3</span> Transformed concentrations (excluding samples with many OOR features)</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a>assay_name <span class="ot">&lt;-</span> <span class="st">"cytokine_transformed"</span></span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a>value_label <span class="ot">&lt;-</span> <span class="st">"PC1-subtracted z-log10(conc.)"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a>cytokines_long <span class="ot">&lt;-</span> </span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_assay_long_format</span>(</span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a>    mae, assay_name, </span>
<span id="cb142-4"><a href="#cb142-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">feature_name =</span> <span class="st">"cytokine"</span>, <span class="at">values_name =</span> <span class="st">"value"</span></span>
<span id="cb142-5"><a href="#cb142-5" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb142-6"><a href="#cb142-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Visit =</span> <span class="fu">get_visit_labels</span>(AVISITN)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"N cytokines: "</span>, <span class="fu">length</span>(<span class="fu">unique</span>(cytokines_long<span class="sc">$</span>cytokine)), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>N cytokines:  13 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"N samples: "</span>, <span class="fu">length</span>(<span class="fu">unique</span>(cytokines_long<span class="sc">$</span>Barcode)), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>N samples:  1098 </code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="fu">map</span>(</span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a>  cytokine_groups,</span>
<span id="cb147-3"><a href="#cb147-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">function</span>(cytokines, cytokines_long){</span>
<span id="cb147-4"><a href="#cb147-4" aria-hidden="true" tabindex="-1"></a>    cytokines_long <span class="sc">|&gt;</span> </span>
<span id="cb147-5"><a href="#cb147-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(PIPV, cytokine <span class="sc">%in%</span> cytokines) <span class="sc">|&gt;</span> </span>
<span id="cb147-6"><a href="#cb147-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">plot_longitudinal_cytokines</span>(<span class="at">value_label =</span> value_label)</span>
<span id="cb147-7"><a href="#cb147-7" aria-hidden="true" tabindex="-1"></a>  },</span>
<span id="cb147-8"><a href="#cb147-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">cytokines_long =</span> cytokines_long</span>
<span id="cb147-9"><a href="#cb147-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-91-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[2]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-91-2.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[3]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-91-3.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a>cytokines_long <span class="sc">|&gt;</span> </span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(PIPV) <span class="sc">|&gt;</span> </span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Visit, <span class="at">y =</span> value, <span class="at">fill =</span> ARM)) <span class="sc">+</span></span>
<span id="cb151-4"><a href="#cb151-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span> </span>
<span id="cb151-5"><a href="#cb151-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_jitter(height = 0, width = 0.1, size = 0.5) +</span></span>
<span id="cb151-6"><a href="#cb151-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(cytokine <span class="sc">~</span> ., <span class="at">scales =</span> <span class="st">"free_y"</span>, <span class="at">nrow =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb151-7"><a href="#cb151-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">get_arm_colors</span>()) <span class="sc">+</span></span>
<span id="cb151-8"><a href="#cb151-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(value_label) <span class="sc">+</span></span>
<span id="cb151-9"><a href="#cb151-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-92-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a>categories_levels <span class="ot">&lt;-</span> </span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">"≥ 50% L. crispatus"</span>, <span class="st">"≥ 50% Lactobacillus, &lt; 50% L. crispatus"</span>, <span class="st">"&lt; 50% Lactobacillus"</span>)</span>
<span id="cb152-3"><a href="#cb152-3" aria-hidden="true" tabindex="-1"></a>microbiota_categories <span class="ot">&lt;-</span> </span>
<span id="cb152-4"><a href="#cb152-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_assay_long_format</span>(</span>
<span id="cb152-5"><a href="#cb152-5" aria-hidden="true" tabindex="-1"></a>    mae, <span class="st">"mb_categories"</span>, <span class="at">add_colData =</span> <span class="cn">FALSE</span>, <span class="at">values_name =</span> <span class="st">"microbiota"</span></span>
<span id="cb152-6"><a href="#cb152-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb152-7"><a href="#cb152-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>feature) <span class="sc">|&gt;</span> </span>
<span id="cb152-8"><a href="#cb152-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">microbiota =</span> microbiota <span class="sc">|&gt;</span> <span class="fu">factor</span>(<span class="at">levels =</span> categories_levels))</span>
<span id="cb152-9"><a href="#cb152-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-10"><a href="#cb152-10" aria-hidden="true" tabindex="-1"></a>cytokines_long <span class="ot">&lt;-</span> </span>
<span id="cb152-11"><a href="#cb152-11" aria-hidden="true" tabindex="-1"></a>  cytokines_long <span class="sc">|&gt;</span> </span>
<span id="cb152-12"><a href="#cb152-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">any_of</span>(<span class="fu">c</span>(<span class="st">"microbiota"</span>))) <span class="sc">|&gt;</span> </span>
<span id="cb152-13"><a href="#cb152-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(microbiota_categories, <span class="at">by =</span> <span class="fu">join_by</span>(Barcode))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="fu">map</span>(</span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a>  cytokine_groups,</span>
<span id="cb153-3"><a href="#cb153-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">function</span>(cytokines, cytokines_long){</span>
<span id="cb153-4"><a href="#cb153-4" aria-hidden="true" tabindex="-1"></a>    cytokines_long <span class="sc">|&gt;</span> </span>
<span id="cb153-5"><a href="#cb153-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(cytokine <span class="sc">%in%</span> cytokines) <span class="sc">|&gt;</span> </span>
<span id="cb153-6"><a href="#cb153-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">plot_longitudinal_cytokines_by_arm_and_category</span>(<span class="at">value_label =</span> value_label)</span>
<span id="cb153-7"><a href="#cb153-7" aria-hidden="true" tabindex="-1"></a>  },</span>
<span id="cb153-8"><a href="#cb153-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">cytokines_long =</span> cytokines_long</span>
<span id="cb153-9"><a href="#cb153-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-94-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[2]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-94-2.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[3]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-94-3.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a>cytokines_long <span class="sc">|&gt;</span> </span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(cytokine <span class="sc">%in%</span> selected_cytokines) <span class="sc">|&gt;</span></span>
<span id="cb157-3"><a href="#cb157-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_longitudinal_cytokines_by_arm_and_category</span>(<span class="at">value_label =</span> value_label)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-95-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="fu">map</span>(</span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a>  cytokine_groups,</span>
<span id="cb158-3"><a href="#cb158-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">function</span>(cytokines, cytokines_long){</span>
<span id="cb158-4"><a href="#cb158-4" aria-hidden="true" tabindex="-1"></a>    cytokines_long <span class="sc">|&gt;</span> </span>
<span id="cb158-5"><a href="#cb158-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(cytokine <span class="sc">%in%</span> cytokines) <span class="sc">|&gt;</span> </span>
<span id="cb158-6"><a href="#cb158-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">plot_longitudinal_cytokines_by_category</span>(<span class="at">value_label =</span> value_label)</span>
<span id="cb158-7"><a href="#cb158-7" aria-hidden="true" tabindex="-1"></a>  },</span>
<span id="cb158-8"><a href="#cb158-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">cytokines_long =</span> cytokines_long</span>
<span id="cb158-9"><a href="#cb158-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-96-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[2]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-96-2.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[3]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-96-3.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<section id="differentiating-ctv-05-from-other-l.-crispatus.-2" class="level5" data-number="1.2.3.0.1">
<h5 data-number="1.2.3.0.1" class="anchored" data-anchor-id="differentiating-ctv-05-from-other-l.-crispatus.-2"><span class="header-section-number">1.2.3.0.1</span> Differentiating CTV-05 from other <em>L. crispatus</em>.</h5>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a>ctv05_cat_levels <span class="ot">&lt;-</span> </span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">"≥ 50% CTV-05"</span>, categories_levels, <span class="st">"Undetermined"</span>)</span>
<span id="cb162-3"><a href="#cb162-3" aria-hidden="true" tabindex="-1"></a>microbiota_categories <span class="ot">&lt;-</span> </span>
<span id="cb162-4"><a href="#cb162-4" aria-hidden="true" tabindex="-1"></a>  microbiota_categories <span class="sc">|&gt;</span> </span>
<span id="cb162-5"><a href="#cb162-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(</span>
<span id="cb162-6"><a href="#cb162-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">get_assay_long_format</span>(</span>
<span id="cb162-7"><a href="#cb162-7" aria-hidden="true" tabindex="-1"></a>      mae, <span class="st">"MG_CTV05"</span>, <span class="at">add_colData =</span> <span class="cn">FALSE</span>, <span class="at">values_name =</span> <span class="st">"prop"</span></span>
<span id="cb162-8"><a href="#cb162-8" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">|&gt;</span> <span class="fu">filter</span>(feature <span class="sc">==</span> <span class="st">"CTV-05"</span>),</span>
<span id="cb162-9"><a href="#cb162-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">by =</span> <span class="fu">join_by</span>(Barcode)</span>
<span id="cb162-10"><a href="#cb162-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb162-11"><a href="#cb162-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>feature) <span class="sc">|&gt;</span> </span>
<span id="cb162-12"><a href="#cb162-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb162-13"><a href="#cb162-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">microbiota_ctv05 =</span> </span>
<span id="cb162-14"><a href="#cb162-14" aria-hidden="true" tabindex="-1"></a>      <span class="fu">case_when</span>(</span>
<span id="cb162-15"><a href="#cb162-15" aria-hidden="true" tabindex="-1"></a>        prop <span class="sc">&gt;=</span> <span class="fl">0.5</span> <span class="sc">~</span> <span class="st">"≥ 50% CTV-05"</span>,</span>
<span id="cb162-16"><a href="#cb162-16" aria-hidden="true" tabindex="-1"></a>        <span class="fu">is.na</span>(microbiota) <span class="sc">~</span> <span class="st">"Undetermined"</span>,</span>
<span id="cb162-17"><a href="#cb162-17" aria-hidden="true" tabindex="-1"></a>        <span class="cn">TRUE</span> <span class="sc">~</span> microbiota <span class="sc">|&gt;</span> <span class="fu">as.character</span>()</span>
<span id="cb162-18"><a href="#cb162-18" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">|&gt;</span> </span>
<span id="cb162-19"><a href="#cb162-19" aria-hidden="true" tabindex="-1"></a>      <span class="fu">factor</span>(<span class="at">levels =</span> ctv05_cat_levels)</span>
<span id="cb162-20"><a href="#cb162-20" aria-hidden="true" tabindex="-1"></a>  )  </span>
<span id="cb162-21"><a href="#cb162-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-22"><a href="#cb162-22" aria-hidden="true" tabindex="-1"></a>cytokines_long <span class="ot">&lt;-</span> </span>
<span id="cb162-23"><a href="#cb162-23" aria-hidden="true" tabindex="-1"></a>  cytokines_long <span class="sc">|&gt;</span> </span>
<span id="cb162-24"><a href="#cb162-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">any_of</span>(<span class="st">"microbiota_ctv05"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb162-25"><a href="#cb162-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(</span>
<span id="cb162-26"><a href="#cb162-26" aria-hidden="true" tabindex="-1"></a>    microbiota_categories <span class="sc">|&gt;</span> <span class="fu">select</span>(Barcode, microbiota_ctv05), </span>
<span id="cb162-27"><a href="#cb162-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">by =</span> <span class="fu">join_by</span>(Barcode)</span>
<span id="cb162-28"><a href="#cb162-28" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb162-29"><a href="#cb162-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb162-30"><a href="#cb162-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">microbiota_ctv05 =</span> </span>
<span id="cb162-31"><a href="#cb162-31" aria-hidden="true" tabindex="-1"></a>      microbiota_ctv05 <span class="sc">|&gt;</span> </span>
<span id="cb162-32"><a href="#cb162-32" aria-hidden="true" tabindex="-1"></a>      <span class="fu">replace_na</span>(<span class="fu">factor</span>(<span class="st">"Undetermined"</span>, <span class="at">levels =</span> ctv05_cat_levels))</span>
<span id="cb162-33"><a href="#cb162-33" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>With samples from both arms.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="fu">map</span>(</span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a>  cytokine_groups,</span>
<span id="cb163-3"><a href="#cb163-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">function</span>(cytokines, cytokines_long){</span>
<span id="cb163-4"><a href="#cb163-4" aria-hidden="true" tabindex="-1"></a>    cytokines_long <span class="sc">|&gt;</span> </span>
<span id="cb163-5"><a href="#cb163-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(cytokine <span class="sc">%in%</span> cytokines) <span class="sc">|&gt;</span> </span>
<span id="cb163-6"><a href="#cb163-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">plot_longitudinal_cytokines_by_ctv05_cat</span>(<span class="at">value_label =</span> value_label)</span>
<span id="cb163-7"><a href="#cb163-7" aria-hidden="true" tabindex="-1"></a>  },</span>
<span id="cb163-8"><a href="#cb163-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">cytokines_long =</span> cytokines_long</span>
<span id="cb163-9"><a href="#cb163-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-98-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[2]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-98-2.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[3]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-98-3.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<p>With samples from the Lactin-V arm only</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="fu">map</span>(</span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a>  cytokine_groups,</span>
<span id="cb167-3"><a href="#cb167-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">function</span>(cytokines, cytokines_long){</span>
<span id="cb167-4"><a href="#cb167-4" aria-hidden="true" tabindex="-1"></a>    cytokines_long <span class="sc">|&gt;</span> </span>
<span id="cb167-5"><a href="#cb167-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(ARM <span class="sc">==</span> <span class="st">"LACTIN-V"</span>, cytokine <span class="sc">%in%</span> cytokines) <span class="sc">|&gt;</span> </span>
<span id="cb167-6"><a href="#cb167-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">plot_longitudinal_cytokines_by_ctv05_cat</span>(<span class="at">value_label =</span> value_label)</span>
<span id="cb167-7"><a href="#cb167-7" aria-hidden="true" tabindex="-1"></a>  },</span>
<span id="cb167-8"><a href="#cb167-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">cytokines_long =</span> cytokines_long</span>
<span id="cb167-9"><a href="#cb167-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-99-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[2]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-99-2.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[3]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-99-3.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a>cytokines_long <span class="sc">|&gt;</span> </span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(cytokine <span class="sc">%in%</span> <span class="st">"IP-10"</span>)  <span class="sc">|&gt;</span> </span>
<span id="cb171-3"><a href="#cb171-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_longitudinal_cytokines_by_ctv05_cat</span>(<span class="at">value_label =</span> value_label) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-100-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb172"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="co"># checking for differences between CTV05 and "native" L. crispatus in both arms</span></span>
<span id="cb172-2"><a href="#cb172-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-3"><a href="#cb172-3" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> </span>
<span id="cb172-4"><a href="#cb172-4" aria-hidden="true" tabindex="-1"></a>  cytokines_long <span class="sc">|&gt;</span> </span>
<span id="cb172-5"><a href="#cb172-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(cytokine <span class="sc">%in%</span> <span class="st">"IP-10"</span>, PIPV) <span class="sc">|&gt;</span></span>
<span id="cb172-6"><a href="#cb172-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(microbiota_ctv05 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"≥ 50% CTV-05"</span>, <span class="st">"≥ 50% L. crispatus"</span>))</span>
<span id="cb172-7"><a href="#cb172-7" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb172-8"><a href="#cb172-8" aria-hidden="true" tabindex="-1"></a>mmod <span class="ot">&lt;-</span> lme4<span class="sc">::</span><span class="fu">lmer</span>(value <span class="sc">~</span> microbiota_ctv05 <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>USUBJID), <span class="at">data =</span> tmp) </span>
<span id="cb172-9"><a href="#cb172-9" aria-hidden="true" tabindex="-1"></a>mmod <span class="sc">|&gt;</span> <span class="fu">summary</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: value ~ microbiota_ctv05 + (1 | USUBJID)
   Data: tmp

REML criterion at convergence: 349

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-2.5599 -0.5342  0.0092  0.4614  3.5243 

Random effects:
 Groups   Name        Variance Std.Dev.
 USUBJID  (Intercept) 0.1348   0.3672  
 Residual             0.2319   0.4816  
Number of obs: 199, groups:  USUBJID, 89

Fixed effects:
                                   Estimate Std. Error t value
(Intercept)                         0.53838    0.06205   8.676
microbiota_ctv05≥ 50% L. crispatus  0.06484    0.10440   0.621</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Correlation of Fixed Effects:</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>            (Intr)
mc_05≥50%Lc -0.505</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">Anova</span>(mmod, <span class="at">type =</span> <span class="st">"III"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table (Type III Wald chisquare tests)

Response: value
                   Chisq Df Pr(&gt;Chisq)    
(Intercept)      75.2798  1     &lt;2e-16 ***
microbiota_ctv05  0.3858  1     0.5345    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> </span>
<span id="cb178-2"><a href="#cb178-2" aria-hidden="true" tabindex="-1"></a>  cytokines_long <span class="sc">|&gt;</span> </span>
<span id="cb178-3"><a href="#cb178-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(cytokine <span class="sc">%in%</span> <span class="st">"IP-10"</span>, AVISITN <span class="sc">==</span> <span class="dv">4</span>) <span class="sc">|&gt;</span></span>
<span id="cb178-4"><a href="#cb178-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(microbiota_ctv05 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"≥ 50% CTV-05"</span>, <span class="st">"≥ 50% L. crispatus"</span>))</span>
<span id="cb178-5"><a href="#cb178-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb178-6"><a href="#cb178-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(value <span class="sc">~</span> microbiota_ctv05, <span class="at">data =</span> tmp) <span class="sc">|&gt;</span></span>
<span id="cb178-7"><a href="#cb178-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = value ~ microbiota_ctv05, data = tmp)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.89814 -0.30794 -0.07058  0.27353  1.26278 

Coefficients:
                                   Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                         0.45411    0.08452   5.372 3.84e-06 ***
microbiota_ctv05≥ 50% L. crispatus  0.22667    0.15624   1.451    0.155    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.4552 on 39 degrees of freedom
Multiple R-squared:  0.05121,   Adjusted R-squared:  0.02688 
F-statistic: 2.105 on 1 and 39 DF,  p-value: 0.1548</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb180"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="co"># checking for differences between CTV05 and "native" L. crispatus in the Lactin-V arm only</span></span>
<span id="cb180-2"><a href="#cb180-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-3"><a href="#cb180-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-4"><a href="#cb180-4" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> </span>
<span id="cb180-5"><a href="#cb180-5" aria-hidden="true" tabindex="-1"></a>  cytokines_long <span class="sc">|&gt;</span> </span>
<span id="cb180-6"><a href="#cb180-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ARM <span class="sc">==</span> <span class="st">"LACTIN-V"</span>, cytokine <span class="sc">%in%</span> <span class="st">"IP-10"</span>, PIPV) <span class="sc">|&gt;</span></span>
<span id="cb180-7"><a href="#cb180-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(microbiota_ctv05 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"≥ 50% CTV-05"</span>, <span class="st">"≥ 50% L. crispatus"</span>))</span>
<span id="cb180-8"><a href="#cb180-8" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb180-9"><a href="#cb180-9" aria-hidden="true" tabindex="-1"></a>mmod <span class="ot">&lt;-</span> lme4<span class="sc">::</span><span class="fu">lmer</span>(value <span class="sc">~</span> microbiota_ctv05 <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>USUBJID), <span class="at">data =</span> tmp) </span>
<span id="cb180-10"><a href="#cb180-10" aria-hidden="true" tabindex="-1"></a>mmod <span class="sc">|&gt;</span> <span class="fu">summary</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: value ~ microbiota_ctv05 + (1 | USUBJID)
   Data: tmp

REML criterion at convergence: 312.5

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-2.5158 -0.5335 -0.0069  0.4744  3.5141 

Random effects:
 Groups   Name        Variance Std.Dev.
 USUBJID  (Intercept) 0.1333   0.3651  
 Residual             0.2339   0.4837  
Number of obs: 178, groups:  USUBJID, 78

Fixed effects:
                                   Estimate Std. Error t value
(Intercept)                         0.53502    0.06215   8.608
microbiota_ctv05≥ 50% L. crispatus  0.01935    0.12040   0.161</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Correlation of Fixed Effects:</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>            (Intr)
mc_05≥50%Lc -0.402</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb184"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">Anova</span>(mmod, <span class="at">type =</span> <span class="st">"III"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table (Type III Wald chisquare tests)

Response: value
                   Chisq Df Pr(&gt;Chisq)    
(Intercept)      74.0951  1     &lt;2e-16 ***
microbiota_ctv05  0.0258  1     0.8724    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb186"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> </span>
<span id="cb186-2"><a href="#cb186-2" aria-hidden="true" tabindex="-1"></a>  cytokines_long <span class="sc">|&gt;</span> </span>
<span id="cb186-3"><a href="#cb186-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ARM <span class="sc">==</span> <span class="st">"LACTIN-V"</span>, cytokine <span class="sc">%in%</span> <span class="st">"IP-10"</span>, AVISITN <span class="sc">==</span> <span class="dv">4</span>) <span class="sc">|&gt;</span></span>
<span id="cb186-4"><a href="#cb186-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(microbiota_ctv05 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"≥ 50% CTV-05"</span>, <span class="st">"≥ 50% L. crispatus"</span>))</span>
<span id="cb186-5"><a href="#cb186-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb186-6"><a href="#cb186-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(value <span class="sc">~</span> microbiota_ctv05, <span class="at">data =</span> tmp) <span class="sc">|&gt;</span></span>
<span id="cb186-7"><a href="#cb186-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = value ~ microbiota_ctv05, data = tmp)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.89814 -0.30833 -0.06862  0.28444  1.26278 

Coefficients:
                                   Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                         0.45411    0.08629   5.263 7.83e-06 ***
microbiota_ctv05≥ 50% L. crispatus  0.19594    0.19568   1.001    0.324    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.4647 on 34 degrees of freedom
Multiple R-squared:  0.02865,   Adjusted R-squared:  7.581e-05 
F-statistic: 1.003 on 1 and 34 DF,  p-value: 0.3237</code></pre>
</div>
</div>
</section>
<section id="difference-to-pre-mtz-transformed-concentrations-2" class="level4" data-number="1.2.3.1">
<h4 data-number="1.2.3.1" class="anchored" data-anchor-id="difference-to-pre-mtz-transformed-concentrations-2"><span class="header-section-number">1.2.3.1</span> Difference to pre-MTZ transformed concentrations</h4>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb188"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a>preMTZ_cytokines <span class="ot">&lt;-</span> </span>
<span id="cb188-2"><a href="#cb188-2" aria-hidden="true" tabindex="-1"></a>  cytokines_long <span class="sc">|&gt;</span></span>
<span id="cb188-3"><a href="#cb188-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(AVISITN <span class="sc">==</span> <span class="dv">0</span>) <span class="sc">|&gt;</span></span>
<span id="cb188-4"><a href="#cb188-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(USUBJID, cytokine, value) <span class="sc">|&gt;</span> </span>
<span id="cb188-5"><a href="#cb188-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">pre_MTZ_value =</span> value)</span>
<span id="cb188-6"><a href="#cb188-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-7"><a href="#cb188-7" aria-hidden="true" tabindex="-1"></a>cytokines_to_preMTZ <span class="ot">&lt;-</span> </span>
<span id="cb188-8"><a href="#cb188-8" aria-hidden="true" tabindex="-1"></a>  cytokines_long <span class="sc">|&gt;</span> </span>
<span id="cb188-9"><a href="#cb188-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(PIPV, AVISITN <span class="sc">!=</span> <span class="dv">0</span>) <span class="sc">|&gt;</span> </span>
<span id="cb188-10"><a href="#cb188-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Visit =</span> <span class="fu">get_visit_labels</span>(AVISITN)) <span class="sc">|&gt;</span></span>
<span id="cb188-11"><a href="#cb188-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Barcode, USUBJID, Visit, ARM, cytokine, value, microbiota) <span class="sc">|&gt;</span> </span>
<span id="cb188-12"><a href="#cb188-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(preMTZ_cytokines, <span class="at">by =</span> <span class="fu">join_by</span>(USUBJID, cytokine)) <span class="sc">|&gt;</span> </span>
<span id="cb188-13"><a href="#cb188-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(pre_MTZ_value)) <span class="sc">|&gt;</span> </span>
<span id="cb188-14"><a href="#cb188-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">diff =</span> value <span class="sc">-</span> pre_MTZ_value)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb189"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="fu">map</span>(</span>
<span id="cb189-2"><a href="#cb189-2" aria-hidden="true" tabindex="-1"></a>  cytokine_groups,</span>
<span id="cb189-3"><a href="#cb189-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">function</span>(cytokines, cytokines_to_preMTZ){</span>
<span id="cb189-4"><a href="#cb189-4" aria-hidden="true" tabindex="-1"></a>    cytokines_to_preMTZ <span class="sc">|&gt;</span> </span>
<span id="cb189-5"><a href="#cb189-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(cytokine <span class="sc">%in%</span> cytokines) <span class="sc">|&gt;</span> </span>
<span id="cb189-6"><a href="#cb189-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">plot_cytokine_to_preMTZ</span>(<span class="at">value_label =</span> value_label)</span>
<span id="cb189-7"><a href="#cb189-7" aria-hidden="true" tabindex="-1"></a>  },</span>
<span id="cb189-8"><a href="#cb189-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">cytokines_to_preMTZ =</span> cytokines_to_preMTZ</span>
<span id="cb189-9"><a href="#cb189-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-104-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[2]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-104-2.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[3]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-104-3.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb193"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a>g_selection <span class="ot">&lt;-</span> </span>
<span id="cb193-2"><a href="#cb193-2" aria-hidden="true" tabindex="-1"></a>  cytokines_to_preMTZ <span class="sc">|&gt;</span> </span>
<span id="cb193-3"><a href="#cb193-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(cytokine <span class="sc">%in%</span> selected_cytokines) <span class="sc">|&gt;</span> </span>
<span id="cb193-4"><a href="#cb193-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cytokine =</span> cytokine <span class="sc">|&gt;</span> <span class="fu">factor</span>(<span class="at">levels =</span> selected_cytokines)) <span class="sc">|&gt;</span> </span>
<span id="cb193-5"><a href="#cb193-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_cytokine_to_preMTZ</span>(<span class="at">value_label =</span> value_label) </span>
<span id="cb193-6"><a href="#cb193-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-7"><a href="#cb193-7" aria-hidden="true" tabindex="-1"></a>g_selection</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-105-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb194"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(g_selection, <span class="at">file =</span> <span class="fu">str_c</span>(<span class="fu">data_dir</span>(), <span class="st">"05_figures_tables/fig_3a_PC1_subtracted.Rdata"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="effects-of-intervention-at-week-24-2" class="level4" data-number="1.2.3.2">
<h4 data-number="1.2.3.2" class="anchored" data-anchor-id="effects-of-intervention-at-week-24-2"><span class="header-section-number">1.2.3.2</span> Effects of intervention at week 24</h4>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb195"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> </span>
<span id="cb195-2"><a href="#cb195-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(</span>
<span id="cb195-3"><a href="#cb195-3" aria-hidden="true" tabindex="-1"></a>    cytokine_names,</span>
<span id="cb195-4"><a href="#cb195-4" aria-hidden="true" tabindex="-1"></a>    effects_of_intervention,</span>
<span id="cb195-5"><a href="#cb195-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">cytokines_long =</span> cytokines_long</span>
<span id="cb195-6"><a href="#cb195-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb195-7"><a href="#cb195-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb196"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a>res <span class="sc">|&gt;</span> <span class="fu">select</span>(cytokine, <span class="fu">ends_with</span>(<span class="st">"pval"</span>)) <span class="sc">|&gt;</span> <span class="fu">distinct</span>() <span class="sc">|&gt;</span> </span>
<span id="cb196-2"><a href="#cb196-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>(<span class="at">caption =</span> <span class="st">"Model validity tests from DHARMa simulations"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb196-3"><a href="#cb196-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(</span>
<span id="cb196-4"><a href="#cb196-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">everything</span>(),</span>
<span id="cb196-5"><a href="#cb196-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">decimals =</span> <span class="dv">3</span></span>
<span id="cb196-6"><a href="#cb196-6" aria-hidden="true" tabindex="-1"></a>  ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="egmwpikpyz" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#egmwpikpyz table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#egmwpikpyz thead, #egmwpikpyz tbody, #egmwpikpyz tfoot, #egmwpikpyz tr, #egmwpikpyz td, #egmwpikpyz th {
  border-style: none;
}

#egmwpikpyz p {
  margin: 0;
  padding: 0;
}

#egmwpikpyz .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#egmwpikpyz .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#egmwpikpyz .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#egmwpikpyz .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#egmwpikpyz .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#egmwpikpyz .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#egmwpikpyz .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#egmwpikpyz .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#egmwpikpyz .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#egmwpikpyz .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#egmwpikpyz .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#egmwpikpyz .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#egmwpikpyz .gt_spanner_row {
  border-bottom-style: hidden;
}

#egmwpikpyz .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#egmwpikpyz .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#egmwpikpyz .gt_from_md > :first-child {
  margin-top: 0;
}

#egmwpikpyz .gt_from_md > :last-child {
  margin-bottom: 0;
}

#egmwpikpyz .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#egmwpikpyz .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#egmwpikpyz .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#egmwpikpyz .gt_row_group_first td {
  border-top-width: 2px;
}

#egmwpikpyz .gt_row_group_first th {
  border-top-width: 2px;
}

#egmwpikpyz .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#egmwpikpyz .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#egmwpikpyz .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#egmwpikpyz .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#egmwpikpyz .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#egmwpikpyz .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#egmwpikpyz .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#egmwpikpyz .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#egmwpikpyz .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#egmwpikpyz .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#egmwpikpyz .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#egmwpikpyz .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#egmwpikpyz .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#egmwpikpyz .gt_left {
  text-align: left;
}

#egmwpikpyz .gt_center {
  text-align: center;
}

#egmwpikpyz .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#egmwpikpyz .gt_font_normal {
  font-weight: normal;
}

#egmwpikpyz .gt_font_bold {
  font-weight: bold;
}

#egmwpikpyz .gt_font_italic {
  font-style: italic;
}

#egmwpikpyz .gt_super {
  font-size: 65%;
}

#egmwpikpyz .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#egmwpikpyz .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#egmwpikpyz .gt_indent_1 {
  text-indent: 5px;
}

#egmwpikpyz .gt_indent_2 {
  text-indent: 10px;
}

#egmwpikpyz .gt_indent_3 {
  text-indent: 15px;
}

#egmwpikpyz .gt_indent_4 {
  text-indent: 20px;
}

#egmwpikpyz .gt_indent_5 {
  text-indent: 25px;
}

#egmwpikpyz .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#egmwpikpyz div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<caption>Model validity tests from DHARMa simulations</caption>
<thead>
<tr class="gt_col_headings header">
<th id="cytokine" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">cytokine</th>
<th id="t_u_pval" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">t_u_pval</th>
<th id="t_d_pval" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">t_d_pval</th>
<th id="t_o_pval" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">t_o_pval</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="cytokine">ITAC</td>
<td class="gt_row gt_right" headers="t_u_pval">0.203</td>
<td class="gt_row gt_right" headers="t_d_pval">0.792</td>
<td class="gt_row gt_right" headers="t_o_pval">0.491</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cytokine">MIG</td>
<td class="gt_row gt_right" headers="t_u_pval">0.724</td>
<td class="gt_row gt_right" headers="t_d_pval">0.960</td>
<td class="gt_row gt_right" headers="t_o_pval">0.861</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cytokine">IP-10</td>
<td class="gt_row gt_right" headers="t_u_pval">0.164</td>
<td class="gt_row gt_right" headers="t_d_pval">0.840</td>
<td class="gt_row gt_right" headers="t_o_pval">0.600</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cytokine">IFNg</td>
<td class="gt_row gt_right" headers="t_u_pval">0.000</td>
<td class="gt_row gt_right" headers="t_d_pval">0.880</td>
<td class="gt_row gt_right" headers="t_o_pval">0.005</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cytokine">IL-17</td>
<td class="gt_row gt_right" headers="t_u_pval">0.044</td>
<td class="gt_row gt_right" headers="t_d_pval">0.784</td>
<td class="gt_row gt_right" headers="t_o_pval">0.382</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cytokine">IL-1a</td>
<td class="gt_row gt_right" headers="t_u_pval">0.362</td>
<td class="gt_row gt_right" headers="t_d_pval">0.976</td>
<td class="gt_row gt_right" headers="t_o_pval">0.014</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cytokine">IL-1b</td>
<td class="gt_row gt_right" headers="t_u_pval">0.003</td>
<td class="gt_row gt_right" headers="t_d_pval">0.984</td>
<td class="gt_row gt_right" headers="t_o_pval">0.861</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cytokine">MIP-1a</td>
<td class="gt_row gt_right" headers="t_u_pval">0.000</td>
<td class="gt_row gt_right" headers="t_d_pval">0.824</td>
<td class="gt_row gt_right" headers="t_o_pval">0.861</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cytokine">MIP-1b</td>
<td class="gt_row gt_right" headers="t_u_pval">0.000</td>
<td class="gt_row gt_right" headers="t_d_pval">0.880</td>
<td class="gt_row gt_right" headers="t_o_pval">0.221</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cytokine">MIP-3a</td>
<td class="gt_row gt_right" headers="t_u_pval">0.226</td>
<td class="gt_row gt_right" headers="t_d_pval">0.904</td>
<td class="gt_row gt_right" headers="t_o_pval">0.861</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cytokine">IL-6</td>
<td class="gt_row gt_right" headers="t_u_pval">0.000</td>
<td class="gt_row gt_right" headers="t_d_pval">0.904</td>
<td class="gt_row gt_right" headers="t_o_pval">0.491</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cytokine">TNFa</td>
<td class="gt_row gt_right" headers="t_u_pval">0.018</td>
<td class="gt_row gt_right" headers="t_d_pval">0.880</td>
<td class="gt_row gt_right" headers="t_o_pval">0.116</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cytokine">IL-23</td>
<td class="gt_row gt_right" headers="t_u_pval">0.040</td>
<td class="gt_row gt_right" headers="t_d_pval">0.752</td>
<td class="gt_row gt_right" headers="t_o_pval">0.730</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Caution! Model assumptions are not met for most cytokines (likely because of the LLOQ and ULOQ imputed values).</p>
<p>We try again using ranks instead of the original values.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb197"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>) <span class="co"># rank uses random numbers to break ties</span></span>
<span id="cb197-2"><a href="#cb197-2" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> </span>
<span id="cb197-3"><a href="#cb197-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(</span>
<span id="cb197-4"><a href="#cb197-4" aria-hidden="true" tabindex="-1"></a>    cytokine_names,</span>
<span id="cb197-5"><a href="#cb197-5" aria-hidden="true" tabindex="-1"></a>    effects_of_intervention,</span>
<span id="cb197-6"><a href="#cb197-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">cytokines_long =</span> cytokines_long,</span>
<span id="cb197-7"><a href="#cb197-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">use_ranks =</span> <span class="cn">TRUE</span></span>
<span id="cb197-8"><a href="#cb197-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb197-9"><a href="#cb197-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb198"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a>res <span class="sc">|&gt;</span> <span class="fu">select</span>(cytokine, <span class="fu">ends_with</span>(<span class="st">"pval"</span>)) <span class="sc">|&gt;</span> <span class="fu">distinct</span>() <span class="sc">|&gt;</span> </span>
<span id="cb198-2"><a href="#cb198-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>(<span class="at">caption =</span> <span class="st">"Model validity tests from DHARMa simulations"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb198-3"><a href="#cb198-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(</span>
<span id="cb198-4"><a href="#cb198-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">everything</span>(),</span>
<span id="cb198-5"><a href="#cb198-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">decimals =</span> <span class="dv">3</span></span>
<span id="cb198-6"><a href="#cb198-6" aria-hidden="true" tabindex="-1"></a>  ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="ckrmibnlhc" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#ckrmibnlhc table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ckrmibnlhc thead, #ckrmibnlhc tbody, #ckrmibnlhc tfoot, #ckrmibnlhc tr, #ckrmibnlhc td, #ckrmibnlhc th {
  border-style: none;
}

#ckrmibnlhc p {
  margin: 0;
  padding: 0;
}

#ckrmibnlhc .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ckrmibnlhc .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ckrmibnlhc .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ckrmibnlhc .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ckrmibnlhc .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ckrmibnlhc .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ckrmibnlhc .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ckrmibnlhc .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ckrmibnlhc .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ckrmibnlhc .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ckrmibnlhc .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ckrmibnlhc .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ckrmibnlhc .gt_spanner_row {
  border-bottom-style: hidden;
}

#ckrmibnlhc .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ckrmibnlhc .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ckrmibnlhc .gt_from_md > :first-child {
  margin-top: 0;
}

#ckrmibnlhc .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ckrmibnlhc .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ckrmibnlhc .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ckrmibnlhc .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ckrmibnlhc .gt_row_group_first td {
  border-top-width: 2px;
}

#ckrmibnlhc .gt_row_group_first th {
  border-top-width: 2px;
}

#ckrmibnlhc .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ckrmibnlhc .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ckrmibnlhc .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ckrmibnlhc .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ckrmibnlhc .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ckrmibnlhc .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ckrmibnlhc .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ckrmibnlhc .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ckrmibnlhc .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ckrmibnlhc .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ckrmibnlhc .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ckrmibnlhc .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ckrmibnlhc .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ckrmibnlhc .gt_left {
  text-align: left;
}

#ckrmibnlhc .gt_center {
  text-align: center;
}

#ckrmibnlhc .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ckrmibnlhc .gt_font_normal {
  font-weight: normal;
}

#ckrmibnlhc .gt_font_bold {
  font-weight: bold;
}

#ckrmibnlhc .gt_font_italic {
  font-style: italic;
}

#ckrmibnlhc .gt_super {
  font-size: 65%;
}

#ckrmibnlhc .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ckrmibnlhc .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ckrmibnlhc .gt_indent_1 {
  text-indent: 5px;
}

#ckrmibnlhc .gt_indent_2 {
  text-indent: 10px;
}

#ckrmibnlhc .gt_indent_3 {
  text-indent: 15px;
}

#ckrmibnlhc .gt_indent_4 {
  text-indent: 20px;
}

#ckrmibnlhc .gt_indent_5 {
  text-indent: 25px;
}

#ckrmibnlhc .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#ckrmibnlhc div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<caption>Model validity tests from DHARMa simulations</caption>
<thead>
<tr class="gt_col_headings header">
<th id="cytokine" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">cytokine</th>
<th id="t_u_pval" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">t_u_pval</th>
<th id="t_d_pval" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">t_d_pval</th>
<th id="t_o_pval" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">t_o_pval</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="cytokine">ITAC</td>
<td class="gt_row gt_right" headers="t_u_pval">0.001</td>
<td class="gt_row gt_right" headers="t_d_pval">0.760</td>
<td class="gt_row gt_right" headers="t_o_pval">0.000</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cytokine">MIG</td>
<td class="gt_row gt_right" headers="t_u_pval">0.016</td>
<td class="gt_row gt_right" headers="t_d_pval">0.952</td>
<td class="gt_row gt_right" headers="t_o_pval">0.005</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cytokine">IP-10</td>
<td class="gt_row gt_right" headers="t_u_pval">0.003</td>
<td class="gt_row gt_right" headers="t_d_pval">0.816</td>
<td class="gt_row gt_right" headers="t_o_pval">0.000</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cytokine">IFNg</td>
<td class="gt_row gt_right" headers="t_u_pval">0.000</td>
<td class="gt_row gt_right" headers="t_d_pval">0.880</td>
<td class="gt_row gt_right" headers="t_o_pval">0.000</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cytokine">IL-17</td>
<td class="gt_row gt_right" headers="t_u_pval">0.000</td>
<td class="gt_row gt_right" headers="t_d_pval">0.752</td>
<td class="gt_row gt_right" headers="t_o_pval">0.000</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cytokine">IL-1a</td>
<td class="gt_row gt_right" headers="t_u_pval">0.000</td>
<td class="gt_row gt_right" headers="t_d_pval">0.912</td>
<td class="gt_row gt_right" headers="t_o_pval">0.000</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cytokine">IL-1b</td>
<td class="gt_row gt_right" headers="t_u_pval">0.002</td>
<td class="gt_row gt_right" headers="t_d_pval">0.968</td>
<td class="gt_row gt_right" headers="t_o_pval">0.000</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cytokine">MIP-1a</td>
<td class="gt_row gt_right" headers="t_u_pval">0.000</td>
<td class="gt_row gt_right" headers="t_d_pval">0.856</td>
<td class="gt_row gt_right" headers="t_o_pval">0.000</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cytokine">MIP-1b</td>
<td class="gt_row gt_right" headers="t_u_pval">0.001</td>
<td class="gt_row gt_right" headers="t_d_pval">0.912</td>
<td class="gt_row gt_right" headers="t_o_pval">0.000</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cytokine">MIP-3a</td>
<td class="gt_row gt_right" headers="t_u_pval">0.000</td>
<td class="gt_row gt_right" headers="t_d_pval">0.888</td>
<td class="gt_row gt_right" headers="t_o_pval">0.000</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cytokine">IL-6</td>
<td class="gt_row gt_right" headers="t_u_pval">0.000</td>
<td class="gt_row gt_right" headers="t_d_pval">0.952</td>
<td class="gt_row gt_right" headers="t_o_pval">0.000</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cytokine">TNFa</td>
<td class="gt_row gt_right" headers="t_u_pval">0.001</td>
<td class="gt_row gt_right" headers="t_d_pval">0.880</td>
<td class="gt_row gt_right" headers="t_o_pval">0.000</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cytokine">IL-23</td>
<td class="gt_row gt_right" headers="t_u_pval">0.000</td>
<td class="gt_row gt_right" headers="t_d_pval">0.760</td>
<td class="gt_row gt_right" headers="t_o_pval">0.000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb199"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a>res <span class="sc">|&gt;</span> <span class="fu">filter</span>(visit <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Week 12"</span>, <span class="st">"Week 24"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb199-2"><a href="#cb199-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb199-3"><a href="#cb199-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> visit, <span class="at">y =</span> estimate) <span class="sc">+</span></span>
<span id="cb199-4"><a href="#cb199-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(. <span class="sc">~</span> cytokine) <span class="sc">+</span></span>
<span id="cb199-5"><a href="#cb199-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"gray"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb199-6"><a href="#cb199-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_linerange</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> CI_lower, <span class="at">ymax =</span> CI_upper)) <span class="sc">+</span></span>
<span id="cb199-7"><a href="#cb199-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb199-8"><a href="#cb199-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Visit"</span>) <span class="sc">+</span></span>
<span id="cb199-9"><a href="#cb199-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Estimated difference in percentile,</span><span class="sc">\n</span><span class="st">adjusted for random participants effects</span><span class="sc">\n</span><span class="st">and associated 95% CI."</span>) <span class="sc">+</span></span>
<span id="cb199-10"><a href="#cb199-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">caption =</span> <span class="st">"Linear mixed model fitted on ranks."</span>) <span class="sc">+</span></span>
<span id="cb199-11"><a href="#cb199-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb199-12"><a href="#cb199-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>)</span>
<span id="cb199-13"><a href="#cb199-13" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-111-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>Non-parametric test instead.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb200"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> </span>
<span id="cb200-2"><a href="#cb200-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(</span>
<span id="cb200-3"><a href="#cb200-3" aria-hidden="true" tabindex="-1"></a>    cytokine_names,</span>
<span id="cb200-4"><a href="#cb200-4" aria-hidden="true" tabindex="-1"></a>    effects_of_intervention_wilcox,</span>
<span id="cb200-5"><a href="#cb200-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">cytokines_to_preMTZ =</span> cytokines_to_preMTZ</span>
<span id="cb200-6"><a href="#cb200-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb200-7"><a href="#cb200-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>() <span class="sc">|&gt;</span> </span>
<span id="cb200-8"><a href="#cb200-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb200-9"><a href="#cb200-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">adj_p_value =</span> <span class="fu">p.adjust</span>(p_value, <span class="at">method =</span> <span class="st">"BH"</span>)</span>
<span id="cb200-10"><a href="#cb200-10" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb201"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a>res <span class="sc">|&gt;</span> </span>
<span id="cb201-2"><a href="#cb201-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb201-3"><a href="#cb201-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> cytokine, <span class="at">y =</span> estimate) <span class="sc">+</span></span>
<span id="cb201-4"><a href="#cb201-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"gray"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb201-5"><a href="#cb201-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_linerange</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> CI_lower, <span class="at">ymax =</span> CI_upper)) <span class="sc">+</span></span>
<span id="cb201-6"><a href="#cb201-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb201-7"><a href="#cb201-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb201-8"><a href="#cb201-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Estimated difference in location (Lactin-V - Placebo)</span><span class="sc">\n</span><span class="st">and associated 95% CI."</span>) <span class="sc">+</span></span>
<span id="cb201-9"><a href="#cb201-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">caption =</span> <span class="st">"Wilcoxon signed rank test on the difference between PC1-subtracted z-log10(conc.) at baseline (pre-MTZ) and Week 24 visit (Excluding samples with less than 5 within-range cytokines)"</span>) <span class="sc">+</span></span>
<span id="cb201-10"><a href="#cb201-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb201-11"><a href="#cb201-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)</span>
<span id="cb201-12"><a href="#cb201-12" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-113-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb202"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a>res <span class="sc">|&gt;</span> </span>
<span id="cb202-2"><a href="#cb202-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>p_value) <span class="sc">|&gt;</span> </span>
<span id="cb202-3"><a href="#cb202-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>(<span class="at">caption =</span> <span class="st">"Wilcoxon signed rank test on the difference between PC1-subtracted z-log10(conc.) at baseline (pre-MTZ) and Week 24 visit (Excluding samples with less than 5 within-range cytokines)"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb202-4"><a href="#cb202-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(</span>
<span id="cb202-5"><a href="#cb202-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="sc">-</span><span class="fu">c</span>(<span class="st">"W"</span>),</span>
<span id="cb202-6"><a href="#cb202-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">decimals =</span> <span class="dv">3</span></span>
<span id="cb202-7"><a href="#cb202-7" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="gjnguoogxa" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#gjnguoogxa table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#gjnguoogxa thead, #gjnguoogxa tbody, #gjnguoogxa tfoot, #gjnguoogxa tr, #gjnguoogxa td, #gjnguoogxa th {
  border-style: none;
}

#gjnguoogxa p {
  margin: 0;
  padding: 0;
}

#gjnguoogxa .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#gjnguoogxa .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#gjnguoogxa .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#gjnguoogxa .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#gjnguoogxa .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#gjnguoogxa .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#gjnguoogxa .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#gjnguoogxa .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#gjnguoogxa .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#gjnguoogxa .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#gjnguoogxa .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#gjnguoogxa .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#gjnguoogxa .gt_spanner_row {
  border-bottom-style: hidden;
}

#gjnguoogxa .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#gjnguoogxa .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#gjnguoogxa .gt_from_md > :first-child {
  margin-top: 0;
}

#gjnguoogxa .gt_from_md > :last-child {
  margin-bottom: 0;
}

#gjnguoogxa .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#gjnguoogxa .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#gjnguoogxa .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#gjnguoogxa .gt_row_group_first td {
  border-top-width: 2px;
}

#gjnguoogxa .gt_row_group_first th {
  border-top-width: 2px;
}

#gjnguoogxa .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#gjnguoogxa .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#gjnguoogxa .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#gjnguoogxa .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#gjnguoogxa .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#gjnguoogxa .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#gjnguoogxa .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#gjnguoogxa .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#gjnguoogxa .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#gjnguoogxa .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#gjnguoogxa .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#gjnguoogxa .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#gjnguoogxa .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#gjnguoogxa .gt_left {
  text-align: left;
}

#gjnguoogxa .gt_center {
  text-align: center;
}

#gjnguoogxa .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#gjnguoogxa .gt_font_normal {
  font-weight: normal;
}

#gjnguoogxa .gt_font_bold {
  font-weight: bold;
}

#gjnguoogxa .gt_font_italic {
  font-style: italic;
}

#gjnguoogxa .gt_super {
  font-size: 65%;
}

#gjnguoogxa .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#gjnguoogxa .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#gjnguoogxa .gt_indent_1 {
  text-indent: 5px;
}

#gjnguoogxa .gt_indent_2 {
  text-indent: 10px;
}

#gjnguoogxa .gt_indent_3 {
  text-indent: 15px;
}

#gjnguoogxa .gt_indent_4 {
  text-indent: 20px;
}

#gjnguoogxa .gt_indent_5 {
  text-indent: 25px;
}

#gjnguoogxa .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#gjnguoogxa div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<caption>Wilcoxon signed rank test on the difference between PC1-subtracted z-log10(conc.) at baseline (pre-MTZ) and Week 24 visit (Excluding samples with less than 5 within-range cytokines)</caption>
<thead>
<tr class="gt_col_headings header">
<th id="cytokine" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">cytokine</th>
<th id="W" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">W</th>
<th id="estimate" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">estimate</th>
<th id="CI_lower" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">CI_lower</th>
<th id="CI_upper" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">CI_upper</th>
<th id="adj_p_value" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">adj_p_value</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="cytokine">ITAC</td>
<td class="gt_row gt_right" headers="W">2495</td>
<td class="gt_row gt_right" headers="estimate">0.138</td>
<td class="gt_row gt_right" headers="CI_lower">−0.134</td>
<td class="gt_row gt_right" headers="CI_upper">0.438</td>
<td class="gt_row gt_right" headers="adj_p_value">0.482</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cytokine">MIG</td>
<td class="gt_row gt_right" headers="W">2905</td>
<td class="gt_row gt_right" headers="estimate">0.462</td>
<td class="gt_row gt_right" headers="CI_lower">0.118</td>
<td class="gt_row gt_right" headers="CI_upper">0.771</td>
<td class="gt_row gt_right" headers="adj_p_value">0.045</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cytokine">IP-10</td>
<td class="gt_row gt_right" headers="W">2949</td>
<td class="gt_row gt_right" headers="estimate">0.473</td>
<td class="gt_row gt_right" headers="CI_lower">0.144</td>
<td class="gt_row gt_right" headers="CI_upper">0.776</td>
<td class="gt_row gt_right" headers="adj_p_value">0.045</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cytokine">IFNg</td>
<td class="gt_row gt_right" headers="W">2434</td>
<td class="gt_row gt_right" headers="estimate">0.141</td>
<td class="gt_row gt_right" headers="CI_lower">−0.223</td>
<td class="gt_row gt_right" headers="CI_upper">0.529</td>
<td class="gt_row gt_right" headers="adj_p_value">0.594</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cytokine">IL-17</td>
<td class="gt_row gt_right" headers="W">1762</td>
<td class="gt_row gt_right" headers="estimate">−0.327</td>
<td class="gt_row gt_right" headers="CI_lower">−0.641</td>
<td class="gt_row gt_right" headers="CI_upper">−0.032</td>
<td class="gt_row gt_right" headers="adj_p_value">0.086</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cytokine">IL-1a</td>
<td class="gt_row gt_right" headers="W">1747</td>
<td class="gt_row gt_right" headers="estimate">−0.424</td>
<td class="gt_row gt_right" headers="CI_lower">−0.750</td>
<td class="gt_row gt_right" headers="CI_upper">−0.043</td>
<td class="gt_row gt_right" headers="adj_p_value">0.086</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cytokine">IL-1b</td>
<td class="gt_row gt_right" headers="W">1672</td>
<td class="gt_row gt_right" headers="estimate">−0.359</td>
<td class="gt_row gt_right" headers="CI_lower">−0.645</td>
<td class="gt_row gt_right" headers="CI_upper">−0.084</td>
<td class="gt_row gt_right" headers="adj_p_value">0.052</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cytokine">MIP-1a</td>
<td class="gt_row gt_right" headers="W">2167</td>
<td class="gt_row gt_right" headers="estimate">−0.059</td>
<td class="gt_row gt_right" headers="CI_lower">−0.377</td>
<td class="gt_row gt_right" headers="CI_upper">0.260</td>
<td class="gt_row gt_right" headers="adj_p_value">0.699</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cytokine">MIP-1b</td>
<td class="gt_row gt_right" headers="W">1994</td>
<td class="gt_row gt_right" headers="estimate">−0.140</td>
<td class="gt_row gt_right" headers="CI_lower">−0.369</td>
<td class="gt_row gt_right" headers="CI_upper">0.095</td>
<td class="gt_row gt_right" headers="adj_p_value">0.408</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cytokine">MIP-3a</td>
<td class="gt_row gt_right" headers="W">2639</td>
<td class="gt_row gt_right" headers="estimate">0.273</td>
<td class="gt_row gt_right" headers="CI_lower">−0.073</td>
<td class="gt_row gt_right" headers="CI_upper">0.625</td>
<td class="gt_row gt_right" headers="adj_p_value">0.249</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cytokine">IL-6</td>
<td class="gt_row gt_right" headers="W">2358</td>
<td class="gt_row gt_right" headers="estimate">0.060</td>
<td class="gt_row gt_right" headers="CI_lower">−0.236</td>
<td class="gt_row gt_right" headers="CI_upper">0.357</td>
<td class="gt_row gt_right" headers="adj_p_value">0.699</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cytokine">TNFa</td>
<td class="gt_row gt_right" headers="W">2107</td>
<td class="gt_row gt_right" headers="estimate">−0.098</td>
<td class="gt_row gt_right" headers="CI_lower">−0.367</td>
<td class="gt_row gt_right" headers="CI_upper">0.199</td>
<td class="gt_row gt_right" headers="adj_p_value">0.594</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="cytokine">IL-23</td>
<td class="gt_row gt_right" headers="W">1972</td>
<td class="gt_row gt_right" headers="estimate">−0.223</td>
<td class="gt_row gt_right" headers="CI_lower">−0.582</td>
<td class="gt_row gt_right" headers="CI_upper">0.139</td>
<td class="gt_row gt_right" headers="adj_p_value">0.398</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
</section>
</section>
</section>
<section id="integration-with-microbiota" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Integration with microbiota</h1>
<section id="multitable-analysis-relationships-between-microbiota-and-cytokineschemokines" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="multitable-analysis-relationships-between-microbiota-and-cytokineschemokines"><span class="header-section-number">2.1</span> Multitable analysis: relationships between Microbiota and cytokines/chemokines</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb203"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We load the MAE object</span></span>
<span id="cb203-2"><a href="#cb203-2" aria-hidden="true" tabindex="-1"></a>mae <span class="ot">&lt;-</span> <span class="fu">load_latest_mae</span>(<span class="at">dir =</span> <span class="fu">str_c</span>(<span class="fu">data_dir</span>(), <span class="st">"03_augmented_mae"</span>))  </span>
<span id="cb203-3"><a href="#cb203-3" aria-hidden="true" tabindex="-1"></a>clin <span class="ot">&lt;-</span> MultiAssayExperiment<span class="sc">::</span><span class="fu">colData</span>(mae) <span class="sc">|&gt;</span> <span class="fu">as.data.frame</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb204"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a>microbiota <span class="ot">&lt;-</span> </span>
<span id="cb204-2"><a href="#cb204-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_assay_wide_format</span>(mae, <span class="st">"tax_16S_p"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb204-3"><a href="#cb204-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">rel_ab =</span> assay)</span>
<span id="cb204-4"><a href="#cb204-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb204-5"><a href="#cb204-5" aria-hidden="true" tabindex="-1"></a>topics <span class="ot">&lt;-</span> </span>
<span id="cb204-6"><a href="#cb204-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_assay_wide_format</span>(mae, <span class="st">"c_topics_16S_8"</span>, <span class="at">add_colData =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb204-7"><a href="#cb204-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">topics =</span> assay) </span>
<span id="cb204-8"><a href="#cb204-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb204-9"><a href="#cb204-9" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(topics<span class="sc">$</span>topics) <span class="ot">&lt;-</span> SummarizedExperiment<span class="sc">::</span><span class="fu">rowData</span>(mae[[<span class="st">"c_topics_16S_8"</span>]])<span class="sc">$</span>topic_label</span>
<span id="cb204-10"><a href="#cb204-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb204-11"><a href="#cb204-11" aria-hidden="true" tabindex="-1"></a>cytokines <span class="ot">&lt;-</span> </span>
<span id="cb204-12"><a href="#cb204-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_assay_wide_format</span>(mae, <span class="st">"cytokine_log10_SE_corrected_incl_cytokine"</span>, <span class="at">add_colData =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb204-13"><a href="#cb204-13" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">cytokines =</span> assay)</span>
<span id="cb204-14"><a href="#cb204-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb204-15"><a href="#cb204-15" aria-hidden="true" tabindex="-1"></a>combined <span class="ot">&lt;-</span> </span>
<span id="cb204-16"><a href="#cb204-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(microbiota, cytokines, <span class="at">by =</span> <span class="fu">join_by</span>(Barcode)) <span class="sc">|&gt;</span> </span>
<span id="cb204-17"><a href="#cb204-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(topics <span class="sc">|&gt;</span> <span class="fu">select</span>(topics, Barcode), <span class="at">by =</span> <span class="fu">join_by</span>(Barcode))</span>
<span id="cb204-18"><a href="#cb204-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb204-19"><a href="#cb204-19" aria-hidden="true" tabindex="-1"></a>combined <span class="ot">&lt;-</span> </span>
<span id="cb204-20"><a href="#cb204-20" aria-hidden="true" tabindex="-1"></a>  combined <span class="sc">|&gt;</span> </span>
<span id="cb204-21"><a href="#cb204-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb204-22"><a href="#cb204-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># likely not needed, but useful/interesting for tests</span></span>
<span id="cb204-23"><a href="#cb204-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">rel_ab_scaled =</span> rel_ab <span class="sc">|&gt;</span> <span class="fu">scale</span>() <span class="sc">|&gt;</span> <span class="fu">as.data.frame</span>(), </span>
<span id="cb204-24"><a href="#cb204-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">cytokines_scaled =</span> cytokines <span class="sc">|&gt;</span> <span class="fu">scale</span>() <span class="sc">|&gt;</span> <span class="fu">as.data.frame</span>()</span>
<span id="cb204-25"><a href="#cb204-25" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb204-26"><a href="#cb204-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb204-27"><a href="#cb204-27" aria-hidden="true" tabindex="-1"></a>combined <span class="ot">&lt;-</span> </span>
<span id="cb204-28"><a href="#cb204-28" aria-hidden="true" tabindex="-1"></a>  combined <span class="sc">|&gt;</span> </span>
<span id="cb204-29"><a href="#cb204-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb204-30"><a href="#cb204-30" aria-hidden="true" tabindex="-1"></a>    USUBJID, AVISITN, ARM, rel_ab, cytokines, topics, rel_ab_scaled, cytokines_scaled,  <span class="fu">everything</span>()</span>
<span id="cb204-31"><a href="#cb204-31" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb205"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a>block_colors <span class="ot">&lt;-</span> <span class="fu">c</span>( <span class="st">`</span><span class="at">Microbiota</span><span class="sc">\n</span><span class="at">sub-communities</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"indianred1"</span>, <span class="at">cytokines =</span> <span class="st">"darkslateblue"</span>, <span class="st">`</span><span class="at">Microbiota topics</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"indianred1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="rv-coefficient" class="level3" data-number="2.1.1">
<h3 data-number="2.1.1" class="anchored" data-anchor-id="rv-coefficient"><span class="header-section-number">2.1.1</span> RV coefficient</h3>
<p>First, we compute the RV coefficient between the two tables.</p>
<p>RV-coefficient: https://en.wikipedia.org/wiki/RV_coefficient</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb206"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a>rv <span class="ot">&lt;-</span> ade4<span class="sc">::</span><span class="fu">RV.rtest</span>(combined<span class="sc">$</span>topics, combined<span class="sc">$</span>cytokines, <span class="at">nrepet =</span> <span class="dv">1000</span>)</span>
<span id="cb206-2"><a href="#cb206-2" aria-hidden="true" tabindex="-1"></a>rv</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Monte-Carlo test
Call: ade4::RV.rtest(df1 = combined$topics, df2 = combined$cytokines, 
    nrepet = 1000)

Observation: 0.182455 

Based on 1000 replicates
Simulated p-value: 0.000999001 
Alternative hypothesis: greater 

     Std.Obs  Expectation     Variance 
1.441089e+02 4.829027e-03 1.519257e-06 </code></pre>
</div>
</div>
<section id="rv-and-adjusted-rv" class="level4" data-number="2.1.1.1">
<h4 data-number="2.1.1.1" class="anchored" data-anchor-id="rv-and-adjusted-rv"><span class="header-section-number">2.1.1.1</span> RV and adjusted RV</h4>
<p>Adjusted RV: https://en.wikipedia.org/wiki/RV_coefficient#Shortcoming_of_the_coefficient_and_adjusted_version</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb208"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true" tabindex="-1"></a><span class="co"># FactoMineR::coeffRV(combined$topics, combined$cytokines)</span></span>
<span id="cb208-2"><a href="#cb208-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-3"><a href="#cb208-3" aria-hidden="true" tabindex="-1"></a>compute_RV <span class="ot">&lt;-</span> <span class="cf">function</span>(X, Y){</span>
<span id="cb208-4"><a href="#cb208-4" aria-hidden="true" tabindex="-1"></a>  tr <span class="ot">&lt;-</span> <span class="cf">function</span>(Z) {</span>
<span id="cb208-5"><a href="#cb208-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sum</span>(<span class="fu">diag</span>(Z))</span>
<span id="cb208-6"><a href="#cb208-6" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb208-7"><a href="#cb208-7" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">scale</span>(X, <span class="at">scale =</span> <span class="cn">FALSE</span>)</span>
<span id="cb208-8"><a href="#cb208-8" aria-hidden="true" tabindex="-1"></a>  Y <span class="ot">&lt;-</span> <span class="fu">scale</span>(Y, <span class="at">scale =</span> <span class="cn">FALSE</span>)</span>
<span id="cb208-9"><a href="#cb208-9" aria-hidden="true" tabindex="-1"></a>  Sxx <span class="ot">&lt;-</span> <span class="fu">t</span>(X) <span class="sc">%*%</span> X</span>
<span id="cb208-10"><a href="#cb208-10" aria-hidden="true" tabindex="-1"></a>  Syy <span class="ot">&lt;-</span> <span class="fu">t</span>(Y) <span class="sc">%*%</span> Y</span>
<span id="cb208-11"><a href="#cb208-11" aria-hidden="true" tabindex="-1"></a>  Sxy <span class="ot">&lt;-</span> <span class="fu">t</span>(X) <span class="sc">%*%</span> Y</span>
<span id="cb208-12"><a href="#cb208-12" aria-hidden="true" tabindex="-1"></a>  Syx <span class="ot">&lt;-</span> <span class="fu">t</span>(Y) <span class="sc">%*%</span> X</span>
<span id="cb208-13"><a href="#cb208-13" aria-hidden="true" tabindex="-1"></a>  COVV <span class="ot">&lt;-</span> <span class="fu">tr</span>(Sxy <span class="sc">%*%</span> Syx)</span>
<span id="cb208-14"><a href="#cb208-14" aria-hidden="true" tabindex="-1"></a>  rv <span class="ot">&lt;-</span> COVV<span class="sc">/</span>(<span class="fu">tr</span>(Sxx <span class="sc">%*%</span> Sxx) <span class="sc">*</span> <span class="fu">tr</span>(Syy <span class="sc">%*%</span> Syy))<span class="sc">^</span><span class="fl">0.5</span></span>
<span id="cb208-15"><a href="#cb208-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb208-16"><a href="#cb208-16" aria-hidden="true" tabindex="-1"></a>  Lx <span class="ot">&lt;-</span> <span class="fu">diag</span>(<span class="fu">eigen</span>(Sxx)<span class="sc">$</span>values)</span>
<span id="cb208-17"><a href="#cb208-17" aria-hidden="true" tabindex="-1"></a>  Ly <span class="ot">&lt;-</span> <span class="fu">diag</span>(<span class="fu">eigen</span>(Syy)<span class="sc">$</span>values)</span>
<span id="cb208-18"><a href="#cb208-18" aria-hidden="true" tabindex="-1"></a>  Pi <span class="ot">&lt;-</span> <span class="fu">diag</span>(<span class="at">x =</span> <span class="dv">1</span>, <span class="at">nrow =</span> <span class="fu">ncol</span>(X), <span class="at">ncol =</span> <span class="fu">ncol</span>(Y))</span>
<span id="cb208-19"><a href="#cb208-19" aria-hidden="true" tabindex="-1"></a>  adj_rv <span class="ot">&lt;-</span> COVV <span class="sc">/</span> <span class="fu">tr</span>(Lx <span class="sc">%*%</span> Pi <span class="sc">%*%</span> Ly)</span>
<span id="cb208-20"><a href="#cb208-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb208-21"><a href="#cb208-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">rv =</span> rv, <span class="at">adj_rv =</span> adj_rv)</span>
<span id="cb208-22"><a href="#cb208-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb208-23"><a href="#cb208-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-24"><a href="#cb208-24" aria-hidden="true" tabindex="-1"></a><span class="fu">compute_RV</span>(combined<span class="sc">$</span>topics, combined<span class="sc">$</span>cytokines)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$rv
[1] 0.182455

$adj_rv
[1] 0.1944409</code></pre>
</div>
</div>
</section>
<section id="by-visits" class="level4" data-number="2.1.1.2">
<h4 data-number="2.1.1.2" class="anchored" data-anchor-id="by-visits"><span class="header-section-number">2.1.1.2</span> By visits</h4>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb210"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true" tabindex="-1"></a>rv_by_visits <span class="ot">&lt;-</span> </span>
<span id="cb210-2"><a href="#cb210-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(</span>
<span id="cb210-3"><a href="#cb210-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">4</span>,<span class="dv">7</span>), </span>
<span id="cb210-4"><a href="#cb210-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">function</span>(visit, combined){</span>
<span id="cb210-5"><a href="#cb210-5" aria-hidden="true" tabindex="-1"></a>      combined_V <span class="ot">&lt;-</span> combined <span class="sc">|&gt;</span> <span class="fu">filter</span>(AVISITN <span class="sc">==</span> visit)</span>
<span id="cb210-6"><a href="#cb210-6" aria-hidden="true" tabindex="-1"></a>      rv_V <span class="ot">&lt;-</span> ade4<span class="sc">::</span><span class="fu">RV.rtest</span>(combined_V<span class="sc">$</span>topics, combined_V<span class="sc">$</span>cytokines, <span class="at">nrepet =</span> <span class="dv">10000</span>)</span>
<span id="cb210-7"><a href="#cb210-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tibble</span>(</span>
<span id="cb210-8"><a href="#cb210-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">visit_nb =</span> visit, </span>
<span id="cb210-9"><a href="#cb210-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">visit =</span> visit <span class="sc">|&gt;</span> <span class="fu">get_visit_labels</span>(), </span>
<span id="cb210-10"><a href="#cb210-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">RV =</span> rv_V<span class="sc">$</span>obs, </span>
<span id="cb210-11"><a href="#cb210-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">pval =</span> rv_V<span class="sc">$</span>pvalue</span>
<span id="cb210-12"><a href="#cb210-12" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb210-13"><a href="#cb210-13" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb210-14"><a href="#cb210-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">combined =</span> combined</span>
<span id="cb210-15"><a href="#cb210-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> <span class="fu">bind_rows</span>() </span>
<span id="cb210-16"><a href="#cb210-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb210-17"><a href="#cb210-17" aria-hidden="true" tabindex="-1"></a>rv_by_visits <span class="ot">&lt;-</span> </span>
<span id="cb210-18"><a href="#cb210-18" aria-hidden="true" tabindex="-1"></a>  rv_by_visits <span class="sc">|&gt;</span> </span>
<span id="cb210-19"><a href="#cb210-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">adj_pval =</span> <span class="fu">p.adjust</span>(pval, <span class="at">method =</span> <span class="st">"BH"</span>))</span>
<span id="cb210-20"><a href="#cb210-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb210-21"><a href="#cb210-21" aria-hidden="true" tabindex="-1"></a>rv_by_visits <span class="sc">|&gt;</span> <span class="fu">gt</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="msajgvspin" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#msajgvspin table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#msajgvspin thead, #msajgvspin tbody, #msajgvspin tfoot, #msajgvspin tr, #msajgvspin td, #msajgvspin th {
  border-style: none;
}

#msajgvspin p {
  margin: 0;
  padding: 0;
}

#msajgvspin .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#msajgvspin .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#msajgvspin .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#msajgvspin .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#msajgvspin .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#msajgvspin .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#msajgvspin .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#msajgvspin .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#msajgvspin .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#msajgvspin .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#msajgvspin .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#msajgvspin .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#msajgvspin .gt_spanner_row {
  border-bottom-style: hidden;
}

#msajgvspin .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#msajgvspin .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#msajgvspin .gt_from_md > :first-child {
  margin-top: 0;
}

#msajgvspin .gt_from_md > :last-child {
  margin-bottom: 0;
}

#msajgvspin .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#msajgvspin .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#msajgvspin .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#msajgvspin .gt_row_group_first td {
  border-top-width: 2px;
}

#msajgvspin .gt_row_group_first th {
  border-top-width: 2px;
}

#msajgvspin .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#msajgvspin .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#msajgvspin .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#msajgvspin .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#msajgvspin .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#msajgvspin .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#msajgvspin .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#msajgvspin .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#msajgvspin .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#msajgvspin .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#msajgvspin .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#msajgvspin .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#msajgvspin .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#msajgvspin .gt_left {
  text-align: left;
}

#msajgvspin .gt_center {
  text-align: center;
}

#msajgvspin .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#msajgvspin .gt_font_normal {
  font-weight: normal;
}

#msajgvspin .gt_font_bold {
  font-weight: bold;
}

#msajgvspin .gt_font_italic {
  font-style: italic;
}

#msajgvspin .gt_super {
  font-size: 65%;
}

#msajgvspin .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#msajgvspin .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#msajgvspin .gt_indent_1 {
  text-indent: 5px;
}

#msajgvspin .gt_indent_2 {
  text-indent: 10px;
}

#msajgvspin .gt_indent_3 {
  text-indent: 15px;
}

#msajgvspin .gt_indent_4 {
  text-indent: 20px;
}

#msajgvspin .gt_indent_5 {
  text-indent: 25px;
}

#msajgvspin .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#msajgvspin div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_col_headings header">
<th id="visit_nb" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">visit_nb</th>
<th id="visit" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">visit</th>
<th id="RV" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">RV</th>
<th id="pval" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">pval</th>
<th id="adj_pval" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">adj_pval</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_right" headers="visit_nb">0</td>
<td class="gt_row gt_center" headers="visit">Pre-MTZ</td>
<td class="gt_row gt_right" headers="RV">0.10598629</td>
<td class="gt_row gt_right" headers="pval">0.00009999</td>
<td class="gt_row gt_right" headers="adj_pval">0.000119988</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="visit_nb">1</td>
<td class="gt_row gt_center" headers="visit">Post-MTZ</td>
<td class="gt_row gt_right" headers="RV">0.04668434</td>
<td class="gt_row gt_right" headers="pval">0.00869913</td>
<td class="gt_row gt_right" headers="adj_pval">0.008699130</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="visit_nb">2</td>
<td class="gt_row gt_center" headers="visit">Week 4</td>
<td class="gt_row gt_right" headers="RV">0.17411025</td>
<td class="gt_row gt_right" headers="pval">0.00009999</td>
<td class="gt_row gt_right" headers="adj_pval">0.000119988</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="visit_nb">3</td>
<td class="gt_row gt_center" headers="visit">Week 8</td>
<td class="gt_row gt_right" headers="RV">0.21508936</td>
<td class="gt_row gt_right" headers="pval">0.00009999</td>
<td class="gt_row gt_right" headers="adj_pval">0.000119988</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="visit_nb">4</td>
<td class="gt_row gt_center" headers="visit">Week 12</td>
<td class="gt_row gt_right" headers="RV">0.19731052</td>
<td class="gt_row gt_right" headers="pval">0.00009999</td>
<td class="gt_row gt_right" headers="adj_pval">0.000119988</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="visit_nb">7</td>
<td class="gt_row gt_center" headers="visit">Week 24</td>
<td class="gt_row gt_right" headers="RV">0.21710357</td>
<td class="gt_row gt_right" headers="pval">0.00009999</td>
<td class="gt_row gt_right" headers="adj_pval">0.000119988</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb211"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> </span>
<span id="cb211-2"><a href="#cb211-2" aria-hidden="true" tabindex="-1"></a>rv_by_visits <span class="sc">|&gt;</span> </span>
<span id="cb211-3"><a href="#cb211-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> visit, <span class="at">y =</span> RV, <span class="at">size =</span> <span class="sc">-</span><span class="fu">log10</span>(adj_pval), <span class="at">col =</span> adj_pval <span class="sc">&lt;</span> <span class="fl">0.05</span>)) <span class="sc">+</span></span>
<span id="cb211-4"><a href="#cb211-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="fu">aes</span>(<span class="at">yintercept =</span> rv<span class="sc">$</span>obs), <span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb211-5"><a href="#cb211-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb211-6"><a href="#cb211-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">y =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb211-7"><a href="#cb211-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb211-8"><a href="#cb211-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">col =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb211-9"><a href="#cb211-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">60</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb211-10"><a href="#cb211-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb211-11"><a href="#cb211-11" aria-hidden="true" tabindex="-1"></a>g</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-223-1.png" class="img-fluid figure-img" width="384"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb212"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(g, <span class="at">filename =</span> <span class="fu">str_c</span>(<span class="fu">fig_out_dir</span>(), <span class="st">"S4C.pdf"</span>), <span class="at">width =</span> <span class="dv">4</span>, <span class="at">height =</span> <span class="dv">4</span>, <span class="at">device =</span> cairo_pdf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="distatis" class="level3" data-number="2.1.2">
<h3 data-number="2.1.2" class="anchored" data-anchor-id="distatis"><span class="header-section-number">2.1.2</span> DISTATIS</h3>
<section id="considering-each-visit-as-a-separate-table" class="level4" data-number="2.1.2.1">
<h4 data-number="2.1.2.1" class="anchored" data-anchor-id="considering-each-visit-as-a-separate-table"><span class="header-section-number">2.1.2.1</span> Considering each visit as a separate table</h4>
<p>First, we retrieve the data for each visit for participants who have data for all visits.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb213"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true" tabindex="-1"></a>get_assay_at_visit <span class="ot">&lt;-</span> <span class="cf">function</span>(v, combined, assay){</span>
<span id="cb213-2"><a href="#cb213-2" aria-hidden="true" tabindex="-1"></a>  tmp <span class="ot">&lt;-</span> combined <span class="sc">|&gt;</span> <span class="fu">filter</span>(AVISITN <span class="sc">==</span> v)</span>
<span id="cb213-3"><a href="#cb213-3" aria-hidden="true" tabindex="-1"></a>  tmp <span class="sc">|&gt;</span> </span>
<span id="cb213-4"><a href="#cb213-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="fu">all_of</span>(assay)) <span class="sc">|&gt;</span> </span>
<span id="cb213-5"><a href="#cb213-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unnest</span>(assay) <span class="sc">|&gt;</span> </span>
<span id="cb213-6"><a href="#cb213-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span> </span>
<span id="cb213-7"><a href="#cb213-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set_rownames</span>(tmp<span class="sc">$</span>USUBJID)</span>
<span id="cb213-8"><a href="#cb213-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb213-9"><a href="#cb213-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb213-10"><a href="#cb213-10" aria-hidden="true" tabindex="-1"></a>pipv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">4</span>, <span class="dv">7</span>)</span>
<span id="cb213-11"><a href="#cb213-11" aria-hidden="true" tabindex="-1"></a>combined_by_visits <span class="ot">&lt;-</span> </span>
<span id="cb213-12"><a href="#cb213-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(</span>
<span id="cb213-13"><a href="#cb213-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">map</span>(pipv, get_assay_at_visit, combined, <span class="st">"rel_ab"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb213-14"><a href="#cb213-14" aria-hidden="true" tabindex="-1"></a>      <span class="fu">set_names</span>(<span class="fu">str_c</span>(<span class="st">"M"</span>, pipv)), </span>
<span id="cb213-15"><a href="#cb213-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">map</span>(pipv, get_assay_at_visit, combined, <span class="st">"cytokines"</span>) <span class="sc">|&gt;</span></span>
<span id="cb213-16"><a href="#cb213-16" aria-hidden="true" tabindex="-1"></a>      <span class="fu">set_names</span>(<span class="fu">str_c</span>(<span class="st">"C"</span>, pipv)) ,</span>
<span id="cb213-17"><a href="#cb213-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">map</span>(pipv, get_assay_at_visit, combined, <span class="st">"topics"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb213-18"><a href="#cb213-18" aria-hidden="true" tabindex="-1"></a>      <span class="fu">set_names</span>(<span class="fu">str_c</span>(<span class="st">"T"</span>, pipv))</span>
<span id="cb213-19"><a href="#cb213-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb213-20"><a href="#cb213-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb213-21"><a href="#cb213-21" aria-hidden="true" tabindex="-1"></a><span class="co"># lapply(combined_by_visits, dim) |&gt; bind_rows()</span></span>
<span id="cb213-22"><a href="#cb213-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb213-23"><a href="#cb213-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb213-24"><a href="#cb213-24" aria-hidden="true" tabindex="-1"></a>common_samples <span class="ot">&lt;-</span> <span class="fu">Reduce</span>(intersect, <span class="fu">lapply</span>(combined_by_visits, rownames))</span>
<span id="cb213-25"><a href="#cb213-25" aria-hidden="true" tabindex="-1"></a>combined_by_visits_complete_cases <span class="ot">&lt;-</span> </span>
<span id="cb213-26"><a href="#cb213-26" aria-hidden="true" tabindex="-1"></a>  combined_by_visits <span class="sc">|&gt;</span>  </span>
<span id="cb213-27"><a href="#cb213-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(<span class="sc">~</span> .[common_samples, ] <span class="sc">|&gt;</span> <span class="fu">set_rownames</span>(common_samples)) </span>
<span id="cb213-28"><a href="#cb213-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb213-29"><a href="#cb213-29" aria-hidden="true" tabindex="-1"></a><span class="co"># lapply(combined_by_visits_complete_cases, dim) |&gt; bind_rows()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Then, we compute the distances at each visits for these participants.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb214"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb214-1"><a href="#cb214-1" aria-hidden="true" tabindex="-1"></a>distances_by_visits <span class="ot">&lt;-</span> </span>
<span id="cb214-2"><a href="#cb214-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(</span>
<span id="cb214-3"><a href="#cb214-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">seq_along</span>(combined_by_visits_complete_cases <span class="sc">|&gt;</span> <span class="fu">names</span>() <span class="sc">|&gt;</span> <span class="fu">str_subset</span>(<span class="st">"M|C"</span>)),</span>
<span id="cb214-4"><a href="#cb214-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">function</span>(x){</span>
<span id="cb214-5"><a href="#cb214-5" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="fu">str_detect</span>(<span class="fu">names</span>(combined_by_visits_complete_cases)[x], <span class="st">"M"</span>))</span>
<span id="cb214-6"><a href="#cb214-6" aria-hidden="true" tabindex="-1"></a>        vegan<span class="sc">::</span><span class="fu">vegdist</span>(combined_by_visits_complete_cases[[x]], <span class="at">method =</span> <span class="st">"bray"</span>) <span class="sc">|&gt;</span> <span class="fu">as.matrix</span>()</span>
<span id="cb214-7"><a href="#cb214-7" aria-hidden="true" tabindex="-1"></a>      <span class="cf">else</span> </span>
<span id="cb214-8"><a href="#cb214-8" aria-hidden="true" tabindex="-1"></a>        <span class="fu">dist</span>(combined_by_visits_complete_cases[[x]], <span class="at">method =</span> <span class="st">"manhattan"</span>) <span class="sc">|&gt;</span> <span class="fu">as.matrix</span>()</span>
<span id="cb214-9"><a href="#cb214-9" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb214-10"><a href="#cb214-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> <span class="fu">set_names</span>(combined_by_visits_complete_cases <span class="sc">|&gt;</span> <span class="fu">names</span>() <span class="sc">|&gt;</span> <span class="fu">str_subset</span>(<span class="st">"M|C"</span>))</span>
<span id="cb214-11"><a href="#cb214-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb214-12"><a href="#cb214-12" aria-hidden="true" tabindex="-1"></a><span class="co"># lapply(distances_by_visits, dim) |&gt; bind_rows()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb215"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb215-1"><a href="#cb215-1" aria-hidden="true" tabindex="-1"></a>n_participants <span class="ot">&lt;-</span> <span class="fu">length</span>(common_samples)</span>
<span id="cb215-2"><a href="#cb215-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-3"><a href="#cb215-3" aria-hidden="true" tabindex="-1"></a>dist_by_visits_cube <span class="ot">&lt;-</span> </span>
<span id="cb215-4"><a href="#cb215-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">array</span>(</span>
<span id="cb215-5"><a href="#cb215-5" aria-hidden="true" tabindex="-1"></a>    distances_by_visits <span class="sc">|&gt;</span> <span class="fu">unlist</span>(), </span>
<span id="cb215-6"><a href="#cb215-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">dim =</span> <span class="fu">c</span>(n_participants, n_participants, <span class="fu">length</span>(distances_by_visits)),</span>
<span id="cb215-7"><a href="#cb215-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">dimnames =</span> <span class="fu">list</span>(common_samples, common_samples, <span class="fu">names</span>(distances_by_visits))</span>
<span id="cb215-8"><a href="#cb215-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb215-9"><a href="#cb215-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-10"><a href="#cb215-10" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">distatis</span>(dist_by_visits_cube, <span class="at">nfact =</span> <span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb216"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb216-1"><a href="#cb216-1" aria-hidden="true" tabindex="-1"></a><span class="co"># res$res4Cmat$C |&gt; round(2) # RV equivalent</span></span>
<span id="cb216-2"><a href="#cb216-2" aria-hidden="true" tabindex="-1"></a><span class="co"># compute_RV(distances$topic_distances, distances$cytokine_distances)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb217"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb217-1"><a href="#cb217-1" aria-hidden="true" tabindex="-1"></a>RV_long <span class="ot">&lt;-</span> </span>
<span id="cb217-2"><a href="#cb217-2" aria-hidden="true" tabindex="-1"></a>  res<span class="sc">$</span>res4Cmat<span class="sc">$</span>C <span class="sc">|&gt;</span> </span>
<span id="cb217-3"><a href="#cb217-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span> </span>
<span id="cb217-4"><a href="#cb217-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"X"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb217-5"><a href="#cb217-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>X, <span class="at">names_to =</span> <span class="st">"Y"</span>, <span class="at">values_to =</span> <span class="st">"RV"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb217-6"><a href="#cb217-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb217-7"><a href="#cb217-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">X_modality =</span> <span class="fu">str_extract</span>(X, <span class="st">"^[A-Z]"</span>),</span>
<span id="cb217-8"><a href="#cb217-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">Y_modality =</span> <span class="fu">str_extract</span>(Y, <span class="st">"^[A-Z]"</span>)</span>
<span id="cb217-9"><a href="#cb217-9" aria-hidden="true" tabindex="-1"></a>  ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb218"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb218-1"><a href="#cb218-1" aria-hidden="true" tabindex="-1"></a>RV_long <span class="sc">|&gt;</span> </span>
<span id="cb218-2"><a href="#cb218-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(X <span class="sc">!=</span> Y) <span class="sc">|&gt;</span> </span>
<span id="cb218-3"><a href="#cb218-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> X, <span class="at">y =</span> Y <span class="sc">|&gt;</span> <span class="fu">fct_rev</span>(), <span class="at">fill =</span> RV)) <span class="sc">+</span></span>
<span id="cb218-4"><a href="#cb218-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb218-5"><a href="#cb218-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">6.5</span>, <span class="at">col =</span> <span class="st">"white"</span>, <span class="at">linewidth =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb218-6"><a href="#cb218-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">6.5</span>, <span class="at">col =</span> <span class="st">"white"</span>, <span class="at">linewidth =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb218-7"><a href="#cb218-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(RV, <span class="dv">2</span>), <span class="at">col =</span> <span class="fu">round</span>(RV <span class="sc">+</span> <span class="fl">0.25</span>)), <span class="at">size =</span> <span class="dv">2</span>, <span class="at">fontface =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb218-8"><a href="#cb218-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_grid(Y_modality ~ X_modality, scales = "free") +</span></span>
<span id="cb218-9"><a href="#cb218-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>() <span class="sc">+</span></span>
<span id="cb218-10"><a href="#cb218-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_fill_gradient(low = "gray80", high = "purple") +</span></span>
<span id="cb218-11"><a href="#cb218-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>(<span class="at">option =</span> <span class="st">"A"</span>, <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb218-12"><a href="#cb218-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_c</span>(<span class="at">option =</span> <span class="st">"A"</span>, <span class="at">direction =</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="co"># , limits = c(0, 1)</span></span>
<span id="cb218-13"><a href="#cb218-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">col =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb218-14"><a href="#cb218-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">""</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb219"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb219-1"><a href="#cb219-1" aria-hidden="true" tabindex="-1"></a>RV_long <span class="sc">|&gt;</span> </span>
<span id="cb219-2"><a href="#cb219-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb219-3"><a href="#cb219-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">X_visit =</span> X <span class="sc">|&gt;</span> <span class="fu">parse_number</span>() <span class="sc">|&gt;</span> <span class="fu">get_visit_labels</span>(),</span>
<span id="cb219-4"><a href="#cb219-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">Y_visit =</span> Y <span class="sc">|&gt;</span> <span class="fu">parse_number</span>() <span class="sc">|&gt;</span> <span class="fu">get_visit_labels</span>(),</span>
<span id="cb219-5"><a href="#cb219-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">X_modality =</span> <span class="fu">ifelse</span>(X_modality <span class="sc">==</span> <span class="st">"M"</span>, <span class="st">"Microbiota"</span>, <span class="st">"Cytokines"</span>),</span>
<span id="cb219-6"><a href="#cb219-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Y_modality =</span> <span class="fu">ifelse</span>(Y_modality <span class="sc">==</span> <span class="st">"M"</span>, <span class="st">"Microbiota"</span>, <span class="st">"Cytokines"</span>)</span>
<span id="cb219-7"><a href="#cb219-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb219-8"><a href="#cb219-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(X <span class="sc">!=</span> Y) <span class="sc">|&gt;</span> </span>
<span id="cb219-9"><a href="#cb219-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> X_visit, <span class="at">y =</span> Y_visit <span class="sc">|&gt;</span> <span class="fu">fct_rev</span>(), <span class="at">fill =</span> RV)) <span class="sc">+</span></span>
<span id="cb219-10"><a href="#cb219-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb219-11"><a href="#cb219-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">6.5</span>, <span class="at">col =</span> <span class="st">"white"</span>, <span class="at">linewidth =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb219-12"><a href="#cb219-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">6.5</span>, <span class="at">col =</span> <span class="st">"white"</span>, <span class="at">linewidth =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb219-13"><a href="#cb219-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(RV, <span class="dv">2</span>), <span class="at">col =</span> <span class="fu">round</span>(RV <span class="sc">+</span> <span class="fl">0.25</span>)), <span class="at">size =</span> <span class="dv">3</span>, <span class="at">fontface =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb219-14"><a href="#cb219-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(Y_modality <span class="sc">~</span> X_modality, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb219-15"><a href="#cb219-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>(<span class="at">option =</span> <span class="st">"A"</span>, <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb219-16"><a href="#cb219-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_c</span>(<span class="at">option =</span> <span class="st">"A"</span>, <span class="at">direction =</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="co"># , limits = c(0, 1)</span></span>
<span id="cb219-17"><a href="#cb219-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">col =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb219-18"><a href="#cb219-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">""</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb219-19"><a href="#cb219-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb219-20"><a href="#cb219-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="sc">-</span><span class="dv">90</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb219-21"><a href="#cb219-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.spacing =</span> <span class="fu">unit</span>(<span class="fl">0.1</span>, <span class="st">"lines"</span>),</span>
<span id="cb219-22"><a href="#cb219-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)</span>
<span id="cb219-23"><a href="#cb219-23" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-231-1.png" class="img-fluid figure-img" width="528"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb220"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb220-1"><a href="#cb220-1" aria-hidden="true" tabindex="-1"></a>res<span class="sc">$</span>res4Cmat<span class="sc">$</span>G <span class="sc">|&gt;</span> </span>
<span id="cb220-2"><a href="#cb220-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span> </span>
<span id="cb220-3"><a href="#cb220-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"k"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb220-4"><a href="#cb220-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb220-5"><a href="#cb220-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">visit =</span> k <span class="sc">|&gt;</span> <span class="fu">parse_number</span>() <span class="sc">|&gt;</span> <span class="fu">get_visit_labels</span>(),</span>
<span id="cb220-6"><a href="#cb220-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">modality =</span> k <span class="sc">|&gt;</span> <span class="fu">substr</span>(<span class="dv">1</span>,<span class="dv">1</span>) <span class="sc">|&gt;</span> <span class="fu">as.factor</span>() <span class="sc">|&gt;</span> <span class="fu">fct_recode</span>(</span>
<span id="cb220-7"><a href="#cb220-7" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Microbiota"</span> <span class="ot">=</span> <span class="st">"M"</span>,</span>
<span id="cb220-8"><a href="#cb220-8" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Cytokines"</span> <span class="ot">=</span> <span class="st">"C"</span></span>
<span id="cb220-9"><a href="#cb220-9" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb220-10"><a href="#cb220-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb220-11"><a href="#cb220-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">dim 1</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">dim 2</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb220-12"><a href="#cb220-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"gray"</span>) <span class="sc">+</span></span>
<span id="cb220-13"><a href="#cb220-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"gray"</span>) <span class="sc">+</span></span>
<span id="cb220-14"><a href="#cb220-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(<span class="fu">aes</span>(<span class="at">group =</span> visit), <span class="at">col =</span> <span class="st">"gray50"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb220-15"><a href="#cb220-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(<span class="fu">aes</span>(<span class="at">group =</span> modality, <span class="at">color =</span> modality), <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb220-16"><a href="#cb220-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="fu">aes</span>(<span class="at">label =</span> k, <span class="at">color =</span> modality), <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb220-17"><a href="#cb220-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb221"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb221-1"><a href="#cb221-1" aria-hidden="true" tabindex="-1"></a>RV_PCoA <span class="ot">&lt;-</span> vegan<span class="sc">::</span><span class="fu">wcmdscale</span>(<span class="dv">1</span><span class="sc">-</span>res<span class="sc">$</span>res4Cmat<span class="sc">$</span>C, <span class="at">eig =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb222"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb222-1"><a href="#cb222-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">eig =</span> RV_PCoA<span class="sc">$</span>eig) <span class="sc">|&gt;</span> </span>
<span id="cb222-2"><a href="#cb222-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">k =</span> <span class="fu">row_number</span>()) <span class="sc">|&gt;</span></span>
<span id="cb222-3"><a href="#cb222-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> eig)) <span class="sc">+</span></span>
<span id="cb222-4"><a href="#cb222-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-234-1.png" class="img-fluid figure-img" width="384"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb223"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb223-1"><a href="#cb223-1" aria-hidden="true" tabindex="-1"></a>RV_PCoA_points <span class="ot">&lt;-</span> </span>
<span id="cb223-2"><a href="#cb223-2" aria-hidden="true" tabindex="-1"></a>  RV_PCoA<span class="sc">$</span>points <span class="sc">|&gt;</span> </span>
<span id="cb223-3"><a href="#cb223-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span> </span>
<span id="cb223-4"><a href="#cb223-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"k"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb223-5"><a href="#cb223-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb223-6"><a href="#cb223-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">visit =</span> k <span class="sc">|&gt;</span> <span class="fu">parse_number</span>() <span class="sc">|&gt;</span> <span class="fu">get_visit_labels</span>(),</span>
<span id="cb223-7"><a href="#cb223-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">modality =</span> k <span class="sc">|&gt;</span> <span class="fu">substr</span>(<span class="dv">1</span>,<span class="dv">1</span>) <span class="sc">|&gt;</span> <span class="fu">as.factor</span>() <span class="sc">|&gt;</span> <span class="fu">fct_recode</span>(</span>
<span id="cb223-8"><a href="#cb223-8" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Microbiota"</span> <span class="ot">=</span> <span class="st">"M"</span>,</span>
<span id="cb223-9"><a href="#cb223-9" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Cytokines"</span> <span class="ot">=</span> <span class="st">"C"</span></span>
<span id="cb223-10"><a href="#cb223-10" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb223-11"><a href="#cb223-11" aria-hidden="true" tabindex="-1"></a>  ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb224"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb224-1"><a href="#cb224-1" aria-hidden="true" tabindex="-1"></a>RV_PCoA_points <span class="sc">|&gt;</span> </span>
<span id="cb224-2"><a href="#cb224-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Dim1, <span class="at">y =</span> Dim2)) <span class="sc">+</span></span>
<span id="cb224-3"><a href="#cb224-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"gray"</span>) <span class="sc">+</span></span>
<span id="cb224-4"><a href="#cb224-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"gray"</span>) <span class="sc">+</span></span>
<span id="cb224-5"><a href="#cb224-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(<span class="fu">aes</span>(<span class="at">group =</span> visit), <span class="at">col =</span> <span class="st">"gray50"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb224-6"><a href="#cb224-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(<span class="fu">aes</span>(<span class="at">group =</span> modality, <span class="at">color =</span> modality), <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb224-7"><a href="#cb224-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="fu">aes</span>(<span class="at">label =</span> k, <span class="at">color =</span> modality), <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb224-8"><a href="#cb224-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb225"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb225-1"><a href="#cb225-1" aria-hidden="true" tabindex="-1"></a>RV_long_manual <span class="ot">&lt;-</span> </span>
<span id="cb225-2"><a href="#cb225-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(</span>
<span id="cb225-3"><a href="#cb225-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">seq_along</span>(distances_by_visits),</span>
<span id="cb225-4"><a href="#cb225-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">function</span>(x){</span>
<span id="cb225-5"><a href="#cb225-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">map</span>(</span>
<span id="cb225-6"><a href="#cb225-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">c</span>(x<span class="sc">+</span><span class="dv">1</span>, x<span class="sc">+</span><span class="dv">6</span>),</span>
<span id="cb225-7"><a href="#cb225-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">function</span>(y){</span>
<span id="cb225-8"><a href="#cb225-8" aria-hidden="true" tabindex="-1"></a>          <span class="cf">if</span>(y <span class="sc">&lt;=</span> <span class="dv">12</span>){</span>
<span id="cb225-9"><a href="#cb225-9" aria-hidden="true" tabindex="-1"></a>            RV_res <span class="ot">&lt;-</span> </span>
<span id="cb225-10"><a href="#cb225-10" aria-hidden="true" tabindex="-1"></a>              <span class="fu">RV.randtest</span>(</span>
<span id="cb225-11"><a href="#cb225-11" aria-hidden="true" tabindex="-1"></a>                distances_by_visits[[x]] <span class="sc">|&gt;</span> <span class="fu">as.data.frame</span>(),</span>
<span id="cb225-12"><a href="#cb225-12" aria-hidden="true" tabindex="-1"></a>                distances_by_visits[[y]] <span class="sc">|&gt;</span> <span class="fu">as.data.frame</span>(),</span>
<span id="cb225-13"><a href="#cb225-13" aria-hidden="true" tabindex="-1"></a>                <span class="at">nrepet =</span> <span class="dv">99</span></span>
<span id="cb225-14"><a href="#cb225-14" aria-hidden="true" tabindex="-1"></a>              )</span>
<span id="cb225-15"><a href="#cb225-15" aria-hidden="true" tabindex="-1"></a>            <span class="fu">tibble</span>(</span>
<span id="cb225-16"><a href="#cb225-16" aria-hidden="true" tabindex="-1"></a>              <span class="at">X =</span> <span class="fu">names</span>(distances_by_visits)[x], </span>
<span id="cb225-17"><a href="#cb225-17" aria-hidden="true" tabindex="-1"></a>              <span class="at">Y =</span> <span class="fu">names</span>(distances_by_visits)[y],</span>
<span id="cb225-18"><a href="#cb225-18" aria-hidden="true" tabindex="-1"></a>              <span class="at">RV =</span> RV_res<span class="sc">$</span>obs, <span class="at">pval =</span> RV_res<span class="sc">$</span>pvalue</span>
<span id="cb225-19"><a href="#cb225-19" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb225-20"><a href="#cb225-20" aria-hidden="true" tabindex="-1"></a>          } <span class="cf">else</span> {<span class="fu">tibble</span>()}</span>
<span id="cb225-21"><a href="#cb225-21" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb225-22"><a href="#cb225-22" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb225-23"><a href="#cb225-23" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb225-24"><a href="#cb225-24" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span>  <span class="fu">bind_rows</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb226"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb226-1"><a href="#cb226-1" aria-hidden="true" tabindex="-1"></a>RV_long_manual <span class="sc">|&gt;</span> </span>
<span id="cb226-2"><a href="#cb226-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(RV_long <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">RV_DiSTATIS =</span> RV)) <span class="sc">|&gt;</span> </span>
<span id="cb226-3"><a href="#cb226-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> RV_DiSTATIS, <span class="at">y =</span> RV)) <span class="sc">+</span></span>
<span id="cb226-4"><a href="#cb226-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb227"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb227-1"><a href="#cb227-1" aria-hidden="true" tabindex="-1"></a>RV_long_manual_aug <span class="ot">&lt;-</span> </span>
<span id="cb227-2"><a href="#cb227-2" aria-hidden="true" tabindex="-1"></a>  RV_long_manual <span class="sc">|&gt;</span> </span>
<span id="cb227-3"><a href="#cb227-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb227-4"><a href="#cb227-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">qval =</span> <span class="fu">p.adjust</span>(pval, <span class="at">method =</span> <span class="st">"BH"</span>),</span>
<span id="cb227-5"><a href="#cb227-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">signif_corr =</span> <span class="fu">ifelse</span>(qval <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="st">"Yes"</span>, <span class="st">"No"</span>) <span class="sc">|&gt;</span>  <span class="fu">factor</span>() <span class="sc">|&gt;</span> <span class="fu">fct_rev</span>()</span>
<span id="cb227-6"><a href="#cb227-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb227-7"><a href="#cb227-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(</span>
<span id="cb227-8"><a href="#cb227-8" aria-hidden="true" tabindex="-1"></a>    RV_PCoA_points <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">X =</span> k) <span class="sc">|&gt;</span> <span class="fu">select</span>(X, modality, Dim1, Dim2, Dim3, Dim4), <span class="at">by =</span> <span class="st">"X"</span></span>
<span id="cb227-9"><a href="#cb227-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb227-10"><a href="#cb227-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(</span>
<span id="cb227-11"><a href="#cb227-11" aria-hidden="true" tabindex="-1"></a>    RV_PCoA_points <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">Y =</span> k) <span class="sc">|&gt;</span> <span class="fu">select</span>(Y, modality, Dim1, Dim2, Dim3, Dim4), <span class="at">by =</span> <span class="st">"Y"</span></span>
<span id="cb227-12"><a href="#cb227-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb227-13"><a href="#cb227-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb227-14"><a href="#cb227-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">joint_type =</span> <span class="fu">ifelse</span>(modality.x <span class="sc">==</span> modality.y, modality.x <span class="sc">|&gt;</span> <span class="fu">as.character</span>(), <span class="st">"Same visit"</span>)</span>
<span id="cb227-15"><a href="#cb227-15" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb227-16"><a href="#cb227-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-17"><a href="#cb227-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-18"><a href="#cb227-18" aria-hidden="true" tabindex="-1"></a>g_PCoA_12 <span class="ot">&lt;-</span> </span>
<span id="cb227-19"><a href="#cb227-19" aria-hidden="true" tabindex="-1"></a>  RV_PCoA_points <span class="sc">|&gt;</span> </span>
<span id="cb227-20"><a href="#cb227-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Dim1, <span class="at">y =</span> Dim2)) <span class="sc">+</span></span>
<span id="cb227-21"><a href="#cb227-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"gray"</span>) <span class="sc">+</span></span>
<span id="cb227-22"><a href="#cb227-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"gray"</span>) <span class="sc">+</span></span>
<span id="cb227-23"><a href="#cb227-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(</span>
<span id="cb227-24"><a href="#cb227-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> RV_long_manual_aug <span class="sc">|&gt;</span> <span class="fu">filter</span>(<span class="sc">!</span>((X <span class="sc">==</span> <span class="st">"M7"</span>) <span class="sc">&amp;</span> (Y <span class="sc">==</span> <span class="st">"C0"</span>))),</span>
<span id="cb227-25"><a href="#cb227-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> Dim1.x, <span class="at">y =</span> Dim2.x, <span class="at">xend =</span> Dim1.y, <span class="at">yend =</span> Dim2.y, </span>
<span id="cb227-26"><a href="#cb227-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> joint_type, <span class="at">linetype =</span> signif_corr)</span>
<span id="cb227-27"><a href="#cb227-27" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb227-28"><a href="#cb227-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="fu">aes</span>(<span class="at">label =</span> visit, <span class="at">color =</span> modality), <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span> <span class="co">#  size = Dim3</span></span>
<span id="cb227-29"><a href="#cb227-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>() <span class="sc">+</span></span>
<span id="cb227-30"><a href="#cb227-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(</span>
<span id="cb227-31"><a href="#cb227-31" aria-hidden="true" tabindex="-1"></a>    <span class="st">""</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Microbiota"</span> <span class="ot">=</span> <span class="st">"indianred1"</span>, <span class="st">"Cytokines"</span> <span class="ot">=</span> <span class="st">"darkslateblue"</span>, <span class="st">"Same visit"</span> <span class="ot">=</span> <span class="st">"gray60"</span>)</span>
<span id="cb227-32"><a href="#cb227-32" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb227-33"><a href="#cb227-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_discrete</span>(<span class="st">"Signif. correlation"</span>) <span class="sc">+</span></span>
<span id="cb227-34"><a href="#cb227-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"PCoA Dim 1"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"PCoA Dim 2"</span>)</span>
<span id="cb227-35"><a href="#cb227-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-36"><a href="#cb227-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-37"><a href="#cb227-37" aria-hidden="true" tabindex="-1"></a>g_PCoA_34 <span class="ot">&lt;-</span> </span>
<span id="cb227-38"><a href="#cb227-38" aria-hidden="true" tabindex="-1"></a>  RV_PCoA_points <span class="sc">|&gt;</span> </span>
<span id="cb227-39"><a href="#cb227-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Dim3, <span class="at">y =</span> Dim4)) <span class="sc">+</span></span>
<span id="cb227-40"><a href="#cb227-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"gray"</span>) <span class="sc">+</span></span>
<span id="cb227-41"><a href="#cb227-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"gray"</span>) <span class="sc">+</span></span>
<span id="cb227-42"><a href="#cb227-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(</span>
<span id="cb227-43"><a href="#cb227-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> RV_long_manual_aug <span class="sc">|&gt;</span> <span class="fu">filter</span>(<span class="sc">!</span>((X <span class="sc">==</span> <span class="st">"M7"</span>) <span class="sc">&amp;</span> (Y <span class="sc">==</span> <span class="st">"C0"</span>))),</span>
<span id="cb227-44"><a href="#cb227-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> Dim3.x, <span class="at">y =</span> Dim4.x, <span class="at">xend =</span> Dim3.y, <span class="at">yend =</span> Dim4.y, </span>
<span id="cb227-45"><a href="#cb227-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> joint_type, <span class="at">linetype =</span> signif_corr),</span>
<span id="cb227-46"><a href="#cb227-46" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb227-47"><a href="#cb227-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="fu">aes</span>(<span class="at">label =</span> visit, <span class="at">color =</span> modality), <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb227-48"><a href="#cb227-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>() <span class="sc">+</span></span>
<span id="cb227-49"><a href="#cb227-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(</span>
<span id="cb227-50"><a href="#cb227-50" aria-hidden="true" tabindex="-1"></a>    <span class="st">""</span>,</span>
<span id="cb227-51"><a href="#cb227-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Microbiota"</span> <span class="ot">=</span> <span class="st">"indianred1"</span>, <span class="st">"Cytokines"</span> <span class="ot">=</span> <span class="st">"darkslateblue"</span>, </span>
<span id="cb227-52"><a href="#cb227-52" aria-hidden="true" tabindex="-1"></a>               <span class="st">"Same visit"</span> <span class="ot">=</span> <span class="st">"gray60"</span>)</span>
<span id="cb227-53"><a href="#cb227-53" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb227-54"><a href="#cb227-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_discrete</span>(<span class="st">"Signif. correlation"</span>) <span class="sc">+</span></span>
<span id="cb227-55"><a href="#cb227-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"PCoA Dim 3"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"PCoA Dim 4"</span>)</span>
<span id="cb227-56"><a href="#cb227-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-57"><a href="#cb227-57" aria-hidden="true" tabindex="-1"></a>g_PCoA_13 <span class="ot">&lt;-</span> </span>
<span id="cb227-58"><a href="#cb227-58" aria-hidden="true" tabindex="-1"></a>  RV_PCoA_points <span class="sc">|&gt;</span> </span>
<span id="cb227-59"><a href="#cb227-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Dim1, <span class="at">y =</span> Dim3)) <span class="sc">+</span></span>
<span id="cb227-60"><a href="#cb227-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"gray"</span>) <span class="sc">+</span></span>
<span id="cb227-61"><a href="#cb227-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"gray"</span>) <span class="sc">+</span></span>
<span id="cb227-62"><a href="#cb227-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(</span>
<span id="cb227-63"><a href="#cb227-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> RV_long_manual_aug <span class="sc">|&gt;</span> <span class="fu">filter</span>(<span class="sc">!</span>((X <span class="sc">==</span> <span class="st">"M7"</span>) <span class="sc">&amp;</span> (Y <span class="sc">==</span> <span class="st">"C0"</span>))),</span>
<span id="cb227-64"><a href="#cb227-64" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> Dim1.x, <span class="at">y =</span> Dim3.x, <span class="at">xend =</span> Dim1.y, <span class="at">yend =</span> Dim3.y, </span>
<span id="cb227-65"><a href="#cb227-65" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> joint_type, <span class="at">linetype =</span> signif_corr),</span>
<span id="cb227-66"><a href="#cb227-66" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb227-67"><a href="#cb227-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="fu">aes</span>(<span class="at">label =</span> visit, <span class="at">color =</span> modality), <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb227-68"><a href="#cb227-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>() <span class="sc">+</span></span>
<span id="cb227-69"><a href="#cb227-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(</span>
<span id="cb227-70"><a href="#cb227-70" aria-hidden="true" tabindex="-1"></a>    <span class="st">""</span>,</span>
<span id="cb227-71"><a href="#cb227-71" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Microbiota"</span> <span class="ot">=</span> <span class="st">"indianred1"</span>, <span class="st">"Cytokines"</span> <span class="ot">=</span> <span class="st">"darkslateblue"</span>, </span>
<span id="cb227-72"><a href="#cb227-72" aria-hidden="true" tabindex="-1"></a>               <span class="st">"Same visit"</span> <span class="ot">=</span> <span class="st">"gray60"</span>)</span>
<span id="cb227-73"><a href="#cb227-73" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb227-74"><a href="#cb227-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_discrete</span>(<span class="st">"Signif. correlation"</span>) <span class="sc">+</span></span>
<span id="cb227-75"><a href="#cb227-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"PCoA Dim 1"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"PCoA Dim 3"</span>)</span>
<span id="cb227-76"><a href="#cb227-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-77"><a href="#cb227-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-78"><a href="#cb227-78" aria-hidden="true" tabindex="-1"></a>g_PCoA_12 <span class="sc">+</span> g_PCoA_34 <span class="sc">+</span></span>
<span id="cb227-79"><a href="#cb227-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">"collect"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-239-1.png" class="img-fluid figure-img" width="1056"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb228"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb228-1"><a href="#cb228-1" aria-hidden="true" tabindex="-1"></a>g_PCoA_12 <span class="sc">+</span> g_PCoA_13 <span class="sc">+</span></span>
<span id="cb228-2"><a href="#cb228-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">"collect"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-239-2.png" class="img-fluid figure-img" width="1056"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb229"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb229-1"><a href="#cb229-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb229-2"><a href="#cb229-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb229-3"><a href="#cb229-3" aria-hidden="true" tabindex="-1"></a>RV_PCoA_points <span class="sc">|&gt;</span> </span>
<span id="cb229-4"><a href="#cb229-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_ly</span>(</span>
<span id="cb229-5"><a href="#cb229-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">"scatter3d"</span>, <span class="at">mode =</span> <span class="st">"markers"</span>,</span>
<span id="cb229-6"><a href="#cb229-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="sc">~</span>Dim1, <span class="at">y =</span> <span class="sc">~</span>Dim2, <span class="at">z =</span> <span class="sc">~</span>Dim3,</span>
<span id="cb229-7"><a href="#cb229-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="sc">~</span>modality</span>
<span id="cb229-8"><a href="#cb229-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb229-9"><a href="#cb229-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_text</span>(</span>
<span id="cb229-10"><a href="#cb229-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="sc">~</span>k</span>
<span id="cb229-11"><a href="#cb229-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb229-12"><a href="#cb229-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_paths</span>() <span class="sc">|&gt;</span> </span>
<span id="cb229-13"><a href="#cb229-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_lines</span>(</span>
<span id="cb229-14"><a href="#cb229-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="sc">~</span>visit </span>
<span id="cb229-15"><a href="#cb229-15" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-d02944f9a2b115166ef3" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-d02944f9a2b115166ef3">{"x":{"visdat":{"22ae196bd9ef":["function () ","plotlyVisDat"]},"cur_data":"22ae196bd9ef","attrs":{"22ae196bd9ef":{"mode":"markers","x":{},"y":{},"z":{},"color":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d"},"22ae196bd9ef.1":{"mode":"text","x":{},"y":{},"z":{},"color":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d","text":{},"inherit":true},"22ae196bd9ef.2":{"mode":"lines","x":{},"y":{},"z":{},"color":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d","inherit":true},"22ae196bd9ef.3":{"mode":"lines","x":{},"y":{},"z":{},"color":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"xaxis":{"title":"Dim1"},"yaxis":{"title":"Dim2"},"zaxis":{"title":"Dim3"}},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"mode":"markers","x":[-0.29588306810816267,-0.29184980592364523,-0.11171770813301192,-0.098768118234427979,-0.10461729425015345,-0.13630447801498091],"y":[0.016056642405020687,0.078153299429300313,0.096707816808766611,0.24026472206006302,0.16358725000745206,0.19927948098973713],"z":[-0.15382994385352969,-0.10767124703504707,-0.24776467730772384,-0.095881747182939722,0.12202171177166093,0.38726854014445861],"type":"scatter3d","name":"Cytokines","marker":{"color":"rgba(102,194,165,1)","line":{"color":"rgba(102,194,165,1)"}},"textfont":{"color":"rgba(102,194,165,1)"},"error_y":{"color":"rgba(102,194,165,1)"},"error_x":{"color":"rgba(102,194,165,1)"},"line":{"color":"rgba(102,194,165,1)"},"frame":null},{"mode":"markers","x":[-0.2428684882728466,-0.14350047914825151,0.32740081915153801,0.41097044479355677,0.37806290888548594,0.30907526725490209],"y":[-0.21208763265817387,-0.5232590699089289,-0.12460043159739925,0.015566963505910986,-0.020083857864189713,0.070414816822440551],"z":[-0.022710182614462549,0.16964993331961187,-0.236769499286857,-0.13250259223361638,0.056830700262087516,0.26135900401635681],"type":"scatter3d","name":"Microbiota","marker":{"color":"rgba(228,156,113,1)","line":{"color":"rgba(228,156,113,1)"}},"textfont":{"color":"rgba(228,156,113,1)"},"error_y":{"color":"rgba(228,156,113,1)"},"error_x":{"color":"rgba(228,156,113,1)"},"line":{"color":"rgba(228,156,113,1)"},"frame":null},{"mode":"text","x":[-0.29588306810816267,-0.29184980592364523,-0.11171770813301192,-0.098768118234427979,-0.10461729425015345,-0.13630447801498091],"y":[0.016056642405020687,0.078153299429300313,0.096707816808766611,0.24026472206006302,0.16358725000745206,0.19927948098973713],"z":[-0.15382994385352969,-0.10767124703504707,-0.24776467730772384,-0.095881747182939722,0.12202171177166093,0.38726854014445861],"type":"scatter3d","text":["C0","C1","C2","C3","C4","C7"],"name":"Cytokines","marker":{"color":"rgba(102,194,165,1)","line":{"color":"rgba(102,194,165,1)"}},"textfont":{"color":"rgba(102,194,165,1)"},"error_y":{"color":"rgba(102,194,165,1)"},"error_x":{"color":"rgba(102,194,165,1)"},"line":{"color":"rgba(102,194,165,1)"},"frame":null},{"mode":"text","x":[-0.2428684882728466,-0.14350047914825151,0.32740081915153801,0.41097044479355677,0.37806290888548594,0.30907526725490209],"y":[-0.21208763265817387,-0.5232590699089289,-0.12460043159739925,0.015566963505910986,-0.020083857864189713,0.070414816822440551],"z":[-0.022710182614462549,0.16964993331961187,-0.236769499286857,-0.13250259223361638,0.056830700262087516,0.26135900401635681],"type":"scatter3d","text":["M0","M1","M2","M3","M4","M7"],"name":"Microbiota","marker":{"color":"rgba(228,156,113,1)","line":{"color":"rgba(228,156,113,1)"}},"textfont":{"color":"rgba(228,156,113,1)"},"error_y":{"color":"rgba(228,156,113,1)"},"error_x":{"color":"rgba(228,156,113,1)"},"line":{"color":"rgba(228,156,113,1)"},"frame":null},{"mode":"lines","x":[-0.29588306810816267,-0.29184980592364523,-0.11171770813301192,-0.098768118234427979,-0.10461729425015345,-0.13630447801498091],"y":[0.016056642405020687,0.078153299429300313,0.096707816808766611,0.24026472206006302,0.16358725000745206,0.19927948098973713],"z":[-0.15382994385352969,-0.10767124703504707,-0.24776467730772384,-0.095881747182939722,0.12202171177166093,0.38726854014445861],"type":"scatter3d","name":"Cytokines","marker":{"color":"rgba(102,194,165,1)","line":{"color":"rgba(102,194,165,1)"}},"textfont":{"color":"rgba(102,194,165,1)"},"error_y":{"color":"rgba(102,194,165,1)"},"error_x":{"color":"rgba(102,194,165,1)"},"line":{"color":"rgba(102,194,165,1)"},"frame":null},{"mode":"lines","x":[-0.2428684882728466,-0.14350047914825151,0.32740081915153801,0.41097044479355677,0.37806290888548594,0.30907526725490209],"y":[-0.21208763265817387,-0.5232590699089289,-0.12460043159739925,0.015566963505910986,-0.020083857864189713,0.070414816822440551],"z":[-0.022710182614462549,0.16964993331961187,-0.236769499286857,-0.13250259223361638,0.056830700262087516,0.26135900401635681],"type":"scatter3d","name":"Microbiota","marker":{"color":"rgba(228,156,113,1)","line":{"color":"rgba(228,156,113,1)"}},"textfont":{"color":"rgba(228,156,113,1)"},"error_y":{"color":"rgba(228,156,113,1)"},"error_x":{"color":"rgba(228,156,113,1)"},"line":{"color":"rgba(228,156,113,1)"},"frame":null},{"mode":"lines","x":[-0.29588306810816267,-0.2428684882728466],"y":[0.016056642405020687,-0.21208763265817387],"z":[-0.15382994385352969,-0.022710182614462549],"type":"scatter3d","name":"Pre-MTZ","marker":{"color":"rgba(201,152,157,1)","line":{"color":"rgba(201,152,157,1)"}},"textfont":{"color":"rgba(201,152,157,1)"},"error_y":{"color":"rgba(201,152,157,1)"},"error_x":{"color":"rgba(201,152,157,1)"},"line":{"color":"rgba(201,152,157,1)"},"frame":null},{"mode":"lines","x":[-0.29184980592364523,-0.14350047914825151],"y":[0.078153299429300313,-0.5232590699089289],"z":[-0.10767124703504707,0.16964993331961187],"type":"scatter3d","name":"Post-MTZ","marker":{"color":"rgba(175,154,200,1)","line":{"color":"rgba(175,154,200,1)"}},"textfont":{"color":"rgba(175,154,200,1)"},"error_y":{"color":"rgba(175,154,200,1)"},"error_x":{"color":"rgba(175,154,200,1)"},"line":{"color":"rgba(175,154,200,1)"},"frame":null},{"mode":"lines","x":[-0.11171770813301192,0.32740081915153801],"y":[0.096707816808766611,-0.12460043159739925],"z":[-0.24776467730772384,-0.236769499286857],"type":"scatter3d","name":"Week 4","marker":{"color":"rgba(226,148,184,1)","line":{"color":"rgba(226,148,184,1)"}},"textfont":{"color":"rgba(226,148,184,1)"},"error_y":{"color":"rgba(226,148,184,1)"},"error_x":{"color":"rgba(226,148,184,1)"},"line":{"color":"rgba(226,148,184,1)"},"frame":null},{"mode":"lines","x":[-0.098768118234427979,0.41097044479355677],"y":[0.24026472206006302,0.015566963505910986],"z":[-0.095881747182939722,-0.13250259223361638],"type":"scatter3d","name":"Week 8","marker":{"color":"rgba(176,208,99,1)","line":{"color":"rgba(176,208,99,1)"}},"textfont":{"color":"rgba(176,208,99,1)"},"error_y":{"color":"rgba(176,208,99,1)"},"error_x":{"color":"rgba(176,208,99,1)"},"line":{"color":"rgba(176,208,99,1)"},"frame":null},{"mode":"lines","x":[-0.10461729425015345,0.37806290888548594],"y":[0.16358725000745206,-0.020083857864189713],"z":[0.12202171177166093,0.056830700262087516],"type":"scatter3d","name":"Week 12","marker":{"color":"rgba(227,217,62,1)","line":{"color":"rgba(227,217,62,1)"}},"textfont":{"color":"rgba(227,217,62,1)"},"error_y":{"color":"rgba(227,217,62,1)"},"error_x":{"color":"rgba(227,217,62,1)"},"line":{"color":"rgba(227,217,62,1)"},"frame":null},{"mode":"lines","x":[-0.13630447801498091,0.30907526725490209],"y":[0.19927948098973713,0.070414816822440551],"z":[0.38726854014445861,0.26135900401635681],"type":"scatter3d","name":"Week 24","marker":{"color":"rgba(179,179,179,1)","line":{"color":"rgba(179,179,179,1)"}},"textfont":{"color":"rgba(179,179,179,1)"},"error_y":{"color":"rgba(179,179,179,1)"},"error_x":{"color":"rgba(179,179,179,1)"},"line":{"color":"rgba(179,179,179,1)"},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb230"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb230-1"><a href="#cb230-1" aria-hidden="true" tabindex="-1"></a>res<span class="sc">$</span>res4Cmat<span class="sc">$</span>eigValues</span>
<span id="cb230-2"><a href="#cb230-2" aria-hidden="true" tabindex="-1"></a>res<span class="sc">$</span>res4Cmat<span class="sc">$</span>eigValues<span class="sc">/</span><span class="fu">sum</span>(res<span class="sc">$</span>res4Cmat<span class="sc">$</span>eigValues)</span>
<span id="cb230-3"><a href="#cb230-3" aria-hidden="true" tabindex="-1"></a>(res<span class="sc">$</span>res4Cmat<span class="sc">$</span>eigValues<span class="sc">/</span><span class="fu">sum</span>(res<span class="sc">$</span>res4Cmat<span class="sc">$</span>eigValues)) <span class="sc">|&gt;</span> <span class="fu">plot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Screeplot of the compromise eigenvalues</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb231"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb231-1"><a href="#cb231-1" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> </span>
<span id="cb231-2"><a href="#cb231-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">eig =</span> res<span class="sc">$</span>res4Splus<span class="sc">$</span>eigValues) <span class="sc">|&gt;</span> </span>
<span id="cb231-3"><a href="#cb231-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n =</span> <span class="fu">row_number</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb231-4"><a href="#cb231-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> n, <span class="at">y =</span> eig)) <span class="sc">+</span></span>
<span id="cb231-5"><a href="#cb231-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>()</span>
<span id="cb231-6"><a href="#cb231-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb231-7"><a href="#cb231-7" aria-hidden="true" tabindex="-1"></a>g <span class="sc">+</span></span>
<span id="cb231-8"><a href="#cb231-8" aria-hidden="true" tabindex="-1"></a>g <span class="sc">+</span> <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">21</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-242-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb232"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb232-1"><a href="#cb232-1" aria-hidden="true" tabindex="-1"></a>compromise <span class="ot">&lt;-</span> </span>
<span id="cb232-2"><a href="#cb232-2" aria-hidden="true" tabindex="-1"></a>  res<span class="sc">$</span>res4Splus<span class="sc">$</span>F <span class="sc">|&gt;</span> </span>
<span id="cb232-3"><a href="#cb232-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span> </span>
<span id="cb232-4"><a href="#cb232-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"USUBJID"</span>) <span class="sc">|&gt;</span></span>
<span id="cb232-5"><a href="#cb232-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb232-6"><a href="#cb232-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(combined <span class="sc">|&gt;</span> <span class="fu">select</span>(USUBJID, ARM) <span class="sc">|&gt;</span> <span class="fu">distinct</span>(), <span class="at">by =</span> <span class="fu">join_by</span>(USUBJID))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb233"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb233-1"><a href="#cb233-1" aria-hidden="true" tabindex="-1"></a>compromise <span class="sc">|&gt;</span> </span>
<span id="cb233-2"><a href="#cb233-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Factor 1</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">Factor 2</span><span class="st">`</span>, <span class="at">col =</span> ARM)) <span class="sc">+</span></span>
<span id="cb233-3"><a href="#cb233-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb233-4"><a href="#cb233-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_ellipse</span>() <span class="sc">+</span></span>
<span id="cb233-5"><a href="#cb233-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>(<span class="at">ratio =</span> res<span class="sc">$</span>res4Splus<span class="sc">$</span>eigValues[<span class="dv">2</span>]<span class="sc">/</span>res<span class="sc">$</span>res4Splus<span class="sc">$</span>eigValues[<span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb233-6"><a href="#cb233-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">get_arm_colors</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-244-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb234"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb234-1"><a href="#cb234-1" aria-hidden="true" tabindex="-1"></a>compromise <span class="sc">|&gt;</span> </span>
<span id="cb234-2"><a href="#cb234-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Factor 3</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">Factor 4</span><span class="st">`</span>, <span class="at">col =</span> ARM)) <span class="sc">+</span></span>
<span id="cb234-3"><a href="#cb234-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb234-4"><a href="#cb234-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_ellipse</span>() <span class="sc">+</span></span>
<span id="cb234-5"><a href="#cb234-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>(<span class="at">ratio =</span> res<span class="sc">$</span>res4Splus<span class="sc">$</span>eigValues[<span class="dv">4</span>]<span class="sc">/</span>res<span class="sc">$</span>res4Splus<span class="sc">$</span>eigValues[<span class="dv">3</span>]) <span class="sc">+</span></span>
<span id="cb234-6"><a href="#cb234-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">get_arm_colors</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-244-2.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<p>Partial scores</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb235"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb235-1"><a href="#cb235-1" aria-hidden="true" tabindex="-1"></a>partial <span class="ot">&lt;-</span> </span>
<span id="cb235-2"><a href="#cb235-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(</span>
<span id="cb235-3"><a href="#cb235-3" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(res<span class="sc">$</span>res4Splus<span class="sc">$</span>PartialF)[<span class="dv">3</span>], </span>
<span id="cb235-4"><a href="#cb235-4" aria-hidden="true" tabindex="-1"></a>    <span class="sc">~</span> </span>
<span id="cb235-5"><a href="#cb235-5" aria-hidden="true" tabindex="-1"></a>      res<span class="sc">$</span>res4Splus<span class="sc">$</span>PartialF[,,.] <span class="sc">|&gt;</span> </span>
<span id="cb235-6"><a href="#cb235-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb235-7"><a href="#cb235-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(</span>
<span id="cb235-8"><a href="#cb235-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">table =</span> <span class="fu">dimnames</span>(res<span class="sc">$</span>res4Splus<span class="sc">$</span>PartialF)[[<span class="dv">3</span>]][.x],</span>
<span id="cb235-9"><a href="#cb235-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">USUBJID =</span> <span class="fu">rownames</span>(res<span class="sc">$</span>res4Splus<span class="sc">$</span>PartialF[,,.x])</span>
<span id="cb235-10"><a href="#cb235-10" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb235-11"><a href="#cb235-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb235-12"><a href="#cb235-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>() <span class="sc">|&gt;</span> </span>
<span id="cb235-13"><a href="#cb235-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(combined <span class="sc">|&gt;</span> <span class="fu">select</span>(USUBJID, ARM) <span class="sc">|&gt;</span> <span class="fu">distinct</span>(), <span class="at">by =</span> <span class="fu">join_by</span>(USUBJID)) <span class="sc">|&gt;</span> </span>
<span id="cb235-14"><a href="#cb235-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">AVISITN =</span> <span class="fu">parse_number</span>(table)) <span class="sc">|&gt;</span> </span>
<span id="cb235-15"><a href="#cb235-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(</span>
<span id="cb235-16"><a href="#cb235-16" aria-hidden="true" tabindex="-1"></a>    compromise <span class="sc">|&gt;</span> </span>
<span id="cb235-17"><a href="#cb235-17" aria-hidden="true" tabindex="-1"></a>      <span class="fu">expand_grid</span>(<span class="at">AVISITN =</span> pipv) <span class="sc">|&gt;</span> </span>
<span id="cb235-18"><a href="#cb235-18" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">table =</span> <span class="st">"compromise"</span>)</span>
<span id="cb235-19"><a href="#cb235-19" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb235-20"><a href="#cb235-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb235-21"><a href="#cb235-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">table_type =</span> </span>
<span id="cb235-22"><a href="#cb235-22" aria-hidden="true" tabindex="-1"></a>      <span class="fu">case_when</span>(</span>
<span id="cb235-23"><a href="#cb235-23" aria-hidden="true" tabindex="-1"></a>        <span class="fu">str_detect</span>(table, <span class="st">"M"</span>) <span class="sc">~</span> <span class="st">"Microbiota"</span>,</span>
<span id="cb235-24"><a href="#cb235-24" aria-hidden="true" tabindex="-1"></a>        <span class="fu">str_detect</span>(table, <span class="st">"C"</span>) <span class="sc">~</span> <span class="st">"Cytokines"</span>,</span>
<span id="cb235-25"><a href="#cb235-25" aria-hidden="true" tabindex="-1"></a>        table <span class="sc">==</span> <span class="st">"compromise"</span> <span class="sc">~</span> <span class="st">"Compromise"</span></span>
<span id="cb235-26"><a href="#cb235-26" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb235-27"><a href="#cb235-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">visit =</span> <span class="fu">get_visit_labels</span>(AVISITN)</span>
<span id="cb235-28"><a href="#cb235-28" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb236"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb236-1"><a href="#cb236-1" aria-hidden="true" tabindex="-1"></a>partial <span class="sc">|&gt;</span> </span>
<span id="cb236-2"><a href="#cb236-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Factor 1</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">Factor 2</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb236-3"><a href="#cb236-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"gray80"</span>) <span class="sc">+</span></span>
<span id="cb236-4"><a href="#cb236-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"gray80"</span>) <span class="sc">+</span></span>
<span id="cb236-5"><a href="#cb236-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> USUBJID), <span class="at">col =</span> <span class="st">"gray"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb236-6"><a href="#cb236-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">col =</span> table_type), <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb236-7"><a href="#cb236-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>(<span class="at">ratio =</span> res<span class="sc">$</span>res4Splus<span class="sc">$</span>eigValues[<span class="dv">2</span>]<span class="sc">/</span>res<span class="sc">$</span>res4Splus<span class="sc">$</span>eigValues[<span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb236-8"><a href="#cb236-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(ARM <span class="sc">~</span> visit) <span class="sc">+</span></span>
<span id="cb236-9"><a href="#cb236-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="st">""</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"steelblue1"</span>, <span class="st">"darkslateblue"</span>, <span class="st">"indianred1"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-246-1.png" class="img-fluid figure-img" width="1440"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb237"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb237-1"><a href="#cb237-1" aria-hidden="true" tabindex="-1"></a>partial <span class="sc">|&gt;</span> </span>
<span id="cb237-2"><a href="#cb237-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Factor 3</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">Factor 4</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb237-3"><a href="#cb237-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"gray80"</span>) <span class="sc">+</span></span>
<span id="cb237-4"><a href="#cb237-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"gray80"</span>) <span class="sc">+</span></span>
<span id="cb237-5"><a href="#cb237-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> USUBJID), <span class="at">col =</span> <span class="st">"gray"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb237-6"><a href="#cb237-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">col =</span> table_type), <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb237-7"><a href="#cb237-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>(<span class="at">ratio =</span> res<span class="sc">$</span>res4Splus<span class="sc">$</span>eigValues[<span class="dv">4</span>]<span class="sc">/</span>res<span class="sc">$</span>res4Splus<span class="sc">$</span>eigValues[<span class="dv">3</span>]) <span class="sc">+</span></span>
<span id="cb237-8"><a href="#cb237-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(ARM <span class="sc">~</span> visit) <span class="sc">+</span></span>
<span id="cb237-9"><a href="#cb237-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="st">""</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"steelblue1"</span>, <span class="st">"darkslateblue"</span>, <span class="st">"indianred1"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-246-2.png" class="img-fluid figure-img" width="1440"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb238"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb238-1"><a href="#cb238-1" aria-hidden="true" tabindex="-1"></a>correlations_factors_variables <span class="ot">&lt;-</span></span>
<span id="cb238-2"><a href="#cb238-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(</span>
<span id="cb238-3"><a href="#cb238-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">seq_along</span>(combined_by_visits_complete_cases),</span>
<span id="cb238-4"><a href="#cb238-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">function</span>(x){</span>
<span id="cb238-5"><a href="#cb238-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cor</span>(combined_by_visits_complete_cases[[x]], </span>
<span id="cb238-6"><a href="#cb238-6" aria-hidden="true" tabindex="-1"></a>          compromise <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"Factor"</span>))) <span class="sc">|&gt;</span> </span>
<span id="cb238-7"><a href="#cb238-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span> </span>
<span id="cb238-8"><a href="#cb238-8" aria-hidden="true" tabindex="-1"></a>        <span class="fu">rownames_to_column</span>(<span class="st">"feature"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb238-9"><a href="#cb238-9" aria-hidden="true" tabindex="-1"></a>        <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb238-10"><a href="#cb238-10" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">table =</span> <span class="fu">names</span>(combined_by_visits_complete_cases)[x])</span>
<span id="cb238-11"><a href="#cb238-11" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb238-12"><a href="#cb238-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb238-13"><a href="#cb238-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>() </span>
<span id="cb238-14"><a href="#cb238-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb238-15"><a href="#cb238-15" aria-hidden="true" tabindex="-1"></a>correlations_factors_variables <span class="ot">&lt;-</span> </span>
<span id="cb238-16"><a href="#cb238-16" aria-hidden="true" tabindex="-1"></a>  correlations_factors_variables <span class="sc">|&gt;</span> </span>
<span id="cb238-17"><a href="#cb238-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb238-18"><a href="#cb238-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">table_type =</span> </span>
<span id="cb238-19"><a href="#cb238-19" aria-hidden="true" tabindex="-1"></a>      <span class="fu">case_when</span>(</span>
<span id="cb238-20"><a href="#cb238-20" aria-hidden="true" tabindex="-1"></a>        <span class="fu">str_detect</span>(table, <span class="st">"M"</span>) <span class="sc">~</span> <span class="st">"Microbiota"</span>,</span>
<span id="cb238-21"><a href="#cb238-21" aria-hidden="true" tabindex="-1"></a>        <span class="fu">str_detect</span>(table, <span class="st">"T"</span>) <span class="sc">~</span> <span class="st">"Topics"</span>,</span>
<span id="cb238-22"><a href="#cb238-22" aria-hidden="true" tabindex="-1"></a>        <span class="fu">str_detect</span>(table, <span class="st">"C"</span>) <span class="sc">~</span> <span class="st">"Cytokines"</span>,</span>
<span id="cb238-23"><a href="#cb238-23" aria-hidden="true" tabindex="-1"></a>        <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Error"</span></span>
<span id="cb238-24"><a href="#cb238-24" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb238-25"><a href="#cb238-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">AVISITN =</span> <span class="fu">parse_number</span>(table),</span>
<span id="cb238-26"><a href="#cb238-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">visit =</span> <span class="fu">get_visit_labels</span>(AVISITN)</span>
<span id="cb238-27"><a href="#cb238-27" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Correlation circles</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb239"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb239-1"><a href="#cb239-1" aria-hidden="true" tabindex="-1"></a>correlations_factors_variables <span class="sc">|&gt;</span> </span>
<span id="cb239-2"><a href="#cb239-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(table_type <span class="sc">!=</span> <span class="st">"Microbiota"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb239-3"><a href="#cb239-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Factor 1</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">Factor 2</span><span class="st">`</span>, <span class="at">col =</span> feature)) <span class="sc">+</span></span>
<span id="cb239-4"><a href="#cb239-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_circle</span>(<span class="fu">aes</span>(<span class="at">x0 =</span> <span class="dv">0</span>, <span class="at">y0 =</span> <span class="dv">0</span>, <span class="at">r =</span> <span class="dv">1</span>), <span class="at">col =</span> <span class="st">"gray80"</span>, <span class="at">linewidth =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb239-5"><a href="#cb239-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(</span>
<span id="cb239-6"><a href="#cb239-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">xend =</span> <span class="dv">0</span>, <span class="at">yend =</span> <span class="dv">0</span>), </span>
<span id="cb239-7"><a href="#cb239-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">arrow =</span> </span>
<span id="cb239-8"><a href="#cb239-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">arrow</span>(<span class="at">ends =</span> <span class="st">"first"</span>, <span class="at">type =</span> <span class="st">"closed"</span>, <span class="at">angle =</span> <span class="dv">20</span>, <span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.1</span>, <span class="st">"inches"</span>))</span>
<span id="cb239-9"><a href="#cb239-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb239-10"><a href="#cb239-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>(<span class="fu">aes</span>(<span class="at">label =</span> feature), <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb239-11"><a href="#cb239-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>() <span class="sc">+</span></span>
<span id="cb239-12"><a href="#cb239-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(table_type <span class="sc">~</span> visit) <span class="sc">+</span></span>
<span id="cb239-13"><a href="#cb239-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">col =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-248-1.png" class="img-fluid figure-img" width="1536"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb240"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb240-1"><a href="#cb240-1" aria-hidden="true" tabindex="-1"></a>correlations_factors_variables <span class="sc">|&gt;</span> </span>
<span id="cb240-2"><a href="#cb240-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(table_type <span class="sc">!=</span> <span class="st">"Microbiota"</span>) <span class="sc">|&gt;</span></span>
<span id="cb240-3"><a href="#cb240-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Factor 1</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">Factor 2</span><span class="st">`</span>, <span class="at">col =</span> visit)) <span class="sc">+</span></span>
<span id="cb240-4"><a href="#cb240-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_circle</span>(<span class="fu">aes</span>(<span class="at">x0 =</span> <span class="dv">0</span>, <span class="at">y0 =</span> <span class="dv">0</span>, <span class="at">r =</span> <span class="dv">1</span>), <span class="at">col =</span> <span class="st">"gray80"</span>, <span class="at">linewidth =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb240-5"><a href="#cb240-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(</span>
<span id="cb240-6"><a href="#cb240-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">xend =</span> <span class="dv">0</span>, <span class="at">yend =</span> <span class="dv">0</span>), </span>
<span id="cb240-7"><a href="#cb240-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">arrow =</span> </span>
<span id="cb240-8"><a href="#cb240-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">arrow</span>(<span class="at">ends =</span> <span class="st">"first"</span>, <span class="at">type =</span> <span class="st">"closed"</span>, <span class="at">angle =</span> <span class="dv">20</span>, <span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.1</span>, <span class="st">"inches"</span>))</span>
<span id="cb240-9"><a href="#cb240-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb240-10"><a href="#cb240-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>() <span class="sc">+</span></span>
<span id="cb240-11"><a href="#cb240-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(feature <span class="sc">~</span> ., <span class="at">nrow =</span> <span class="dv">3</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-249-1.png" class="img-fluid figure-img" width="1440"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="overall-bc-l1---excluding-post-mtz-visit" class="level4" data-number="2.1.2.2">
<h4 data-number="2.1.2.2" class="anchored" data-anchor-id="overall-bc-l1---excluding-post-mtz-visit"><span class="header-section-number">2.1.2.2</span> Overall (BC &amp; L1) - Excluding post-MTZ visit</h4>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb241"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb241-1"><a href="#cb241-1" aria-hidden="true" tabindex="-1"></a>distances <span class="ot">&lt;-</span> </span>
<span id="cb241-2"><a href="#cb241-2" aria-hidden="true" tabindex="-1"></a>  combined <span class="sc">|&gt;</span> </span>
<span id="cb241-3"><a href="#cb241-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(AVISITN <span class="sc">!=</span> <span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb241-4"><a href="#cb241-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb241-5"><a href="#cb241-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">mb_distances =</span> vegan<span class="sc">::</span><span class="fu">vegdist</span>(rel_ab, <span class="at">method =</span> <span class="st">"bray"</span>) <span class="sc">|&gt;</span> <span class="fu">as.matrix</span>(),</span>
<span id="cb241-6"><a href="#cb241-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">cytokine_distances =</span> <span class="fu">dist</span>(cytokines, <span class="at">method =</span> <span class="st">"manhattan"</span>) <span class="sc">|&gt;</span> <span class="fu">as.matrix</span>()</span>
<span id="cb241-7"><a href="#cb241-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb241-8"><a href="#cb241-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb241-9"><a href="#cb241-9" aria-hidden="true" tabindex="-1"></a>dist_cube <span class="ot">&lt;-</span> </span>
<span id="cb241-10"><a href="#cb241-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">array</span>(</span>
<span id="cb241-11"><a href="#cb241-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(</span>
<span id="cb241-12"><a href="#cb241-12" aria-hidden="true" tabindex="-1"></a>      distances<span class="sc">$</span>mb_distances, </span>
<span id="cb241-13"><a href="#cb241-13" aria-hidden="true" tabindex="-1"></a>      distances<span class="sc">$</span>cytokine_distances</span>
<span id="cb241-14"><a href="#cb241-14" aria-hidden="true" tabindex="-1"></a>    ), </span>
<span id="cb241-15"><a href="#cb241-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">nrow</span>(distances), <span class="fu">nrow</span>(distances), <span class="dv">2</span>)</span>
<span id="cb241-16"><a href="#cb241-16" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb241-17"><a href="#cb241-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb241-18"><a href="#cb241-18" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">distatis</span>(dist_cube, <span class="at">nfact =</span> <span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb242"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb242-1"><a href="#cb242-1" aria-hidden="true" tabindex="-1"></a>res<span class="sc">$</span>res4Cmat<span class="sc">$</span>C <span class="co"># RV equivalent</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>         [,1]     [,2]
[1,] 1.000000 0.264849
[2,] 0.264849 1.000000</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb244"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb244-1"><a href="#cb244-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compute_RV(distances$topic_distances, distances$cytokine_distances)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb245"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb245-1"><a href="#cb245-1" aria-hidden="true" tabindex="-1"></a>res<span class="sc">$</span>res4Cmat<span class="sc">$</span>eigValues</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   dim 1    dim 2 
1.264849 0.735151 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb247"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb247-1"><a href="#cb247-1" aria-hidden="true" tabindex="-1"></a>res<span class="sc">$</span>res4Cmat<span class="sc">$</span>eigValues<span class="sc">/</span><span class="fu">sum</span>(res<span class="sc">$</span>res4Cmat<span class="sc">$</span>eigValues)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    dim 1     dim 2 
0.6324245 0.3675755 </code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb249"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb249-1"><a href="#cb249-1" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> </span>
<span id="cb249-2"><a href="#cb249-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">eig =</span> res<span class="sc">$</span>res4Splus<span class="sc">$</span>eigValues) <span class="sc">|&gt;</span> </span>
<span id="cb249-3"><a href="#cb249-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n =</span> <span class="fu">row_number</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb249-4"><a href="#cb249-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> n, <span class="at">y =</span> eig)) <span class="sc">+</span></span>
<span id="cb249-5"><a href="#cb249-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>()</span>
<span id="cb249-6"><a href="#cb249-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-7"><a href="#cb249-7" aria-hidden="true" tabindex="-1"></a>g <span class="sc">+</span> </span>
<span id="cb249-8"><a href="#cb249-8" aria-hidden="true" tabindex="-1"></a>  patchwork<span class="sc">::</span><span class="fu">inset_element</span>(</span>
<span id="cb249-9"><a href="#cb249-9" aria-hidden="true" tabindex="-1"></a>    g <span class="sc">+</span> <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">21</span>)),</span>
<span id="cb249-10"><a href="#cb249-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">left =</span> <span class="fl">0.2</span>, <span class="at">bottom =</span> <span class="fl">0.25</span>, <span class="at">right =</span> <span class="dv">1</span>, <span class="at">top =</span> <span class="dv">1</span>, <span class="at">align_to =</span> <span class="st">"plot"</span>, <span class="at">ignore_tag =</span> <span class="cn">TRUE</span></span>
<span id="cb249-11"><a href="#cb249-11" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-253-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb250"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb250-1"><a href="#cb250-1" aria-hidden="true" tabindex="-1"></a>g_eig <span class="ot">&lt;-</span> </span>
<span id="cb250-2"><a href="#cb250-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">eig =</span> res<span class="sc">$</span>res4Splus<span class="sc">$</span>eigValues) <span class="sc">|&gt;</span> </span>
<span id="cb250-3"><a href="#cb250-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n =</span> <span class="fu">row_number</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb250-4"><a href="#cb250-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(n <span class="sc">&lt;=</span> <span class="dv">10</span>) <span class="sc">|&gt;</span> </span>
<span id="cb250-5"><a href="#cb250-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> n <span class="sc">|&gt;</span> <span class="fu">factor</span>(), <span class="at">y =</span> eig)) <span class="sc">+</span></span>
<span id="cb250-6"><a href="#cb250-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="st">"gray50"</span>) <span class="sc">+</span></span>
<span id="cb250-7"><a href="#cb250-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"DiSTATIS comp."</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Eigenv."</span>) <span class="sc">+</span></span>
<span id="cb250-8"><a href="#cb250-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_blank</span>())</span>
<span id="cb250-9"><a href="#cb250-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb250-10"><a href="#cb250-10" aria-hidden="true" tabindex="-1"></a><span class="co"># g_eig</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb251"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb251-1"><a href="#cb251-1" aria-hidden="true" tabindex="-1"></a>compromise <span class="ot">&lt;-</span> </span>
<span id="cb251-2"><a href="#cb251-2" aria-hidden="true" tabindex="-1"></a>  res<span class="sc">$</span>res4Splus<span class="sc">$</span>F <span class="sc">|&gt;</span> </span>
<span id="cb251-3"><a href="#cb251-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb251-4"><a href="#cb251-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(distances <span class="sc">|&gt;</span> <span class="fu">select</span>(USUBJID, AVISITN, ARM, PIPV))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb252"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb252-1"><a href="#cb252-1" aria-hidden="true" tabindex="-1"></a>g_compromise_per_visit <span class="ot">&lt;-</span> </span>
<span id="cb252-2"><a href="#cb252-2" aria-hidden="true" tabindex="-1"></a>  compromise <span class="sc">|&gt;</span> </span>
<span id="cb252-3"><a href="#cb252-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(PIPV) <span class="sc">|&gt;</span> </span>
<span id="cb252-4"><a href="#cb252-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Factor 1</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">Factor 2</span><span class="st">`</span>, <span class="at">col =</span> ARM)) <span class="sc">+</span></span>
<span id="cb252-5"><a href="#cb252-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"gray"</span>) <span class="sc">+</span></span>
<span id="cb252-6"><a href="#cb252-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"gray"</span>) <span class="sc">+</span></span>
<span id="cb252-7"><a href="#cb252-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb252-8"><a href="#cb252-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_ellipse</span>() <span class="sc">+</span></span>
<span id="cb252-9"><a href="#cb252-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>(<span class="at">ratio =</span> res<span class="sc">$</span>res4Splus<span class="sc">$</span>eigValues[<span class="dv">2</span>]<span class="sc">/</span>res<span class="sc">$</span>res4Splus<span class="sc">$</span>eigValues[<span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb252-10"><a href="#cb252-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(. <span class="sc">~</span> <span class="fu">get_visit_labels</span>(AVISITN)) <span class="sc">+</span></span>
<span id="cb252-11"><a href="#cb252-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="st">"Intervention Arm"</span>, <span class="at">values =</span> <span class="fu">get_arm_colors</span>()) <span class="sc">+</span></span>
<span id="cb252-12"><a href="#cb252-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"DiSTATIS Compromise Component 1"</span>) <span class="sc">+</span></span>
<span id="cb252-13"><a href="#cb252-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Component 2"</span>) <span class="sc">+</span> </span>
<span id="cb252-14"><a href="#cb252-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span>
<span id="cb252-15"><a href="#cb252-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb252-16"><a href="#cb252-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb252-17"><a href="#cb252-17" aria-hidden="true" tabindex="-1"></a>g_compromise_per_visit</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-256-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb253"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb253-1"><a href="#cb253-1" aria-hidden="true" tabindex="-1"></a>compromise <span class="sc">|&gt;</span> </span>
<span id="cb253-2"><a href="#cb253-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(PIPV) <span class="sc">|&gt;</span> </span>
<span id="cb253-3"><a href="#cb253-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Factor 3</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">Factor 4</span><span class="st">`</span>, <span class="at">col =</span> ARM)) <span class="sc">+</span></span>
<span id="cb253-4"><a href="#cb253-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb253-5"><a href="#cb253-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_ellipse</span>() <span class="sc">+</span></span>
<span id="cb253-6"><a href="#cb253-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>(<span class="at">ratio =</span> res<span class="sc">$</span>res4Splus<span class="sc">$</span>eigValues[<span class="dv">4</span>]<span class="sc">/</span>res<span class="sc">$</span>res4Splus<span class="sc">$</span>eigValues[<span class="dv">3</span>]) <span class="sc">+</span></span>
<span id="cb253-7"><a href="#cb253-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(. <span class="sc">~</span> <span class="fu">get_visit_labels</span>(AVISITN)) <span class="sc">+</span></span>
<span id="cb253-8"><a href="#cb253-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">get_arm_colors</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-256-2.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb254"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb254-1"><a href="#cb254-1" aria-hidden="true" tabindex="-1"></a>partial <span class="ot">&lt;-</span> </span>
<span id="cb254-2"><a href="#cb254-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(</span>
<span id="cb254-3"><a href="#cb254-3" aria-hidden="true" tabindex="-1"></a>    res<span class="sc">$</span>res4Splus<span class="sc">$</span>PartialF[,,<span class="dv">1</span>] <span class="sc">|&gt;</span> </span>
<span id="cb254-4"><a href="#cb254-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb254-5"><a href="#cb254-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">table =</span> <span class="st">"Microbiota"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb254-6"><a href="#cb254-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">bind_cols</span>(distances <span class="sc">|&gt;</span> <span class="fu">select</span>(USUBJID, AVISITN, ARM, PIPV)),</span>
<span id="cb254-7"><a href="#cb254-7" aria-hidden="true" tabindex="-1"></a>    res<span class="sc">$</span>res4Splus<span class="sc">$</span>PartialF[,,<span class="dv">2</span>] <span class="sc">|&gt;</span></span>
<span id="cb254-8"><a href="#cb254-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span></span>
<span id="cb254-9"><a href="#cb254-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">table =</span> <span class="st">"Cytokines"</span>) <span class="sc">|&gt;</span></span>
<span id="cb254-10"><a href="#cb254-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">bind_cols</span>(distances <span class="sc">|&gt;</span> <span class="fu">select</span>(USUBJID, AVISITN, ARM, PIPV)),</span>
<span id="cb254-11"><a href="#cb254-11" aria-hidden="true" tabindex="-1"></a>    compromise <span class="sc">|&gt;</span> </span>
<span id="cb254-12"><a href="#cb254-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">table =</span> <span class="st">"compromise"</span>)</span>
<span id="cb254-13"><a href="#cb254-13" aria-hidden="true" tabindex="-1"></a>  )  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb255"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb255-1"><a href="#cb255-1" aria-hidden="true" tabindex="-1"></a>partial <span class="sc">|&gt;</span> </span>
<span id="cb255-2"><a href="#cb255-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(PIPV) <span class="sc">|&gt;</span> </span>
<span id="cb255-3"><a href="#cb255-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Factor 1</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">Factor 2</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb255-4"><a href="#cb255-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"gray80"</span>) <span class="sc">+</span></span>
<span id="cb255-5"><a href="#cb255-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"gray80"</span>) <span class="sc">+</span></span>
<span id="cb255-6"><a href="#cb255-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> USUBJID), <span class="at">col =</span> <span class="st">"gray"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb255-7"><a href="#cb255-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">col =</span> table), <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb255-8"><a href="#cb255-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>(<span class="at">ratio =</span> res<span class="sc">$</span>res4Splus<span class="sc">$</span>eigValues[<span class="dv">2</span>]<span class="sc">/</span>res<span class="sc">$</span>res4Splus<span class="sc">$</span>eigValues[<span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb255-9"><a href="#cb255-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(ARM <span class="sc">~</span> AVISITN <span class="sc">|&gt;</span> <span class="fu">get_visit_labels</span>()) <span class="sc">+</span></span>
<span id="cb255-10"><a href="#cb255-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"steelblue1"</span>, <span class="st">"darkslateblue"</span>, <span class="st">"indianred1"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-258-1.png" class="img-fluid figure-img" width="1440"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb256"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb256-1"><a href="#cb256-1" aria-hidden="true" tabindex="-1"></a>partial <span class="sc">|&gt;</span> </span>
<span id="cb256-2"><a href="#cb256-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(PIPV) <span class="sc">|&gt;</span> </span>
<span id="cb256-3"><a href="#cb256-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Factor 3</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">Factor 4</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb256-4"><a href="#cb256-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"gray80"</span>) <span class="sc">+</span></span>
<span id="cb256-5"><a href="#cb256-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"gray80"</span>) <span class="sc">+</span></span>
<span id="cb256-6"><a href="#cb256-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> USUBJID), <span class="at">col =</span> <span class="st">"gray"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb256-7"><a href="#cb256-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">col =</span> table), <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb256-8"><a href="#cb256-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>(<span class="at">ratio =</span> res<span class="sc">$</span>res4Splus<span class="sc">$</span>eigValues[<span class="dv">4</span>]<span class="sc">/</span>res<span class="sc">$</span>res4Splus<span class="sc">$</span>eigValues[<span class="dv">3</span>]) <span class="sc">+</span></span>
<span id="cb256-9"><a href="#cb256-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(ARM <span class="sc">~</span> AVISITN <span class="sc">|&gt;</span> <span class="fu">get_visit_labels</span>()) <span class="sc">+</span></span>
<span id="cb256-10"><a href="#cb256-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"steelblue1"</span>, <span class="st">"darkslateblue"</span>, <span class="st">"indianred1"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-258-2.png" class="img-fluid figure-img" width="1440"></p>
</figure>
</div>
</div>
</div>
<p>Focus on Visit 2 (week 4) data</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb257"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb257-1"><a href="#cb257-1" aria-hidden="true" tabindex="-1"></a>g_partial_V2 <span class="ot">&lt;-</span> </span>
<span id="cb257-2"><a href="#cb257-2" aria-hidden="true" tabindex="-1"></a>  partial <span class="sc">|&gt;</span> </span>
<span id="cb257-3"><a href="#cb257-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(AVISITN <span class="sc">==</span> <span class="dv">2</span>) <span class="sc">|&gt;</span> </span>
<span id="cb257-4"><a href="#cb257-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Factor 1</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">Factor 2</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb257-5"><a href="#cb257-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"gray80"</span>) <span class="sc">+</span></span>
<span id="cb257-6"><a href="#cb257-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"gray80"</span>) <span class="sc">+</span></span>
<span id="cb257-7"><a href="#cb257-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> USUBJID), <span class="at">col =</span> <span class="st">"gray"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb257-8"><a href="#cb257-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">col =</span> table), <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb257-9"><a href="#cb257-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>(<span class="at">ratio =</span> res<span class="sc">$</span>res4Splus<span class="sc">$</span>eigValues[<span class="dv">2</span>]<span class="sc">/</span>res<span class="sc">$</span>res4Splus<span class="sc">$</span>eigValues[<span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb257-10"><a href="#cb257-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(ARM <span class="sc">~</span> AVISITN <span class="sc">|&gt;</span> <span class="fu">get_visit_labels</span>()) <span class="sc">+</span></span>
<span id="cb257-11"><a href="#cb257-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="st">""</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"gray60"</span>, <span class="st">"darkslateblue"</span>, <span class="st">"indianred1"</span>)) <span class="sc">+</span></span>
<span id="cb257-12"><a href="#cb257-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"DiSTATIS Compromise Component 1"</span>) <span class="sc">+</span></span>
<span id="cb257-13"><a href="#cb257-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Component 2"</span>) <span class="sc">+</span> </span>
<span id="cb257-14"><a href="#cb257-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span>
<span id="cb257-15"><a href="#cb257-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb257-16"><a href="#cb257-16" aria-hidden="true" tabindex="-1"></a>g_partial_V2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-259-1.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb258"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb258-1"><a href="#cb258-1" aria-hidden="true" tabindex="-1"></a>partial <span class="sc">|&gt;</span> </span>
<span id="cb258-2"><a href="#cb258-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(AVISITN <span class="sc">==</span> <span class="dv">2</span>) <span class="sc">|&gt;</span> </span>
<span id="cb258-3"><a href="#cb258-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Factor 1</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">Factor 2</span><span class="st">`</span>, <span class="at">col =</span> USUBJID)) <span class="sc">+</span></span>
<span id="cb258-4"><a href="#cb258-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> USUBJID), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb258-5"><a href="#cb258-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">shape =</span> table)) <span class="sc">+</span></span>
<span id="cb258-6"><a href="#cb258-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>(<span class="at">ratio =</span> res<span class="sc">$</span>res4Splus<span class="sc">$</span>eigValues[<span class="dv">2</span>]<span class="sc">/</span>res<span class="sc">$</span>res4Splus<span class="sc">$</span>eigValues[<span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb258-7"><a href="#cb258-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(ARM <span class="sc">~</span> AVISITN <span class="sc">|&gt;</span> <span class="fu">get_visit_labels</span>()) <span class="sc">+</span></span>
<span id="cb258-8"><a href="#cb258-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">col =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-259-2.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb259"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb259-1"><a href="#cb259-1" aria-hidden="true" tabindex="-1"></a>cor_topics <span class="ot">&lt;-</span> </span>
<span id="cb259-2"><a href="#cb259-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cor</span>(distances<span class="sc">$</span>topics, compromise <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"Factor"</span>))) <span class="sc">|&gt;</span> </span>
<span id="cb259-3"><a href="#cb259-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span> </span>
<span id="cb259-4"><a href="#cb259-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"feature"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb259-5"><a href="#cb259-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() </span>
<span id="cb259-6"><a href="#cb259-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb259-7"><a href="#cb259-7" aria-hidden="true" tabindex="-1"></a>cor_cytokines <span class="ot">&lt;-</span> </span>
<span id="cb259-8"><a href="#cb259-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cor</span>(distances<span class="sc">$</span>cytokines, compromise <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"Factor"</span>))) <span class="sc">|&gt;</span> </span>
<span id="cb259-9"><a href="#cb259-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span> </span>
<span id="cb259-10"><a href="#cb259-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"feature"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb259-11"><a href="#cb259-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() </span>
<span id="cb259-12"><a href="#cb259-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb259-13"><a href="#cb259-13" aria-hidden="true" tabindex="-1"></a>cors <span class="ot">&lt;-</span> </span>
<span id="cb259-14"><a href="#cb259-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(</span>
<span id="cb259-15"><a href="#cb259-15" aria-hidden="true" tabindex="-1"></a>    cor_topics <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">table =</span> <span class="st">"Microbiota topics"</span>),</span>
<span id="cb259-16"><a href="#cb259-16" aria-hidden="true" tabindex="-1"></a>    cor_cytokines <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">table =</span> <span class="st">"cytokines"</span>)</span>
<span id="cb259-17"><a href="#cb259-17" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Correlation circles</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb260"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb260-1"><a href="#cb260-1" aria-hidden="true" tabindex="-1"></a>g_cor_circle_L1_12 <span class="ot">&lt;-</span> </span>
<span id="cb260-2"><a href="#cb260-2" aria-hidden="true" tabindex="-1"></a>  cors <span class="sc">|&gt;</span> </span>
<span id="cb260-3"><a href="#cb260-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Factor 1</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">Factor 2</span><span class="st">`</span>, <span class="at">col =</span> table)) <span class="sc">+</span></span>
<span id="cb260-4"><a href="#cb260-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_circle</span>(<span class="fu">aes</span>(<span class="at">x0 =</span> <span class="dv">0</span>, <span class="at">y0 =</span> <span class="dv">0</span>, <span class="at">r =</span> <span class="dv">1</span>), <span class="at">col =</span> <span class="st">"gray80"</span>, <span class="at">linewidth =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb260-5"><a href="#cb260-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(</span>
<span id="cb260-6"><a href="#cb260-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">xend =</span> <span class="dv">0</span>, <span class="at">yend =</span> <span class="dv">0</span>), </span>
<span id="cb260-7"><a href="#cb260-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">arrow =</span> </span>
<span id="cb260-8"><a href="#cb260-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">arrow</span>(<span class="at">ends =</span> <span class="st">"first"</span>, <span class="at">type =</span> <span class="st">"closed"</span>, <span class="at">angle =</span> <span class="dv">20</span>, <span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.1</span>, <span class="st">"inches"</span>))</span>
<span id="cb260-9"><a href="#cb260-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb260-10"><a href="#cb260-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>(</span>
<span id="cb260-11"><a href="#cb260-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">label =</span> feature), <span class="at">show.legend =</span> <span class="cn">FALSE</span>, <span class="at">max.overlaps =</span> <span class="cn">Inf</span>,</span>
<span id="cb260-12"><a href="#cb260-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">position =</span> ggpp<span class="sc">::</span><span class="fu">position_nudge_center</span>(<span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb260-13"><a href="#cb260-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">segment.linetype =</span> <span class="dv">1</span>, <span class="at">segment.color =</span> <span class="st">"gray70"</span>, <span class="at">min.segment.length =</span> <span class="fl">0.8</span>,</span>
<span id="cb260-14"><a href="#cb260-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">box.padding =</span> <span class="fl">0.3</span></span>
<span id="cb260-15"><a href="#cb260-15" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb260-16"><a href="#cb260-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>() <span class="sc">+</span></span>
<span id="cb260-17"><a href="#cb260-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="st">""</span>, <span class="at">values =</span> block_colors) <span class="sc">+</span></span>
<span id="cb260-18"><a href="#cb260-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="st">"Corr. with DiSTATIS compromise comp. 1"</span>, <span class="at">breaks =</span> <span class="sc">-</span><span class="dv">1</span><span class="sc">:</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb260-19"><a href="#cb260-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">"Corr. with comp. 2"</span>, <span class="at">breaks =</span> <span class="sc">-</span><span class="dv">1</span><span class="sc">:</span><span class="dv">1</span>) </span>
<span id="cb260-20"><a href="#cb260-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-21"><a href="#cb260-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-22"><a href="#cb260-22" aria-hidden="true" tabindex="-1"></a>g_cor_circle_L1_34 <span class="ot">&lt;-</span> </span>
<span id="cb260-23"><a href="#cb260-23" aria-hidden="true" tabindex="-1"></a>  cors <span class="sc">|&gt;</span> </span>
<span id="cb260-24"><a href="#cb260-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Factor 3</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">Factor 4</span><span class="st">`</span>, <span class="at">col =</span> table)) <span class="sc">+</span></span>
<span id="cb260-25"><a href="#cb260-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_circle</span>(<span class="fu">aes</span>(<span class="at">x0 =</span> <span class="dv">0</span>, <span class="at">y0 =</span> <span class="dv">0</span>, <span class="at">r =</span> <span class="dv">1</span>), <span class="at">col =</span> <span class="st">"gray80"</span>, <span class="at">linewidth =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb260-26"><a href="#cb260-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(</span>
<span id="cb260-27"><a href="#cb260-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">xend =</span> <span class="dv">0</span>, <span class="at">yend =</span> <span class="dv">0</span>), </span>
<span id="cb260-28"><a href="#cb260-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">arrow =</span> </span>
<span id="cb260-29"><a href="#cb260-29" aria-hidden="true" tabindex="-1"></a>      <span class="fu">arrow</span>(<span class="at">ends =</span> <span class="st">"first"</span>, <span class="at">type =</span> <span class="st">"closed"</span>, <span class="at">angle =</span> <span class="dv">20</span>, <span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.1</span>, <span class="st">"inches"</span>))</span>
<span id="cb260-30"><a href="#cb260-30" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb260-31"><a href="#cb260-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>(</span>
<span id="cb260-32"><a href="#cb260-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">label =</span> feature), <span class="at">show.legend =</span> <span class="cn">FALSE</span>,</span>
<span id="cb260-33"><a href="#cb260-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">position =</span> ggpp<span class="sc">::</span><span class="fu">position_nudge_center</span>(<span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb260-34"><a href="#cb260-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">segment.linetype =</span> <span class="dv">1</span>, <span class="at">segment.color =</span> <span class="st">"gray70"</span>, <span class="at">min.segment.length =</span> <span class="fl">0.8</span>,</span>
<span id="cb260-35"><a href="#cb260-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">box.padding =</span> <span class="fl">0.3</span>, <span class="at">max.overlaps =</span> <span class="dv">3</span></span>
<span id="cb260-36"><a href="#cb260-36" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb260-37"><a href="#cb260-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>() <span class="sc">+</span></span>
<span id="cb260-38"><a href="#cb260-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="st">""</span>, <span class="at">values =</span> block_colors)  <span class="sc">+</span></span>
<span id="cb260-39"><a href="#cb260-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="st">"Corr. with DiSTATIS compromise comp. 3"</span>, <span class="at">breaks =</span> <span class="sc">-</span><span class="dv">1</span><span class="sc">:</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb260-40"><a href="#cb260-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">"Corr. with comp. 4"</span>, <span class="at">breaks =</span> <span class="sc">-</span><span class="dv">1</span><span class="sc">:</span><span class="dv">1</span>) </span>
<span id="cb260-41"><a href="#cb260-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-42"><a href="#cb260-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-43"><a href="#cb260-43" aria-hidden="true" tabindex="-1"></a>g_cor_circle_L1_12 <span class="sc">+</span> g_cor_circle_L1_34 <span class="sc">+</span></span>
<span id="cb260-44"><a href="#cb260-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-45"><a href="#cb260-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">"collect"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-261-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb261"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb261-1"><a href="#cb261-1" aria-hidden="true" tabindex="-1"></a>g_distatis <span class="ot">&lt;-</span> </span>
<span id="cb261-2"><a href="#cb261-2" aria-hidden="true" tabindex="-1"></a>  g_cor_circle_L1_12 <span class="sc">+</span> </span>
<span id="cb261-3"><a href="#cb261-3" aria-hidden="true" tabindex="-1"></a>  patchwork<span class="sc">::</span><span class="fu">inset_element</span>(</span>
<span id="cb261-4"><a href="#cb261-4" aria-hidden="true" tabindex="-1"></a>    g_eig <span class="sc">+</span> </span>
<span id="cb261-5"><a href="#cb261-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(</span>
<span id="cb261-6"><a href="#cb261-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"white"</span>, <span class="at">color =</span> <span class="st">"white"</span>),</span>
<span id="cb261-7"><a href="#cb261-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">0</span>, <span class="at">l =</span> <span class="dv">2</span>, <span class="at">r =</span> <span class="dv">1</span>, <span class="at">b =</span> <span class="dv">10</span>, <span class="at">unit =</span> <span class="st">"pt"</span>),</span>
<span id="cb261-8"><a href="#cb261-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>()</span>
<span id="cb261-9"><a href="#cb261-9" aria-hidden="true" tabindex="-1"></a>      ), </span>
<span id="cb261-10"><a href="#cb261-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">left =</span> <span class="dv">0</span>, <span class="at">bottom =</span> <span class="fl">0.65</span>, <span class="at">right =</span> <span class="fl">0.4</span>, <span class="at">top =</span> <span class="dv">1</span>, <span class="at">align_to =</span> <span class="st">"plot"</span>, <span class="at">ignore_tag =</span> <span class="cn">TRUE</span></span>
<span id="cb261-11"><a href="#cb261-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb261-12"><a href="#cb261-12" aria-hidden="true" tabindex="-1"></a>  g_cor_circle_L1_34 <span class="sc">+</span></span>
<span id="cb261-13"><a href="#cb261-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">"collect"</span>, <span class="at">ncol =</span> <span class="dv">1</span>) </span>
<span id="cb261-14"><a href="#cb261-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb261-15"><a href="#cb261-15" aria-hidden="true" tabindex="-1"></a><span class="co"># g_distatis</span></span>
<span id="cb261-16"><a href="#cb261-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb261-17"><a href="#cb261-17" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(g_distatis, <span class="at">file =</span> <span class="fu">str_c</span>(<span class="fu">data_dir</span>(), <span class="st">"05_figures_tables/fig_3b.Rdata"</span>))</span>
<span id="cb261-18"><a href="#cb261-18" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(g_eig, g_cor_circle_L1_12, g_cor_circle_L1_34, <span class="at">file =</span> <span class="fu">str_c</span>(<span class="fu">data_dir</span>(), <span class="st">"05_figures_tables/fig_3b_panels.Rdata"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="overall-bc-l1" class="level4" data-number="2.1.2.3">
<h4 data-number="2.1.2.3" class="anchored" data-anchor-id="overall-bc-l1"><span class="header-section-number">2.1.2.3</span> Overall (BC &amp; L1)</h4>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb262"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb262-1"><a href="#cb262-1" aria-hidden="true" tabindex="-1"></a>distances <span class="ot">&lt;-</span> </span>
<span id="cb262-2"><a href="#cb262-2" aria-hidden="true" tabindex="-1"></a>  combined <span class="sc">|&gt;</span> </span>
<span id="cb262-3"><a href="#cb262-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb262-4"><a href="#cb262-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">mb_distances =</span> vegan<span class="sc">::</span><span class="fu">vegdist</span>(rel_ab, <span class="at">method =</span> <span class="st">"bray"</span>) <span class="sc">|&gt;</span> <span class="fu">as.matrix</span>(),</span>
<span id="cb262-5"><a href="#cb262-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">cytokine_distances =</span> <span class="fu">dist</span>(cytokines, <span class="at">method =</span> <span class="st">"manhattan"</span>) <span class="sc">|&gt;</span> <span class="fu">as.matrix</span>()</span>
<span id="cb262-6"><a href="#cb262-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb262-7"><a href="#cb262-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb262-8"><a href="#cb262-8" aria-hidden="true" tabindex="-1"></a>dist_cube <span class="ot">&lt;-</span> </span>
<span id="cb262-9"><a href="#cb262-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">array</span>(</span>
<span id="cb262-10"><a href="#cb262-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(</span>
<span id="cb262-11"><a href="#cb262-11" aria-hidden="true" tabindex="-1"></a>      distances<span class="sc">$</span>mb_distances, </span>
<span id="cb262-12"><a href="#cb262-12" aria-hidden="true" tabindex="-1"></a>      distances<span class="sc">$</span>cytokine_distances</span>
<span id="cb262-13"><a href="#cb262-13" aria-hidden="true" tabindex="-1"></a>    ), </span>
<span id="cb262-14"><a href="#cb262-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">nrow</span>(distances), <span class="fu">nrow</span>(distances), <span class="dv">2</span>)</span>
<span id="cb262-15"><a href="#cb262-15" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb262-16"><a href="#cb262-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb262-17"><a href="#cb262-17" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">distatis</span>(dist_cube, <span class="at">nfact =</span> <span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb263"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb263-1"><a href="#cb263-1" aria-hidden="true" tabindex="-1"></a>res<span class="sc">$</span>res4Cmat<span class="sc">$</span>C <span class="co"># RV equivalent</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>          [,1]      [,2]
[1,] 1.0000000 0.2131058
[2,] 0.2131058 1.0000000</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb265"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb265-1"><a href="#cb265-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compute_RV(distances$topic_distances, distances$cytokine_distances)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb266"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb266-1"><a href="#cb266-1" aria-hidden="true" tabindex="-1"></a>res<span class="sc">$</span>res4Cmat<span class="sc">$</span>eigValues</span>
<span id="cb266-2"><a href="#cb266-2" aria-hidden="true" tabindex="-1"></a>res<span class="sc">$</span>res4Cmat<span class="sc">$</span>eigValues<span class="sc">/</span><span class="fu">sum</span>(res<span class="sc">$</span>res4Cmat<span class="sc">$</span>eigValues)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb267"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb267-1"><a href="#cb267-1" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> </span>
<span id="cb267-2"><a href="#cb267-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">eig =</span> res<span class="sc">$</span>res4Splus<span class="sc">$</span>eigValues) <span class="sc">|&gt;</span> </span>
<span id="cb267-3"><a href="#cb267-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n =</span> <span class="fu">row_number</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb267-4"><a href="#cb267-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> n, <span class="at">y =</span> eig)) <span class="sc">+</span></span>
<span id="cb267-5"><a href="#cb267-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>()</span>
<span id="cb267-6"><a href="#cb267-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb267-7"><a href="#cb267-7" aria-hidden="true" tabindex="-1"></a>g <span class="sc">+</span> </span>
<span id="cb267-8"><a href="#cb267-8" aria-hidden="true" tabindex="-1"></a>  patchwork<span class="sc">::</span><span class="fu">inset_element</span>(</span>
<span id="cb267-9"><a href="#cb267-9" aria-hidden="true" tabindex="-1"></a>    g <span class="sc">+</span> <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">21</span>)),</span>
<span id="cb267-10"><a href="#cb267-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">left =</span> <span class="fl">0.2</span>, <span class="at">bottom =</span> <span class="fl">0.25</span>, <span class="at">right =</span> <span class="dv">1</span>, <span class="at">top =</span> <span class="dv">1</span>, <span class="at">align_to =</span> <span class="st">"plot"</span>, <span class="at">ignore_tag =</span> <span class="cn">TRUE</span></span>
<span id="cb267-11"><a href="#cb267-11" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-266-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb268"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb268-1"><a href="#cb268-1" aria-hidden="true" tabindex="-1"></a>compromise <span class="ot">&lt;-</span> </span>
<span id="cb268-2"><a href="#cb268-2" aria-hidden="true" tabindex="-1"></a>  res<span class="sc">$</span>res4Splus<span class="sc">$</span>F <span class="sc">|&gt;</span> </span>
<span id="cb268-3"><a href="#cb268-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb268-4"><a href="#cb268-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(distances <span class="sc">|&gt;</span> <span class="fu">select</span>(USUBJID, AVISITN, ARM, PIPV))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb269"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb269-1"><a href="#cb269-1" aria-hidden="true" tabindex="-1"></a>g_compromise_per_visit <span class="ot">&lt;-</span> </span>
<span id="cb269-2"><a href="#cb269-2" aria-hidden="true" tabindex="-1"></a>  compromise <span class="sc">|&gt;</span> </span>
<span id="cb269-3"><a href="#cb269-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(PIPV) <span class="sc">|&gt;</span> </span>
<span id="cb269-4"><a href="#cb269-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Factor 1</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">Factor 2</span><span class="st">`</span>, <span class="at">col =</span> ARM)) <span class="sc">+</span></span>
<span id="cb269-5"><a href="#cb269-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"gray"</span>) <span class="sc">+</span></span>
<span id="cb269-6"><a href="#cb269-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"gray"</span>) <span class="sc">+</span></span>
<span id="cb269-7"><a href="#cb269-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb269-8"><a href="#cb269-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_ellipse</span>() <span class="sc">+</span></span>
<span id="cb269-9"><a href="#cb269-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>(<span class="at">ratio =</span> res<span class="sc">$</span>res4Splus<span class="sc">$</span>eigValues[<span class="dv">2</span>]<span class="sc">/</span>res<span class="sc">$</span>res4Splus<span class="sc">$</span>eigValues[<span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb269-10"><a href="#cb269-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(. <span class="sc">~</span> <span class="fu">get_visit_labels</span>(AVISITN)) <span class="sc">+</span></span>
<span id="cb269-11"><a href="#cb269-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="st">"Intervention Arm"</span>, <span class="at">values =</span> <span class="fu">get_arm_colors</span>()) <span class="sc">+</span></span>
<span id="cb269-12"><a href="#cb269-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"DiSTATIS Compromise Component 1"</span>) <span class="sc">+</span></span>
<span id="cb269-13"><a href="#cb269-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Component 2"</span>) <span class="sc">+</span> </span>
<span id="cb269-14"><a href="#cb269-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span>
<span id="cb269-15"><a href="#cb269-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb269-16"><a href="#cb269-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb269-17"><a href="#cb269-17" aria-hidden="true" tabindex="-1"></a>g_compromise_per_visit</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-268-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb270"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb270-1"><a href="#cb270-1" aria-hidden="true" tabindex="-1"></a>compromise <span class="sc">|&gt;</span> </span>
<span id="cb270-2"><a href="#cb270-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(PIPV) <span class="sc">|&gt;</span> </span>
<span id="cb270-3"><a href="#cb270-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Factor 3</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">Factor 4</span><span class="st">`</span>, <span class="at">col =</span> ARM)) <span class="sc">+</span></span>
<span id="cb270-4"><a href="#cb270-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb270-5"><a href="#cb270-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_ellipse</span>() <span class="sc">+</span></span>
<span id="cb270-6"><a href="#cb270-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>(<span class="at">ratio =</span> res<span class="sc">$</span>res4Splus<span class="sc">$</span>eigValues[<span class="dv">4</span>]<span class="sc">/</span>res<span class="sc">$</span>res4Splus<span class="sc">$</span>eigValues[<span class="dv">3</span>]) <span class="sc">+</span></span>
<span id="cb270-7"><a href="#cb270-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(. <span class="sc">~</span> <span class="fu">get_visit_labels</span>(AVISITN)) <span class="sc">+</span></span>
<span id="cb270-8"><a href="#cb270-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">get_arm_colors</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-268-2.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb271"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb271-1"><a href="#cb271-1" aria-hidden="true" tabindex="-1"></a>partial <span class="ot">&lt;-</span> </span>
<span id="cb271-2"><a href="#cb271-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(</span>
<span id="cb271-3"><a href="#cb271-3" aria-hidden="true" tabindex="-1"></a>    res<span class="sc">$</span>res4Splus<span class="sc">$</span>PartialF[,,<span class="dv">1</span>] <span class="sc">|&gt;</span> </span>
<span id="cb271-4"><a href="#cb271-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb271-5"><a href="#cb271-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">table =</span> <span class="st">"Microbiota"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb271-6"><a href="#cb271-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">bind_cols</span>(distances <span class="sc">|&gt;</span> <span class="fu">select</span>(USUBJID, AVISITN, ARM, PIPV)),</span>
<span id="cb271-7"><a href="#cb271-7" aria-hidden="true" tabindex="-1"></a>    res<span class="sc">$</span>res4Splus<span class="sc">$</span>PartialF[,,<span class="dv">2</span>] <span class="sc">|&gt;</span></span>
<span id="cb271-8"><a href="#cb271-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span></span>
<span id="cb271-9"><a href="#cb271-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">table =</span> <span class="st">"Cytokines"</span>) <span class="sc">|&gt;</span></span>
<span id="cb271-10"><a href="#cb271-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">bind_cols</span>(distances <span class="sc">|&gt;</span> <span class="fu">select</span>(USUBJID, AVISITN, ARM, PIPV)),</span>
<span id="cb271-11"><a href="#cb271-11" aria-hidden="true" tabindex="-1"></a>    compromise <span class="sc">|&gt;</span> </span>
<span id="cb271-12"><a href="#cb271-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">table =</span> <span class="st">"compromise"</span>)</span>
<span id="cb271-13"><a href="#cb271-13" aria-hidden="true" tabindex="-1"></a>  )  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb272"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb272-1"><a href="#cb272-1" aria-hidden="true" tabindex="-1"></a>partial <span class="sc">|&gt;</span> </span>
<span id="cb272-2"><a href="#cb272-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(PIPV) <span class="sc">|&gt;</span> </span>
<span id="cb272-3"><a href="#cb272-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Factor 1</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">Factor 2</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb272-4"><a href="#cb272-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"gray80"</span>) <span class="sc">+</span></span>
<span id="cb272-5"><a href="#cb272-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"gray80"</span>) <span class="sc">+</span></span>
<span id="cb272-6"><a href="#cb272-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> USUBJID), <span class="at">col =</span> <span class="st">"gray"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb272-7"><a href="#cb272-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">col =</span> table), <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb272-8"><a href="#cb272-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>(<span class="at">ratio =</span> res<span class="sc">$</span>res4Splus<span class="sc">$</span>eigValues[<span class="dv">2</span>]<span class="sc">/</span>res<span class="sc">$</span>res4Splus<span class="sc">$</span>eigValues[<span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb272-9"><a href="#cb272-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(ARM <span class="sc">~</span> AVISITN <span class="sc">|&gt;</span> <span class="fu">get_visit_labels</span>()) <span class="sc">+</span></span>
<span id="cb272-10"><a href="#cb272-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"steelblue1"</span>, <span class="st">"darkslateblue"</span>, <span class="st">"indianred1"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-270-1.png" class="img-fluid figure-img" width="1440"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb273"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb273-1"><a href="#cb273-1" aria-hidden="true" tabindex="-1"></a>partial <span class="sc">|&gt;</span> </span>
<span id="cb273-2"><a href="#cb273-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(PIPV) <span class="sc">|&gt;</span> </span>
<span id="cb273-3"><a href="#cb273-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Factor 3</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">Factor 4</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb273-4"><a href="#cb273-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"gray80"</span>) <span class="sc">+</span></span>
<span id="cb273-5"><a href="#cb273-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"gray80"</span>) <span class="sc">+</span></span>
<span id="cb273-6"><a href="#cb273-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> USUBJID), <span class="at">col =</span> <span class="st">"gray"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb273-7"><a href="#cb273-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">col =</span> table), <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb273-8"><a href="#cb273-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>(<span class="at">ratio =</span> res<span class="sc">$</span>res4Splus<span class="sc">$</span>eigValues[<span class="dv">4</span>]<span class="sc">/</span>res<span class="sc">$</span>res4Splus<span class="sc">$</span>eigValues[<span class="dv">3</span>]) <span class="sc">+</span></span>
<span id="cb273-9"><a href="#cb273-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(ARM <span class="sc">~</span> AVISITN <span class="sc">|&gt;</span> <span class="fu">get_visit_labels</span>()) <span class="sc">+</span></span>
<span id="cb273-10"><a href="#cb273-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"steelblue1"</span>, <span class="st">"darkslateblue"</span>, <span class="st">"indianred1"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-270-2.png" class="img-fluid figure-img" width="1440"></p>
</figure>
</div>
</div>
</div>
<p>Focus on Visit 2 (week 4) data</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb274"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb274-1"><a href="#cb274-1" aria-hidden="true" tabindex="-1"></a>g_partial_V2 <span class="ot">&lt;-</span> </span>
<span id="cb274-2"><a href="#cb274-2" aria-hidden="true" tabindex="-1"></a>  partial <span class="sc">|&gt;</span> </span>
<span id="cb274-3"><a href="#cb274-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(AVISITN <span class="sc">==</span> <span class="dv">2</span>) <span class="sc">|&gt;</span> </span>
<span id="cb274-4"><a href="#cb274-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Factor 1</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">Factor 2</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb274-5"><a href="#cb274-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"gray80"</span>) <span class="sc">+</span></span>
<span id="cb274-6"><a href="#cb274-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"gray80"</span>) <span class="sc">+</span></span>
<span id="cb274-7"><a href="#cb274-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> USUBJID), <span class="at">col =</span> <span class="st">"gray"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb274-8"><a href="#cb274-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">col =</span> table), <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb274-9"><a href="#cb274-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>(<span class="at">ratio =</span> res<span class="sc">$</span>res4Splus<span class="sc">$</span>eigValues[<span class="dv">2</span>]<span class="sc">/</span>res<span class="sc">$</span>res4Splus<span class="sc">$</span>eigValues[<span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb274-10"><a href="#cb274-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(ARM <span class="sc">~</span> AVISITN <span class="sc">|&gt;</span> <span class="fu">get_visit_labels</span>()) <span class="sc">+</span></span>
<span id="cb274-11"><a href="#cb274-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="st">""</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"gray60"</span>, <span class="st">"darkslateblue"</span>, <span class="st">"indianred1"</span>)) <span class="sc">+</span></span>
<span id="cb274-12"><a href="#cb274-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"DiSTATIS Compromise Component 1"</span>) <span class="sc">+</span></span>
<span id="cb274-13"><a href="#cb274-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Component 2"</span>) <span class="sc">+</span> </span>
<span id="cb274-14"><a href="#cb274-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span>
<span id="cb274-15"><a href="#cb274-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb274-16"><a href="#cb274-16" aria-hidden="true" tabindex="-1"></a>g_partial_V2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-271-1.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb275"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb275-1"><a href="#cb275-1" aria-hidden="true" tabindex="-1"></a>partial <span class="sc">|&gt;</span> </span>
<span id="cb275-2"><a href="#cb275-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(AVISITN <span class="sc">==</span> <span class="dv">2</span>) <span class="sc">|&gt;</span> </span>
<span id="cb275-3"><a href="#cb275-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Factor 1</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">Factor 2</span><span class="st">`</span>, <span class="at">col =</span> USUBJID)) <span class="sc">+</span></span>
<span id="cb275-4"><a href="#cb275-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> USUBJID), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb275-5"><a href="#cb275-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">shape =</span> table)) <span class="sc">+</span></span>
<span id="cb275-6"><a href="#cb275-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>(<span class="at">ratio =</span> res<span class="sc">$</span>res4Splus<span class="sc">$</span>eigValues[<span class="dv">2</span>]<span class="sc">/</span>res<span class="sc">$</span>res4Splus<span class="sc">$</span>eigValues[<span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb275-7"><a href="#cb275-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(ARM <span class="sc">~</span> AVISITN <span class="sc">|&gt;</span> <span class="fu">get_visit_labels</span>()) <span class="sc">+</span></span>
<span id="cb275-8"><a href="#cb275-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">col =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-271-2.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb276"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb276-1"><a href="#cb276-1" aria-hidden="true" tabindex="-1"></a>cor_topics <span class="ot">&lt;-</span> </span>
<span id="cb276-2"><a href="#cb276-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cor</span>(distances<span class="sc">$</span>topics, compromise <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"Factor"</span>))) <span class="sc">|&gt;</span> </span>
<span id="cb276-3"><a href="#cb276-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span> </span>
<span id="cb276-4"><a href="#cb276-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"feature"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb276-5"><a href="#cb276-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() </span>
<span id="cb276-6"><a href="#cb276-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb276-7"><a href="#cb276-7" aria-hidden="true" tabindex="-1"></a>cor_cytokines <span class="ot">&lt;-</span> </span>
<span id="cb276-8"><a href="#cb276-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cor</span>(distances<span class="sc">$</span>cytokines, compromise <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"Factor"</span>))) <span class="sc">|&gt;</span> </span>
<span id="cb276-9"><a href="#cb276-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span> </span>
<span id="cb276-10"><a href="#cb276-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"feature"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb276-11"><a href="#cb276-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() </span>
<span id="cb276-12"><a href="#cb276-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb276-13"><a href="#cb276-13" aria-hidden="true" tabindex="-1"></a>cors <span class="ot">&lt;-</span> </span>
<span id="cb276-14"><a href="#cb276-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(</span>
<span id="cb276-15"><a href="#cb276-15" aria-hidden="true" tabindex="-1"></a>    cor_topics <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">table =</span> <span class="st">"Microbiota</span><span class="sc">\n</span><span class="st">sub-communities"</span>),</span>
<span id="cb276-16"><a href="#cb276-16" aria-hidden="true" tabindex="-1"></a>    cor_cytokines <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">table =</span> <span class="st">"cytokines"</span>)</span>
<span id="cb276-17"><a href="#cb276-17" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Correlation circles</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb277"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb277-1"><a href="#cb277-1" aria-hidden="true" tabindex="-1"></a>plot_distatis_corr_circle <span class="ot">&lt;-</span> <span class="cf">function</span>(cors, <span class="at">axes =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>){</span>
<span id="cb277-2"><a href="#cb277-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb277-3"><a href="#cb277-3" aria-hidden="true" tabindex="-1"></a>  cors<span class="sc">$</span>x <span class="ot">&lt;-</span> cors[, <span class="fu">str_c</span>(<span class="st">"Factor "</span>, axes[<span class="dv">1</span>])] <span class="sc">|&gt;</span> <span class="fu">unlist</span>()</span>
<span id="cb277-4"><a href="#cb277-4" aria-hidden="true" tabindex="-1"></a>  cors<span class="sc">$</span>y <span class="ot">&lt;-</span> cors[, <span class="fu">str_c</span>(<span class="st">"Factor "</span>, axes[<span class="dv">2</span>])] <span class="sc">|&gt;</span> <span class="fu">unlist</span>()</span>
<span id="cb277-5"><a href="#cb277-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb277-6"><a href="#cb277-6" aria-hidden="true" tabindex="-1"></a>  cors <span class="sc">|&gt;</span> </span>
<span id="cb277-7"><a href="#cb277-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">col =</span> table)) <span class="sc">+</span></span>
<span id="cb277-8"><a href="#cb277-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_circle</span>(<span class="fu">aes</span>(<span class="at">x0 =</span> <span class="dv">0</span>, <span class="at">y0 =</span> <span class="dv">0</span>, <span class="at">r =</span> <span class="dv">1</span>), <span class="at">col =</span> <span class="st">"gray80"</span>, <span class="at">linewidth =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb277-9"><a href="#cb277-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(</span>
<span id="cb277-10"><a href="#cb277-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">xend =</span> <span class="dv">0</span>, <span class="at">yend =</span> <span class="dv">0</span>), </span>
<span id="cb277-11"><a href="#cb277-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">arrow =</span> </span>
<span id="cb277-12"><a href="#cb277-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">arrow</span>(<span class="at">ends =</span> <span class="st">"first"</span>, <span class="at">type =</span> <span class="st">"closed"</span>, <span class="at">angle =</span> <span class="dv">20</span>, <span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.1</span>, <span class="st">"inches"</span>))</span>
<span id="cb277-13"><a href="#cb277-13" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb277-14"><a href="#cb277-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>(</span>
<span id="cb277-15"><a href="#cb277-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">label =</span> feature), <span class="at">show.legend =</span> <span class="cn">FALSE</span>,</span>
<span id="cb277-16"><a href="#cb277-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">position =</span> ggpp<span class="sc">::</span><span class="fu">position_nudge_center</span>(<span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb277-17"><a href="#cb277-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">segment.linetype =</span> <span class="dv">1</span>, <span class="at">segment.color =</span> <span class="st">"gray70"</span>, <span class="at">min.segment.length =</span> <span class="fl">0.8</span></span>
<span id="cb277-18"><a href="#cb277-18" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb277-19"><a href="#cb277-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>() <span class="sc">+</span></span>
<span id="cb277-20"><a href="#cb277-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="st">""</span>, <span class="at">values =</span> block_colors) <span class="sc">+</span></span>
<span id="cb277-21"><a href="#cb277-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="fu">str_c</span>(<span class="st">"DiSTATIS compromise comp. "</span>, axes[<span class="dv">1</span>])) <span class="sc">+</span></span>
<span id="cb277-22"><a href="#cb277-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="fu">str_c</span>(<span class="st">"comp. "</span>, axes[<span class="dv">2</span>]))</span>
<span id="cb277-23"><a href="#cb277-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb277-24"><a href="#cb277-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb277-25"><a href="#cb277-25" aria-hidden="true" tabindex="-1"></a>g_cor_circle_L1_12 <span class="ot">&lt;-</span> <span class="fu">plot_distatis_corr_circle</span>(cors, <span class="at">axes =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)</span>
<span id="cb277-26"><a href="#cb277-26" aria-hidden="true" tabindex="-1"></a>g_cor_circle_L1_34 <span class="ot">&lt;-</span> <span class="fu">plot_distatis_corr_circle</span>(cors, <span class="at">axes =</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>)</span>
<span id="cb277-27"><a href="#cb277-27" aria-hidden="true" tabindex="-1"></a>g_cor_circle_L1_56 <span class="ot">&lt;-</span> <span class="fu">plot_distatis_corr_circle</span>(cors, <span class="at">axes =</span> <span class="dv">5</span><span class="sc">:</span><span class="dv">6</span>)</span>
<span id="cb277-28"><a href="#cb277-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb277-29"><a href="#cb277-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb277-30"><a href="#cb277-30" aria-hidden="true" tabindex="-1"></a>g_cor_circle_L1_12 <span class="sc">+</span> g_cor_circle_L1_34 <span class="sc">+</span> <span class="co"># g_cor_circle_L1_56 +</span></span>
<span id="cb277-31"><a href="#cb277-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">"collect"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-273-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="overall-bc-l2---excluding-post-mtz-visit" class="level4" data-number="2.1.2.4">
<h4 data-number="2.1.2.4" class="anchored" data-anchor-id="overall-bc-l2---excluding-post-mtz-visit"><span class="header-section-number">2.1.2.4</span> Overall (BC &amp; L2) - Excluding post-MTZ visit</h4>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb278"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb278-1"><a href="#cb278-1" aria-hidden="true" tabindex="-1"></a>distances <span class="ot">&lt;-</span> </span>
<span id="cb278-2"><a href="#cb278-2" aria-hidden="true" tabindex="-1"></a>  combined <span class="sc">|&gt;</span> </span>
<span id="cb278-3"><a href="#cb278-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(AVISITN <span class="sc">!=</span> <span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb278-4"><a href="#cb278-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb278-5"><a href="#cb278-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">mb_distances =</span> vegan<span class="sc">::</span><span class="fu">vegdist</span>(rel_ab, <span class="at">method =</span> <span class="st">"bray"</span>) <span class="sc">|&gt;</span> <span class="fu">as.matrix</span>(),</span>
<span id="cb278-6"><a href="#cb278-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">cytokine_distances =</span> <span class="fu">dist</span>(cytokines, <span class="at">method =</span> <span class="st">"euclidean"</span>) <span class="sc">|&gt;</span> <span class="fu">as.matrix</span>()</span>
<span id="cb278-7"><a href="#cb278-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb278-8"><a href="#cb278-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb278-9"><a href="#cb278-9" aria-hidden="true" tabindex="-1"></a>dist_cube <span class="ot">&lt;-</span> </span>
<span id="cb278-10"><a href="#cb278-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">array</span>(</span>
<span id="cb278-11"><a href="#cb278-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(</span>
<span id="cb278-12"><a href="#cb278-12" aria-hidden="true" tabindex="-1"></a>      distances<span class="sc">$</span>mb_distances, </span>
<span id="cb278-13"><a href="#cb278-13" aria-hidden="true" tabindex="-1"></a>      distances<span class="sc">$</span>cytokine_distances</span>
<span id="cb278-14"><a href="#cb278-14" aria-hidden="true" tabindex="-1"></a>    ), </span>
<span id="cb278-15"><a href="#cb278-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">nrow</span>(distances), <span class="fu">nrow</span>(distances), <span class="dv">2</span>)</span>
<span id="cb278-16"><a href="#cb278-16" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb278-17"><a href="#cb278-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb278-18"><a href="#cb278-18" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">distatis</span>(dist_cube, <span class="at">nfact =</span> <span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb279"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb279-1"><a href="#cb279-1" aria-hidden="true" tabindex="-1"></a>res<span class="sc">$</span>res4Cmat<span class="sc">$</span>C <span class="co"># RV equivalent</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>          [,1]      [,2]
[1,] 1.0000000 0.2674998
[2,] 0.2674998 1.0000000</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb281"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb281-1"><a href="#cb281-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compute_RV(distances$topic_distances, distances$cytokine_distances)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb282"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb282-1"><a href="#cb282-1" aria-hidden="true" tabindex="-1"></a>res<span class="sc">$</span>res4Cmat<span class="sc">$</span>eigValues</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    dim 1     dim 2 
1.2674998 0.7325002 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb284"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb284-1"><a href="#cb284-1" aria-hidden="true" tabindex="-1"></a>res<span class="sc">$</span>res4Cmat<span class="sc">$</span>eigValues<span class="sc">/</span><span class="fu">sum</span>(res<span class="sc">$</span>res4Cmat<span class="sc">$</span>eigValues)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    dim 1     dim 2 
0.6337499 0.3662501 </code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb286"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb286-1"><a href="#cb286-1" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> </span>
<span id="cb286-2"><a href="#cb286-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">eig =</span> res<span class="sc">$</span>res4Splus<span class="sc">$</span>eigValues) <span class="sc">|&gt;</span> </span>
<span id="cb286-3"><a href="#cb286-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n =</span> <span class="fu">row_number</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb286-4"><a href="#cb286-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> n, <span class="at">y =</span> eig)) <span class="sc">+</span></span>
<span id="cb286-5"><a href="#cb286-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>()</span>
<span id="cb286-6"><a href="#cb286-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-7"><a href="#cb286-7" aria-hidden="true" tabindex="-1"></a>g</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-277-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb287"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb287-1"><a href="#cb287-1" aria-hidden="true" tabindex="-1"></a>g <span class="sc">+</span> <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">21</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-277-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb288"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb288-1"><a href="#cb288-1" aria-hidden="true" tabindex="-1"></a>compromise <span class="ot">&lt;-</span> </span>
<span id="cb288-2"><a href="#cb288-2" aria-hidden="true" tabindex="-1"></a>  res<span class="sc">$</span>res4Splus<span class="sc">$</span>F <span class="sc">|&gt;</span> </span>
<span id="cb288-3"><a href="#cb288-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb288-4"><a href="#cb288-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(distances <span class="sc">|&gt;</span> <span class="fu">select</span>(USUBJID, AVISITN, ARM, PIPV))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb289"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb289-1"><a href="#cb289-1" aria-hidden="true" tabindex="-1"></a>compromise <span class="sc">|&gt;</span> </span>
<span id="cb289-2"><a href="#cb289-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(PIPV) <span class="sc">|&gt;</span> </span>
<span id="cb289-3"><a href="#cb289-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Factor 1</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">Factor 2</span><span class="st">`</span>, <span class="at">col =</span> ARM)) <span class="sc">+</span></span>
<span id="cb289-4"><a href="#cb289-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"gray"</span>) <span class="sc">+</span></span>
<span id="cb289-5"><a href="#cb289-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"gray"</span>) <span class="sc">+</span></span>
<span id="cb289-6"><a href="#cb289-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb289-7"><a href="#cb289-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_ellipse</span>() <span class="sc">+</span></span>
<span id="cb289-8"><a href="#cb289-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>(<span class="at">ratio =</span> res<span class="sc">$</span>res4Splus<span class="sc">$</span>eigValues[<span class="dv">2</span>]<span class="sc">/</span>res<span class="sc">$</span>res4Splus<span class="sc">$</span>eigValues[<span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb289-9"><a href="#cb289-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(. <span class="sc">~</span> <span class="fu">get_visit_labels</span>(AVISITN)) <span class="sc">+</span></span>
<span id="cb289-10"><a href="#cb289-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="st">"Intervention Arm"</span>, <span class="at">values =</span> <span class="fu">get_arm_colors</span>()) <span class="sc">+</span></span>
<span id="cb289-11"><a href="#cb289-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"DiSTATIS Compromise Component 1"</span>) <span class="sc">+</span></span>
<span id="cb289-12"><a href="#cb289-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Component 2"</span>) <span class="sc">+</span> </span>
<span id="cb289-13"><a href="#cb289-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-279-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb290"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb290-1"><a href="#cb290-1" aria-hidden="true" tabindex="-1"></a>compromise <span class="sc">|&gt;</span> </span>
<span id="cb290-2"><a href="#cb290-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(PIPV) <span class="sc">|&gt;</span> </span>
<span id="cb290-3"><a href="#cb290-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Factor 3</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">Factor 4</span><span class="st">`</span>, <span class="at">col =</span> ARM)) <span class="sc">+</span></span>
<span id="cb290-4"><a href="#cb290-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb290-5"><a href="#cb290-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_ellipse</span>() <span class="sc">+</span></span>
<span id="cb290-6"><a href="#cb290-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>(<span class="at">ratio =</span> res<span class="sc">$</span>res4Splus<span class="sc">$</span>eigValues[<span class="dv">4</span>]<span class="sc">/</span>res<span class="sc">$</span>res4Splus<span class="sc">$</span>eigValues[<span class="dv">3</span>]) <span class="sc">+</span></span>
<span id="cb290-7"><a href="#cb290-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(. <span class="sc">~</span> <span class="fu">get_visit_labels</span>(AVISITN)) <span class="sc">+</span></span>
<span id="cb290-8"><a href="#cb290-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="st">"Intervention arm"</span>, <span class="at">values =</span> <span class="fu">get_arm_colors</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-279-2.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb291"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb291-1"><a href="#cb291-1" aria-hidden="true" tabindex="-1"></a>partial <span class="ot">&lt;-</span> </span>
<span id="cb291-2"><a href="#cb291-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(</span>
<span id="cb291-3"><a href="#cb291-3" aria-hidden="true" tabindex="-1"></a>    res<span class="sc">$</span>res4Splus<span class="sc">$</span>PartialF[,,<span class="dv">1</span>] <span class="sc">|&gt;</span> </span>
<span id="cb291-4"><a href="#cb291-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb291-5"><a href="#cb291-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">table =</span> <span class="st">"Microbiota"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb291-6"><a href="#cb291-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">bind_cols</span>(distances <span class="sc">|&gt;</span> <span class="fu">select</span>(USUBJID, AVISITN, ARM, PIPV)),</span>
<span id="cb291-7"><a href="#cb291-7" aria-hidden="true" tabindex="-1"></a>    res<span class="sc">$</span>res4Splus<span class="sc">$</span>PartialF[,,<span class="dv">2</span>] <span class="sc">|&gt;</span></span>
<span id="cb291-8"><a href="#cb291-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span></span>
<span id="cb291-9"><a href="#cb291-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">table =</span> <span class="st">"Cytokines"</span>) <span class="sc">|&gt;</span></span>
<span id="cb291-10"><a href="#cb291-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">bind_cols</span>(distances <span class="sc">|&gt;</span> <span class="fu">select</span>(USUBJID, AVISITN, ARM, PIPV)),</span>
<span id="cb291-11"><a href="#cb291-11" aria-hidden="true" tabindex="-1"></a>    compromise <span class="sc">|&gt;</span> </span>
<span id="cb291-12"><a href="#cb291-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">table =</span> <span class="st">"Compromise"</span>)</span>
<span id="cb291-13"><a href="#cb291-13" aria-hidden="true" tabindex="-1"></a>  )  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb292"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb292-1"><a href="#cb292-1" aria-hidden="true" tabindex="-1"></a>partial <span class="sc">|&gt;</span> </span>
<span id="cb292-2"><a href="#cb292-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(PIPV) <span class="sc">|&gt;</span> </span>
<span id="cb292-3"><a href="#cb292-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Factor 1</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">Factor 2</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb292-4"><a href="#cb292-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"gray80"</span>) <span class="sc">+</span></span>
<span id="cb292-5"><a href="#cb292-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"gray80"</span>) <span class="sc">+</span></span>
<span id="cb292-6"><a href="#cb292-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> USUBJID), <span class="at">col =</span> <span class="st">"gray"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb292-7"><a href="#cb292-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">col =</span> table), <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb292-8"><a href="#cb292-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>(<span class="at">ratio =</span> res<span class="sc">$</span>res4Splus<span class="sc">$</span>eigValues[<span class="dv">2</span>]<span class="sc">/</span>res<span class="sc">$</span>res4Splus<span class="sc">$</span>eigValues[<span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb292-9"><a href="#cb292-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(ARM <span class="sc">~</span> AVISITN <span class="sc">|&gt;</span> <span class="fu">get_visit_labels</span>()) <span class="sc">+</span></span>
<span id="cb292-10"><a href="#cb292-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="st">""</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"steelblue1"</span>, <span class="st">"darkslateblue"</span>, <span class="st">"indianred1"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-281-1.png" class="img-fluid figure-img" width="1440"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb293"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb293-1"><a href="#cb293-1" aria-hidden="true" tabindex="-1"></a>partial <span class="sc">|&gt;</span> </span>
<span id="cb293-2"><a href="#cb293-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(PIPV) <span class="sc">|&gt;</span> </span>
<span id="cb293-3"><a href="#cb293-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Factor 3</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">Factor 4</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb293-4"><a href="#cb293-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"gray80"</span>) <span class="sc">+</span></span>
<span id="cb293-5"><a href="#cb293-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"gray80"</span>) <span class="sc">+</span></span>
<span id="cb293-6"><a href="#cb293-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> USUBJID), <span class="at">col =</span> <span class="st">"gray"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb293-7"><a href="#cb293-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">col =</span> table), <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb293-8"><a href="#cb293-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>(<span class="at">ratio =</span> res<span class="sc">$</span>res4Splus<span class="sc">$</span>eigValues[<span class="dv">4</span>]<span class="sc">/</span>res<span class="sc">$</span>res4Splus<span class="sc">$</span>eigValues[<span class="dv">3</span>]) <span class="sc">+</span></span>
<span id="cb293-9"><a href="#cb293-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(ARM <span class="sc">~</span> AVISITN <span class="sc">|&gt;</span> <span class="fu">get_visit_labels</span>()) <span class="sc">+</span></span>
<span id="cb293-10"><a href="#cb293-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="st">""</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"steelblue1"</span>, <span class="st">"darkslateblue"</span>, <span class="st">"indianred1"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-281-2.png" class="img-fluid figure-img" width="1440"></p>
</figure>
</div>
</div>
</div>
<p>Focus on Visit 2 (week 4) data</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb294"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb294-1"><a href="#cb294-1" aria-hidden="true" tabindex="-1"></a>partial <span class="sc">|&gt;</span> </span>
<span id="cb294-2"><a href="#cb294-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(AVISITN <span class="sc">==</span> <span class="dv">2</span>) <span class="sc">|&gt;</span> </span>
<span id="cb294-3"><a href="#cb294-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Factor 1</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">Factor 2</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb294-4"><a href="#cb294-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"gray80"</span>) <span class="sc">+</span></span>
<span id="cb294-5"><a href="#cb294-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"gray80"</span>) <span class="sc">+</span></span>
<span id="cb294-6"><a href="#cb294-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> USUBJID), <span class="at">col =</span> <span class="st">"gray"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb294-7"><a href="#cb294-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">col =</span> table), <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb294-8"><a href="#cb294-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>(<span class="at">ratio =</span> res<span class="sc">$</span>res4Splus<span class="sc">$</span>eigValues[<span class="dv">2</span>]<span class="sc">/</span>res<span class="sc">$</span>res4Splus<span class="sc">$</span>eigValues[<span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb294-9"><a href="#cb294-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(ARM <span class="sc">~</span> AVISITN <span class="sc">|&gt;</span> <span class="fu">get_visit_labels</span>()) <span class="sc">+</span></span>
<span id="cb294-10"><a href="#cb294-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="st">""</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"gray60"</span>, <span class="st">"darkslateblue"</span>, <span class="st">"indianred1"</span>)) <span class="sc">+</span></span>
<span id="cb294-11"><a href="#cb294-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"DiSTATIS Compromise Component 1"</span>) <span class="sc">+</span></span>
<span id="cb294-12"><a href="#cb294-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Component 2"</span>) <span class="sc">+</span> </span>
<span id="cb294-13"><a href="#cb294-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-282-1.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb295"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb295-1"><a href="#cb295-1" aria-hidden="true" tabindex="-1"></a>partial <span class="sc">|&gt;</span> </span>
<span id="cb295-2"><a href="#cb295-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(AVISITN <span class="sc">==</span> <span class="dv">2</span>) <span class="sc">|&gt;</span> </span>
<span id="cb295-3"><a href="#cb295-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Factor 1</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">Factor 2</span><span class="st">`</span>, <span class="at">col =</span> USUBJID)) <span class="sc">+</span></span>
<span id="cb295-4"><a href="#cb295-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> USUBJID), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb295-5"><a href="#cb295-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">shape =</span> table)) <span class="sc">+</span></span>
<span id="cb295-6"><a href="#cb295-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>(<span class="at">ratio =</span> res<span class="sc">$</span>res4Splus<span class="sc">$</span>eigValues[<span class="dv">2</span>]<span class="sc">/</span>res<span class="sc">$</span>res4Splus<span class="sc">$</span>eigValues[<span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb295-7"><a href="#cb295-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(ARM <span class="sc">~</span> AVISITN <span class="sc">|&gt;</span> <span class="fu">get_visit_labels</span>()) <span class="sc">+</span></span>
<span id="cb295-8"><a href="#cb295-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">col =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-282-2.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb296"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb296-1"><a href="#cb296-1" aria-hidden="true" tabindex="-1"></a>cor_topics <span class="ot">&lt;-</span> </span>
<span id="cb296-2"><a href="#cb296-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cor</span>(distances<span class="sc">$</span>topics, compromise <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"Factor"</span>))) <span class="sc">|&gt;</span> </span>
<span id="cb296-3"><a href="#cb296-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span> </span>
<span id="cb296-4"><a href="#cb296-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"feature"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb296-5"><a href="#cb296-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() </span>
<span id="cb296-6"><a href="#cb296-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb296-7"><a href="#cb296-7" aria-hidden="true" tabindex="-1"></a>cor_cytokines <span class="ot">&lt;-</span> </span>
<span id="cb296-8"><a href="#cb296-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cor</span>(distances<span class="sc">$</span>cytokines, compromise <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"Factor"</span>))) <span class="sc">|&gt;</span> </span>
<span id="cb296-9"><a href="#cb296-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span> </span>
<span id="cb296-10"><a href="#cb296-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"feature"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb296-11"><a href="#cb296-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() </span>
<span id="cb296-12"><a href="#cb296-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb296-13"><a href="#cb296-13" aria-hidden="true" tabindex="-1"></a>cors <span class="ot">&lt;-</span> </span>
<span id="cb296-14"><a href="#cb296-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(</span>
<span id="cb296-15"><a href="#cb296-15" aria-hidden="true" tabindex="-1"></a>    cor_topics <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">table =</span> <span class="st">"Microbiota</span><span class="sc">\n</span><span class="st">sub-communities"</span>),</span>
<span id="cb296-16"><a href="#cb296-16" aria-hidden="true" tabindex="-1"></a>    cor_cytokines <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">table =</span> <span class="st">"cytokines"</span>)</span>
<span id="cb296-17"><a href="#cb296-17" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Correlation circles</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb297"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb297-1"><a href="#cb297-1" aria-hidden="true" tabindex="-1"></a>cors <span class="sc">|&gt;</span> </span>
<span id="cb297-2"><a href="#cb297-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Factor 1</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">Factor 2</span><span class="st">`</span>, <span class="at">col =</span> table)) <span class="sc">+</span></span>
<span id="cb297-3"><a href="#cb297-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_circle</span>(<span class="fu">aes</span>(<span class="at">x0 =</span> <span class="dv">0</span>, <span class="at">y0 =</span> <span class="dv">0</span>, <span class="at">r =</span> <span class="dv">1</span>), <span class="at">col =</span> <span class="st">"gray80"</span>, <span class="at">linewidth =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb297-4"><a href="#cb297-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(</span>
<span id="cb297-5"><a href="#cb297-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">xend =</span> <span class="dv">0</span>, <span class="at">yend =</span> <span class="dv">0</span>), </span>
<span id="cb297-6"><a href="#cb297-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">arrow =</span> </span>
<span id="cb297-7"><a href="#cb297-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">arrow</span>(<span class="at">ends =</span> <span class="st">"first"</span>, <span class="at">type =</span> <span class="st">"closed"</span>, <span class="at">angle =</span> <span class="dv">20</span>, <span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.1</span>, <span class="st">"inches"</span>))</span>
<span id="cb297-8"><a href="#cb297-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb297-9"><a href="#cb297-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>(<span class="fu">aes</span>(<span class="at">label =</span> feature), <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb297-10"><a href="#cb297-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>() <span class="sc">+</span></span>
<span id="cb297-11"><a href="#cb297-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> block_colors) <span class="sc">+</span></span>
<span id="cb297-12"><a href="#cb297-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb297-13"><a href="#cb297-13" aria-hidden="true" tabindex="-1"></a>  cors <span class="sc">|&gt;</span> </span>
<span id="cb297-14"><a href="#cb297-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Factor 3</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">Factor 4</span><span class="st">`</span>, <span class="at">col =</span> table)) <span class="sc">+</span></span>
<span id="cb297-15"><a href="#cb297-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_circle</span>(<span class="fu">aes</span>(<span class="at">x0 =</span> <span class="dv">0</span>, <span class="at">y0 =</span> <span class="dv">0</span>, <span class="at">r =</span> <span class="dv">1</span>), <span class="at">col =</span> <span class="st">"gray80"</span>, <span class="at">linewidth =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb297-16"><a href="#cb297-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(</span>
<span id="cb297-17"><a href="#cb297-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">xend =</span> <span class="dv">0</span>, <span class="at">yend =</span> <span class="dv">0</span>), </span>
<span id="cb297-18"><a href="#cb297-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">arrow =</span> </span>
<span id="cb297-19"><a href="#cb297-19" aria-hidden="true" tabindex="-1"></a>      <span class="fu">arrow</span>(<span class="at">ends =</span> <span class="st">"first"</span>, <span class="at">type =</span> <span class="st">"closed"</span>, <span class="at">angle =</span> <span class="dv">20</span>, <span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.1</span>, <span class="st">"inches"</span>))</span>
<span id="cb297-20"><a href="#cb297-20" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb297-21"><a href="#cb297-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>(<span class="fu">aes</span>(<span class="at">label =</span> feature), <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb297-22"><a href="#cb297-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>() <span class="sc">+</span></span>
<span id="cb297-23"><a href="#cb297-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> block_colors)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-284-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="differentiating-ctv-05-from-other-l.-crispatus-strains" class="level4" data-number="2.1.2.5">
<h4 data-number="2.1.2.5" class="anchored" data-anchor-id="differentiating-ctv-05-from-other-l.-crispatus-strains"><span class="header-section-number">2.1.2.5</span> Differentiating CTV-05 from other <em>L. crispatus</em> strains</h4>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb298"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb298-1"><a href="#cb298-1" aria-hidden="true" tabindex="-1"></a>ctv05_rel_ab <span class="ot">&lt;-</span> </span>
<span id="cb298-2"><a href="#cb298-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_assay_wide_format</span>(mae, <span class="st">"tax_CTV05_p"</span>) <span class="sc">|&gt;</span></span>
<span id="cb298-3"><a href="#cb298-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">rel_ab =</span> assay)</span>
<span id="cb298-4"><a href="#cb298-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb298-5"><a href="#cb298-5" aria-hidden="true" tabindex="-1"></a>combined_ctv05 <span class="ot">&lt;-</span> </span>
<span id="cb298-6"><a href="#cb298-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(ctv05_rel_ab, cytokines, <span class="at">by =</span> <span class="fu">join_by</span>(Barcode))</span>
<span id="cb298-7"><a href="#cb298-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb298-8"><a href="#cb298-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb298-9"><a href="#cb298-9" aria-hidden="true" tabindex="-1"></a>ctv05_topics <span class="ot">&lt;-</span> </span>
<span id="cb298-10"><a href="#cb298-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_assay_wide_format</span>(mae, <span class="st">"c_topics_16S_10_ctv05"</span>, <span class="at">add_colData =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span></span>
<span id="cb298-11"><a href="#cb298-11" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">topics =</span> assay) <span class="sc">|&gt;</span> </span>
<span id="cb298-12"><a href="#cb298-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb298-13"><a href="#cb298-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">topics =</span> topics <span class="sc">|&gt;</span> <span class="fu">set_colnames</span>(SummarizedExperiment<span class="sc">::</span><span class="fu">rowData</span>(mae[[<span class="st">"c_topics_16S_10_ctv05"</span>]])<span class="sc">$</span>topic_label)</span>
<span id="cb298-14"><a href="#cb298-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb298-15"><a href="#cb298-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb298-16"><a href="#cb298-16" aria-hidden="true" tabindex="-1"></a>combined_ctv05 <span class="ot">&lt;-</span> </span>
<span id="cb298-17"><a href="#cb298-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(combined_ctv05, ctv05_topics, <span class="at">by =</span> <span class="fu">join_by</span>(Barcode))</span>
<span id="cb298-18"><a href="#cb298-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb298-19"><a href="#cb298-19" aria-hidden="true" tabindex="-1"></a>combined_ctv05 <span class="ot">&lt;-</span> </span>
<span id="cb298-20"><a href="#cb298-20" aria-hidden="true" tabindex="-1"></a>  combined_ctv05 <span class="sc">|&gt;</span> </span>
<span id="cb298-21"><a href="#cb298-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb298-22"><a href="#cb298-22" aria-hidden="true" tabindex="-1"></a>    USUBJID, AVISITN, ARM, rel_ab, topics, cytokines, <span class="fu">everything</span>()</span>
<span id="cb298-23"><a href="#cb298-23" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb299"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb299-1"><a href="#cb299-1" aria-hidden="true" tabindex="-1"></a>distances_ctv05 <span class="ot">&lt;-</span> </span>
<span id="cb299-2"><a href="#cb299-2" aria-hidden="true" tabindex="-1"></a>  combined_ctv05 <span class="sc">|&gt;</span> </span>
<span id="cb299-3"><a href="#cb299-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(AVISITN <span class="sc">!=</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb299-4"><a href="#cb299-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb299-5"><a href="#cb299-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">mb_distances =</span> vegan<span class="sc">::</span><span class="fu">vegdist</span>(rel_ab, <span class="at">method =</span> <span class="st">"bray"</span>) <span class="sc">|&gt;</span> <span class="fu">as.matrix</span>(),</span>
<span id="cb299-6"><a href="#cb299-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">cytokine_distances =</span> <span class="fu">dist</span>(cytokines, <span class="at">method =</span> <span class="st">"manhattan"</span>) <span class="sc">|&gt;</span> <span class="fu">as.matrix</span>()</span>
<span id="cb299-7"><a href="#cb299-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb299-8"><a href="#cb299-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-9"><a href="#cb299-9" aria-hidden="true" tabindex="-1"></a>dist_cube_ctv05 <span class="ot">&lt;-</span> </span>
<span id="cb299-10"><a href="#cb299-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">array</span>(</span>
<span id="cb299-11"><a href="#cb299-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(</span>
<span id="cb299-12"><a href="#cb299-12" aria-hidden="true" tabindex="-1"></a>      distances_ctv05<span class="sc">$</span>mb_distances, </span>
<span id="cb299-13"><a href="#cb299-13" aria-hidden="true" tabindex="-1"></a>      distances_ctv05<span class="sc">$</span>cytokine_distances</span>
<span id="cb299-14"><a href="#cb299-14" aria-hidden="true" tabindex="-1"></a>    ), </span>
<span id="cb299-15"><a href="#cb299-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">nrow</span>(distances_ctv05), <span class="fu">nrow</span>(distances_ctv05), <span class="dv">2</span>)</span>
<span id="cb299-16"><a href="#cb299-16" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb299-17"><a href="#cb299-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-18"><a href="#cb299-18" aria-hidden="true" tabindex="-1"></a>res_ctv05 <span class="ot">&lt;-</span> <span class="fu">distatis</span>(dist_cube_ctv05, <span class="at">nfact =</span> <span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb300"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb300-1"><a href="#cb300-1" aria-hidden="true" tabindex="-1"></a>res_ctv05<span class="sc">$</span>res4Cmat<span class="sc">$</span>C <span class="co"># RV equivalent</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>          [,1]      [,2]
[1,] 1.0000000 0.2528445
[2,] 0.2528445 1.0000000</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb302"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb302-1"><a href="#cb302-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compute_RV(distances$topic_distances, distances$cytokine_distances)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb303"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb303-1"><a href="#cb303-1" aria-hidden="true" tabindex="-1"></a>res_ctv05<span class="sc">$</span>res4Cmat<span class="sc">$</span>eigValues</span>
<span id="cb303-2"><a href="#cb303-2" aria-hidden="true" tabindex="-1"></a>res_ctv05<span class="sc">$</span>res4Cmat<span class="sc">$</span>eigValues<span class="sc">/</span><span class="fu">sum</span>(res_ctv05<span class="sc">$</span>res4Cmat<span class="sc">$</span>eigValues)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb304"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb304-1"><a href="#cb304-1" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> </span>
<span id="cb304-2"><a href="#cb304-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">eig =</span> res_ctv05<span class="sc">$</span>res4Splus<span class="sc">$</span>eigValues) <span class="sc">|&gt;</span> </span>
<span id="cb304-3"><a href="#cb304-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n =</span> <span class="fu">row_number</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb304-4"><a href="#cb304-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> n, <span class="at">y =</span> eig)) <span class="sc">+</span></span>
<span id="cb304-5"><a href="#cb304-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>()</span>
<span id="cb304-6"><a href="#cb304-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb304-7"><a href="#cb304-7" aria-hidden="true" tabindex="-1"></a>g <span class="sc">+</span></span>
<span id="cb304-8"><a href="#cb304-8" aria-hidden="true" tabindex="-1"></a>g <span class="sc">+</span> <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">21</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-289-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb305"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb305-1"><a href="#cb305-1" aria-hidden="true" tabindex="-1"></a>compromise_cvt05 <span class="ot">&lt;-</span> </span>
<span id="cb305-2"><a href="#cb305-2" aria-hidden="true" tabindex="-1"></a>  res_ctv05<span class="sc">$</span>res4Splus<span class="sc">$</span>F <span class="sc">|&gt;</span> </span>
<span id="cb305-3"><a href="#cb305-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb305-4"><a href="#cb305-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(distances_ctv05 <span class="sc">|&gt;</span> <span class="fu">select</span>(USUBJID, AVISITN, ARM, PIPV))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb306"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb306-1"><a href="#cb306-1" aria-hidden="true" tabindex="-1"></a>cor_topics <span class="ot">&lt;-</span> </span>
<span id="cb306-2"><a href="#cb306-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cor</span>(</span>
<span id="cb306-3"><a href="#cb306-3" aria-hidden="true" tabindex="-1"></a>    distances_ctv05<span class="sc">$</span>topics, </span>
<span id="cb306-4"><a href="#cb306-4" aria-hidden="true" tabindex="-1"></a>    compromise_cvt05 <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"Factor"</span>))</span>
<span id="cb306-5"><a href="#cb306-5" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb306-6"><a href="#cb306-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span> </span>
<span id="cb306-7"><a href="#cb306-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"feature"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb306-8"><a href="#cb306-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() </span>
<span id="cb306-9"><a href="#cb306-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb306-10"><a href="#cb306-10" aria-hidden="true" tabindex="-1"></a>cor_cytokines <span class="ot">&lt;-</span> </span>
<span id="cb306-11"><a href="#cb306-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cor</span>(</span>
<span id="cb306-12"><a href="#cb306-12" aria-hidden="true" tabindex="-1"></a>    distances_ctv05<span class="sc">$</span>cytokines, </span>
<span id="cb306-13"><a href="#cb306-13" aria-hidden="true" tabindex="-1"></a>    compromise_cvt05 <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"Factor"</span>))</span>
<span id="cb306-14"><a href="#cb306-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb306-15"><a href="#cb306-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span> </span>
<span id="cb306-16"><a href="#cb306-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"feature"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb306-17"><a href="#cb306-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() </span>
<span id="cb306-18"><a href="#cb306-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb306-19"><a href="#cb306-19" aria-hidden="true" tabindex="-1"></a>cors <span class="ot">&lt;-</span> </span>
<span id="cb306-20"><a href="#cb306-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(</span>
<span id="cb306-21"><a href="#cb306-21" aria-hidden="true" tabindex="-1"></a>    cor_topics <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">table =</span> <span class="st">"Microbiota topics"</span>),</span>
<span id="cb306-22"><a href="#cb306-22" aria-hidden="true" tabindex="-1"></a>    cor_cytokines <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">table =</span> <span class="st">"cytokines"</span>)</span>
<span id="cb306-23"><a href="#cb306-23" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Correlation circles</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb307"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb307-1"><a href="#cb307-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_distatis_corr_circle</span>(cors, <span class="at">axes =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb307-2"><a href="#cb307-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb307-3"><a href="#cb307-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_distatis_corr_circle</span>(cors, <span class="at">axes =</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-292-1.png" class="img-fluid figure-img" width="1440"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb308"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb308-1"><a href="#cb308-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb308-2"><a href="#cb308-2" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> </span>
<span id="cb308-3"><a href="#cb308-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">eig =</span> res_ctv05<span class="sc">$</span>res4Splus<span class="sc">$</span>eigValues) <span class="sc">|&gt;</span> </span>
<span id="cb308-4"><a href="#cb308-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n =</span> <span class="fu">row_number</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb308-5"><a href="#cb308-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> n, <span class="at">y =</span> eig)) <span class="sc">+</span></span>
<span id="cb308-6"><a href="#cb308-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span> </span>
<span id="cb308-7"><a href="#cb308-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">11</span>)) <span class="sc">+</span></span>
<span id="cb308-8"><a href="#cb308-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb308-9"><a href="#cb308-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_distatis_corr_circle</span>(cors, <span class="at">axes =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb308-10"><a href="#cb308-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb308-11"><a href="#cb308-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_distatis_corr_circle</span>(cors, <span class="at">axes =</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb308-12"><a href="#cb308-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">widths =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">4</span>), <span class="at">guides =</span> <span class="st">"collect"</span>) <span class="sc">+</span></span>
<span id="cb308-13"><a href="#cb308-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="fu">list</span>(LETTERS[<span class="dv">5</span><span class="sc">:</span>(<span class="dv">5</span><span class="sc">+</span><span class="dv">2</span>)]))</span>
<span id="cb308-14"><a href="#cb308-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb308-15"><a href="#cb308-15" aria-hidden="true" tabindex="-1"></a>g</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-293-1.png" class="img-fluid figure-img" width="4800"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb309"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb309-1"><a href="#cb309-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(g, <span class="at">filename =</span> <span class="fu">str_c</span>(<span class="fu">fig_out_dir</span>(), <span class="st">"S4EG.pdf"</span>), <span class="at">width =</span> <span class="dv">14</span>, <span class="at">height =</span> <span class="dv">5</span>, <span class="at">device =</span> cairo_pdf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
</section>
</section>
<section id="cytokine-figure" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Cytokine figure</h1>
<section id="version-1" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="version-1"><span class="header-section-number">3.1</span> Version 1</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb310"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb310-1"><a href="#cb310-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="at">file =</span> <span class="fu">str_c</span>(<span class="fu">data_dir</span>(), <span class="st">"05_figures_tables/fig_3a_PC1_subtracted_all.Rdata"</span>), <span class="at">verbose =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Loading objects:
  g_selection</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb312"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb312-1"><a href="#cb312-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="at">file =</span> <span class="fu">str_c</span>(<span class="fu">data_dir</span>(), <span class="st">"05_figures_tables/fig_3b.Rdata"</span>), <span class="at">verbose =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Loading objects:
  g_distatis</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb314"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb314-1"><a href="#cb314-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">5</span>)</span>
<span id="cb314-2"><a href="#cb314-2" aria-hidden="true" tabindex="-1"></a>g_selection <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">""</span>) <span class="sc">+</span> g_distatis <span class="sc">+</span></span>
<span id="cb314-3"><a href="#cb314-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">nrow =</span> <span class="dv">1</span>,  <span class="at">widths =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">1.4</span>)) <span class="sc">+</span></span>
<span id="cb314-4"><a href="#cb314-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">"A"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="3900"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="version-2" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="version-2"><span class="header-section-number">3.2</span> Version 2</h2>
<section id="part-1-pc1-subtracted-z-log10conc.-of-cytokines" class="level3" data-number="3.2.1">
<h3 data-number="3.2.1" class="anchored" data-anchor-id="part-1-pc1-subtracted-z-log10conc.-of-cytokines"><span class="header-section-number">3.2.1</span> Part 1: PC1-subtracted z-log10(conc.) of cytokines</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb315"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb315-1"><a href="#cb315-1" aria-hidden="true" tabindex="-1"></a>assay_name <span class="ot">&lt;-</span> <span class="st">"cytokine_log10_SE_corrected_incl_cytokine"</span></span>
<span id="cb315-2"><a href="#cb315-2" aria-hidden="true" tabindex="-1"></a>value_label <span class="ot">&lt;-</span> <span class="st">"PC1-subtracted z-log10(conc.)"</span></span>
<span id="cb315-3"><a href="#cb315-3" aria-hidden="true" tabindex="-1"></a>value_label <span class="ot">&lt;-</span> <span class="st">"adj. log10(conc.)"</span></span>
<span id="cb315-4"><a href="#cb315-4" aria-hidden="true" tabindex="-1"></a>selected_cytokines <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"IL-1b"</span>, <span class="st">"IP-10"</span>, <span class="st">"IL-6"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb316"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb316-1"><a href="#cb316-1" aria-hidden="true" tabindex="-1"></a>cytokines_long <span class="ot">&lt;-</span> </span>
<span id="cb316-2"><a href="#cb316-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_assay_long_format</span>(</span>
<span id="cb316-3"><a href="#cb316-3" aria-hidden="true" tabindex="-1"></a>    mae, assay_name, </span>
<span id="cb316-4"><a href="#cb316-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">feature_name =</span> <span class="st">"cytokine"</span>, <span class="at">values_name =</span> <span class="st">"value"</span></span>
<span id="cb316-5"><a href="#cb316-5" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb316-6"><a href="#cb316-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Visit =</span> <span class="fu">get_visit_labels</span>(AVISITN)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb317"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb317-1"><a href="#cb317-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"N cytokines: "</span>, <span class="fu">length</span>(<span class="fu">unique</span>(cytokines_long<span class="sc">$</span>cytokine)), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>N cytokines:  13 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb319"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb319-1"><a href="#cb319-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"N samples: "</span>, <span class="fu">length</span>(<span class="fu">unique</span>(cytokines_long<span class="sc">$</span>Barcode)), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>N samples:  1151 </code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb321"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb321-1"><a href="#cb321-1" aria-hidden="true" tabindex="-1"></a>categories_levels <span class="ot">&lt;-</span> </span>
<span id="cb321-2"><a href="#cb321-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">"≥ 50% L. crispatus"</span>, <span class="st">"≥ 50% Lactobacillus, &lt; 50% L. crispatus"</span>, <span class="st">"&lt; 50% Lactobacillus"</span>)</span>
<span id="cb321-3"><a href="#cb321-3" aria-hidden="true" tabindex="-1"></a>microbiota_categories <span class="ot">&lt;-</span> </span>
<span id="cb321-4"><a href="#cb321-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_assay_long_format</span>(</span>
<span id="cb321-5"><a href="#cb321-5" aria-hidden="true" tabindex="-1"></a>    mae, <span class="st">"mb_categories"</span>, <span class="at">add_colData =</span> <span class="cn">FALSE</span>, <span class="at">values_name =</span> <span class="st">"microbiota"</span></span>
<span id="cb321-6"><a href="#cb321-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb321-7"><a href="#cb321-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>feature) <span class="sc">|&gt;</span> </span>
<span id="cb321-8"><a href="#cb321-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">microbiota =</span> microbiota <span class="sc">|&gt;</span> <span class="fu">factor</span>(<span class="at">levels =</span> categories_levels))</span>
<span id="cb321-9"><a href="#cb321-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb321-10"><a href="#cb321-10" aria-hidden="true" tabindex="-1"></a>cytokines_long <span class="ot">&lt;-</span> </span>
<span id="cb321-11"><a href="#cb321-11" aria-hidden="true" tabindex="-1"></a>  cytokines_long <span class="sc">|&gt;</span> </span>
<span id="cb321-12"><a href="#cb321-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">any_of</span>(<span class="fu">c</span>(<span class="st">"microbiota"</span>))) <span class="sc">|&gt;</span> </span>
<span id="cb321-13"><a href="#cb321-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(microbiota_categories, <span class="at">by =</span> <span class="fu">join_by</span>(Barcode))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb322"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb322-1"><a href="#cb322-1" aria-hidden="true" tabindex="-1"></a>preMTZ_cytokines <span class="ot">&lt;-</span> </span>
<span id="cb322-2"><a href="#cb322-2" aria-hidden="true" tabindex="-1"></a>  cytokines_long <span class="sc">|&gt;</span></span>
<span id="cb322-3"><a href="#cb322-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(AVISITN <span class="sc">==</span> <span class="dv">0</span>) <span class="sc">|&gt;</span></span>
<span id="cb322-4"><a href="#cb322-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(USUBJID, cytokine, value) <span class="sc">|&gt;</span> </span>
<span id="cb322-5"><a href="#cb322-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">pre_MTZ_value =</span> value)</span>
<span id="cb322-6"><a href="#cb322-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb322-7"><a href="#cb322-7" aria-hidden="true" tabindex="-1"></a>cytokines_to_preMTZ <span class="ot">&lt;-</span> </span>
<span id="cb322-8"><a href="#cb322-8" aria-hidden="true" tabindex="-1"></a>  cytokines_long <span class="sc">|&gt;</span> </span>
<span id="cb322-9"><a href="#cb322-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(PIPV, AVISITN <span class="sc">!=</span> <span class="dv">0</span>) <span class="sc">|&gt;</span> </span>
<span id="cb322-10"><a href="#cb322-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Visit =</span> <span class="fu">get_visit_labels</span>(AVISITN)) <span class="sc">|&gt;</span></span>
<span id="cb322-11"><a href="#cb322-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Barcode, USUBJID, Visit, ARM, cytokine, value, microbiota) <span class="sc">|&gt;</span> </span>
<span id="cb322-12"><a href="#cb322-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(preMTZ_cytokines, <span class="at">by =</span> <span class="fu">join_by</span>(USUBJID, cytokine)) <span class="sc">|&gt;</span> </span>
<span id="cb322-13"><a href="#cb322-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(pre_MTZ_value)) <span class="sc">|&gt;</span> </span>
<span id="cb322-14"><a href="#cb322-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">diff =</span> value <span class="sc">-</span> pre_MTZ_value)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb323"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb323-1"><a href="#cb323-1" aria-hidden="true" tabindex="-1"></a>part_1_plots <span class="ot">&lt;-</span> </span>
<span id="cb323-2"><a href="#cb323-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(</span>
<span id="cb323-3"><a href="#cb323-3" aria-hidden="true" tabindex="-1"></a>    selected_cytokines,</span>
<span id="cb323-4"><a href="#cb323-4" aria-hidden="true" tabindex="-1"></a>    <span class="sc">~</span> cytokines_to_preMTZ <span class="sc">|&gt;</span> </span>
<span id="cb323-5"><a href="#cb323-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(cytokine <span class="sc">==</span> .x) <span class="sc">|&gt;</span> </span>
<span id="cb323-6"><a href="#cb323-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(<span class="sc">!</span>(Visit <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Week 4"</span>, <span class="st">"Week 8"</span>))) <span class="sc">|&gt;</span> </span>
<span id="cb323-7"><a href="#cb323-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">plot_cytokine_to_preMTZ</span>(<span class="at">value_label =</span> value_label) <span class="sc">+</span></span>
<span id="cb323-8"><a href="#cb323-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">xlab</span>(<span class="st">""</span>)</span>
<span id="cb323-9"><a href="#cb323-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb323-10"><a href="#cb323-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb323-11"><a href="#cb323-11" aria-hidden="true" tabindex="-1"></a>part_1_plots <span class="sc">|&gt;</span> </span>
<span id="cb323-12"><a href="#cb323-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">wrap_plots</span>(<span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">guides =</span> <span class="st">"collect"</span>) <span class="sc">+</span></span>
<span id="cb323-13"><a href="#cb323-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">"A"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="1248"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="part-2-integration-with-microbiota" class="level3" data-number="3.2.2">
<h3 data-number="3.2.2" class="anchored" data-anchor-id="part-2-integration-with-microbiota"><span class="header-section-number">3.2.2</span> Part 2: integration with microbiota</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb324"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb324-1"><a href="#cb324-1" aria-hidden="true" tabindex="-1"></a>g_distatis[[<span class="dv">1</span>]] <span class="sc">+</span> </span>
<span id="cb324-2"><a href="#cb324-2" aria-hidden="true" tabindex="-1"></a>  patchwork<span class="sc">::</span><span class="fu">inset_element</span>(</span>
<span id="cb324-3"><a href="#cb324-3" aria-hidden="true" tabindex="-1"></a>    g_distatis[[<span class="dv">2</span>]]  <span class="sc">+</span> </span>
<span id="cb324-4"><a href="#cb324-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(</span>
<span id="cb324-5"><a href="#cb324-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"white"</span>, <span class="at">color =</span> <span class="st">"white"</span>),</span>
<span id="cb324-6"><a href="#cb324-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">0</span>, <span class="at">l =</span> <span class="dv">2</span>, <span class="at">r =</span> <span class="dv">1</span>, <span class="at">b =</span> <span class="dv">10</span>, <span class="at">unit =</span> <span class="st">"pt"</span>),</span>
<span id="cb324-7"><a href="#cb324-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>()</span>
<span id="cb324-8"><a href="#cb324-8" aria-hidden="true" tabindex="-1"></a>      ), </span>
<span id="cb324-9"><a href="#cb324-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">left =</span> <span class="dv">0</span>, <span class="at">bottom =</span> <span class="fl">0.7</span>, <span class="at">right =</span> <span class="fl">0.35</span>, <span class="at">top =</span> <span class="dv">1</span>, <span class="at">align_to =</span> <span class="st">"plot"</span>, <span class="at">ignore_tag =</span> <span class="cn">TRUE</span></span>
<span id="cb324-10"><a href="#cb324-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb324-11"><a href="#cb324-11" aria-hidden="true" tabindex="-1"></a>  g_distatis[[<span class="dv">3</span>]]  <span class="sc">+</span></span>
<span id="cb324-12"><a href="#cb324-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">"collect"</span>, <span class="at">ncol =</span> <span class="dv">2</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="1248"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb325"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb325-1"><a href="#cb325-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="at">file =</span> <span class="fu">str_c</span>(<span class="fu">data_dir</span>(), <span class="st">"05_figures_tables/fig_3b_panels.Rdata"</span>), <span class="at">verbose =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Loading objects:
  g_eig
  g_cor_circle_L1_12
  g_cor_circle_L1_34</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb327"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb327-1"><a href="#cb327-1" aria-hidden="true" tabindex="-1"></a>g_eig <span class="sc">+</span> </span>
<span id="cb327-2"><a href="#cb327-2" aria-hidden="true" tabindex="-1"></a> g_cor_circle_L1_12 <span class="sc">+</span></span>
<span id="cb327-3"><a href="#cb327-3" aria-hidden="true" tabindex="-1"></a>  g_cor_circle_L1_34 <span class="sc">+</span></span>
<span id="cb327-4"><a href="#cb327-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">"collect"</span>, <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">widths =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="cb327-5"><a href="#cb327-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">"A"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="1248"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="assembled" class="level3" data-number="3.2.3">
<h3 data-number="3.2.3" class="anchored" data-anchor-id="assembled"><span class="header-section-number">3.2.3</span> Assembled</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb328"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb328-1"><a href="#cb328-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">5</span>)</span>
<span id="cb328-2"><a href="#cb328-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb328-3"><a href="#cb328-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb328-4"><a href="#cb328-4" aria-hidden="true" tabindex="-1"></a>patch_1 <span class="ot">&lt;-</span> </span>
<span id="cb328-5"><a href="#cb328-5" aria-hidden="true" tabindex="-1"></a>  (</span>
<span id="cb328-6"><a href="#cb328-6" aria-hidden="true" tabindex="-1"></a>    part_1_plots[[<span class="dv">1</span>]] <span class="sc">+</span> part_1_plots[[<span class="dv">2</span>]] <span class="sc">+</span> part_1_plots[[<span class="dv">3</span>]] <span class="sc">+</span> </span>
<span id="cb328-7"><a href="#cb328-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">"collect"</span>, <span class="at">nrow =</span> <span class="dv">1</span>) <span class="sc">&amp;</span></span>
<span id="cb328-8"><a href="#cb328-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(</span>
<span id="cb328-9"><a href="#cb328-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="sc">-</span><span class="dv">20</span>)</span>
<span id="cb328-10"><a href="#cb328-10" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb328-11"><a href="#cb328-11" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb328-12"><a href="#cb328-12" aria-hidden="true" tabindex="-1"></a>patch_2 <span class="ot">&lt;-</span>  </span>
<span id="cb328-13"><a href="#cb328-13" aria-hidden="true" tabindex="-1"></a>  (</span>
<span id="cb328-14"><a href="#cb328-14" aria-hidden="true" tabindex="-1"></a>    g_eig <span class="sc">+</span> </span>
<span id="cb328-15"><a href="#cb328-15" aria-hidden="true" tabindex="-1"></a>      (g_cor_circle_L1_12 <span class="sc">+</span> g_cor_circle_L1_34 <span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">"collect"</span>)) <span class="sc">+</span></span>
<span id="cb328-16"><a href="#cb328-16" aria-hidden="true" tabindex="-1"></a>      <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">widths =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">8</span>))</span>
<span id="cb328-17"><a href="#cb328-17" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb328-18"><a href="#cb328-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb328-19"><a href="#cb328-19" aria-hidden="true" tabindex="-1"></a>fig_4 <span class="ot">&lt;-</span> </span>
<span id="cb328-20"><a href="#cb328-20" aria-hidden="true" tabindex="-1"></a>(patch_1 <span class="sc">/</span> patch_2) <span class="sc">+</span></span>
<span id="cb328-21"><a href="#cb328-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">heights =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">1.3</span>)) <span class="sc">+</span></span>
<span id="cb328-22"><a href="#cb328-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">"A"</span>)</span>
<span id="cb328-23"><a href="#cb328-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb328-24"><a href="#cb328-24" aria-hidden="true" tabindex="-1"></a>fig_4</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="030_cytokines_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="3900"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb329"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb329-1"><a href="#cb329-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(fig_4, <span class="at">filename =</span> <span class="fu">str_c</span>(<span class="fu">fig_out_dir</span>(), <span class="st">"Fig4.pdf"</span>), <span class="at">width =</span> <span class="dv">13</span>, <span class="at">height =</span> <span class="dv">9</span>, <span class="at">device =</span> cairo_pdf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
</section>
<section id="session-info" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Session Info</h1>
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne">
Click this text for obtaining the R session information
</button>
<div id="collapseOne" class="accordion-collapse collapse">
<div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb330"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb330-1"><a href="#cb330-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>R version 4.4.2 (2024-10-31)
Platform: aarch64-apple-darwin20
Running under: macOS Sequoia 15.6

Matrix products: default
BLAS:   /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRblas.0.dylib 
LAPACK: /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.0

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

time zone: Europe/Brussels
tzcode source: internal

attached base packages:
[1] grid      stats     graphics  grDevices utils     datasets  methods  
[8] base     

other attached packages:
 [1] plotly_4.10.4      phyloseq_1.50.0    ggforce_0.4.2      DistatisR_1.1.1   
 [5] ggthemes_5.1.0     gt_1.0.0           ade4_1.7-23        factoextra_1.0.7  
 [9] ggtext_0.1.2       MBViz_0.1.0        ggcorrplot_0.1.4.1 ggrepel_0.9.6     
[13] patchwork_1.3.0    magrittr_2.0.3     lubridate_1.9.4    forcats_1.0.0     
[17] stringr_1.5.1      dplyr_1.1.4        purrr_1.0.4        readr_2.1.5       
[21] tidyr_1.3.1        tibble_3.2.1       ggplot2_3.5.2      tidyverse_2.0.0   

loaded via a namespace (and not attached):
  [1] RColorBrewer_1.1-3          DHARMa_0.4.7               
  [3] rstudioapi_0.17.1           jsonlite_2.0.0             
  [5] MultiAssayExperiment_1.32.0 TH.data_1.1-3              
  [7] estimability_1.5.1          farver_2.1.2               
  [9] nloptr_2.2.1                rmarkdown_2.29             
 [11] fs_1.6.6                    zlibbioc_1.52.0            
 [13] vctrs_0.6.5                 multtest_2.62.0            
 [15] minqa_1.2.8                 rstatix_0.7.2              
 [17] polynom_1.4-1               htmltools_0.5.8.1          
 [19] S4Arrays_1.6.0              broom_1.0.8                
 [21] janeaustenr_1.0.0           cellranger_1.1.0           
 [23] Rhdf5lib_1.28.0             SparseArray_1.6.2          
 [25] Formula_1.2-5               rhdf5_2.50.2               
 [27] sass_0.4.10                 htmlwidgets_1.6.4          
 [29] tokenizers_0.3.0            pbkrtest_0.5.4             
 [31] sandwich_3.1-1              plyr_1.8.9                 
 [33] zoo_1.8-14                  emmeans_1.11.1             
 [35] igraph_2.1.4                lifecycle_1.0.4            
 [37] iterators_1.0.14            pkgconfig_2.0.3            
 [39] Matrix_1.7-3                R6_2.6.1                   
 [41] fastmap_1.2.0               rbibutils_2.3              
 [43] GenomeInfoDbData_1.2.13     MatrixGenerics_1.18.1      
 [45] digest_0.6.37               tidytext_0.4.2             
 [47] colorspace_2.1-1            S4Vectors_0.44.0           
 [49] crosstalk_1.2.1             GenomicRanges_1.58.0       
 [51] SnowballC_0.7.1             ggpubr_0.6.0               
 [53] vegan_2.6-10                labeling_0.4.3             
 [55] timechange_0.3.0            httr_1.4.7                 
 [57] polyclip_1.10-7             abind_1.4-8                
 [59] mgcv_1.9-1                  compiler_4.4.2             
 [61] withr_3.0.2                 backports_1.5.0            
 [63] carData_3.0-5               ggsignif_0.6.4             
 [65] MASS_7.3-65                 prettyGraphs_2.2.0         
 [67] DelayedArray_0.32.0         ggpp_0.5.9                 
 [69] biomformat_1.34.0           permute_0.9-7              
 [71] tools_4.4.2                 ape_5.8-1                  
 [73] glue_1.8.0                  nlme_3.1-168               
 [75] rhdf5filters_1.18.1         gridtext_0.1.5             
 [77] cluster_2.1.8.1             reshape2_1.4.4             
 [79] generics_0.1.4              gtable_0.3.6               
 [81] tzdb_0.5.0                  data.table_1.17.4          
 [83] hms_1.1.3                   xml2_1.3.8                 
 [85] car_3.1-3                   XVector_0.46.0             
 [87] BiocGenerics_0.52.0         foreach_1.5.2              
 [89] pillar_1.10.2               splines_4.4.2              
 [91] tweenr_2.0.3                lattice_0.22-6             
 [93] survival_3.8-3              tidyselect_1.2.1           
 [95] Biostrings_2.74.1           knitr_1.50                 
 [97] reformulas_0.4.1            IRanges_2.40.1             
 [99] SummarizedExperiment_1.36.0 stats4_4.4.2               
[101] xfun_0.52                   Biobase_2.66.0             
[103] matrixStats_1.5.0           stringi_1.8.7              
[105] UCSC.utils_1.2.0            lazyeval_0.2.2             
[107] yaml_2.3.10                 boot_1.3-31                
[109] evaluate_1.0.3              codetools_0.2-20           
[111] cli_3.6.5                   xtable_1.8-4               
[113] Rdpack_2.6.4                Rcpp_1.0.14                
[115] GenomeInfoDb_1.42.3         readxl_1.4.5               
[117] coda_0.19-4.1               parallel_4.4.2             
[119] lme4_1.1-37                 mvtnorm_1.3-3              
[121] viridisLite_0.4.2           scales_1.4.0               
[123] crayon_1.5.3                rlang_1.1.6                
[125] multcomp_1.4-28            </code></pre>
</div>
</div>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>